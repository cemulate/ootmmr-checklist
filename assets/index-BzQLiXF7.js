var Lo=Object.defineProperty;var Oo=(e,t,n)=>t in e?Lo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var nr=(e,t,n)=>(Oo(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function At(){}function Io(e,t){for(const n in t)e[n]=t[n];return e}function ei(e){return e()}function ys(){return Object.create(null)}function Kt(e){e.forEach(ei)}function Mr(e){return typeof e=="function"}function Hn(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function Mo(e){return Object.keys(e).length===0}function Nr(e,...t){if(e==null){for(const r of t)r(void 0);return At}const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function No(e){let t;return Nr(e,n=>t=n)(),t}function rr(e,t,n){e.$$.on_destroy.push(Nr(t,n))}function Uo(e,t,n,r){if(e){const i=ni(e,t,n,r);return e[0](i)}}function ni(e,t,n,r){return e[1]&&r?Io(n.ctx.slice(),e[1](r(t))):n.ctx}function xo(e,t,n,r){if(e[2]&&r){const i=e[2](r(n));if(t.dirty===void 0)return i;if(typeof i=="object"){const o=[],l=Math.max(t.dirty.length,i.length);for(let c=0;c<l;c+=1)o[c]=t.dirty[c]|i[c];return o}return t.dirty|i}return t.dirty}function Fo(e,t,n,r,i,o){if(i){const l=ni(t,n,r,o);e.p(l,i)}}function Bo(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let r=0;r<n;r++)t[r]=-1;return t}return-1}function J(e,t){e.appendChild(t)}function Tt(e,t,n){e.insertBefore(t,n||null)}function kt(e){e.parentNode&&e.parentNode.removeChild(e)}function Ur(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function Z(e){return document.createElement(e)}function te(e){return document.createTextNode(e)}function St(){return te(" ")}function ri(){return te("")}function Ut(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function fe(e){return function(t){return t.preventDefault(),e.call(this,t)}}function st(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function jo(e){return Array.from(e.childNodes)}function Wn(e,t){t=""+t,e.data!==t&&(e.data=t)}function ms(e,t){e.value=t??""}function tn(e,t,n,r){n==null?e.style.removeProperty(t):e.style.setProperty(t,n,r?"important":"")}function Vt(e,t,n){e.classList.toggle(t,!!n)}function Po(e,t,{bubbles:n=!1,cancelable:r=!1}={}){return new CustomEvent(e,{detail:t,bubbles:n,cancelable:r})}let ln;function rn(e){ln=e}function qo(){if(!ln)throw new Error("Function called outside component initialization");return ln}function si(){const e=qo();return(t,n,{cancelable:r=!1}={})=>{const i=e.$$.callbacks[t];if(i){const o=Po(t,n,{cancelable:r});return i.slice().forEach(l=>{l.call(e,o)}),!o.defaultPrevented}return!0}}const Ne=[],bs=[];let Fe=[];const _s=[],Vo=Promise.resolve();let _r=!1;function Ho(){_r||(_r=!0,Vo.then(ii))}function wr(e){Fe.push(e)}const sr=new Set;let Ie=0;function ii(){if(Ie!==0)return;const e=ln;do{try{for(;Ie<Ne.length;){const t=Ne[Ie];Ie++,rn(t),Wo(t.$$)}}catch(t){throw Ne.length=0,Ie=0,t}for(rn(null),Ne.length=0,Ie=0;bs.length;)bs.pop()();for(let t=0;t<Fe.length;t+=1){const n=Fe[t];sr.has(n)||(sr.add(n),n())}Fe.length=0}while(Ne.length);for(;_s.length;)_s.pop()();_r=!1,sr.clear(),rn(e)}function Wo(e){if(e.fragment!==null){e.update(),Kt(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(wr)}}function zo(e){const t=[],n=[];Fe.forEach(r=>e.indexOf(r)===-1?t.push(r):n.push(r)),n.forEach(r=>r()),Fe=t}const kn=new Set;let be;function xr(){be={r:0,c:[],p:be}}function Fr(){be.r||Kt(be.c),be=be.p}function Dt(e,t){e&&e.i&&(kn.delete(e),e.i(t))}function re(e,t,n,r){if(e&&e.o){if(kn.has(e))return;kn.add(e),be.c.push(()=>{kn.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}else r&&r()}function qe(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function oi(e){e&&e.c()}function Br(e,t,n){const{fragment:r,after_update:i}=e.$$;r&&r.m(t,n),wr(()=>{const o=e.$$.on_mount.map(ei).filter(Mr);e.$$.on_destroy?e.$$.on_destroy.push(...o):Kt(o),e.$$.on_mount=[]}),i.forEach(wr)}function jr(e,t){const n=e.$$;n.fragment!==null&&(zo(n.after_update),Kt(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Yo(e,t){e.$$.dirty[0]===-1&&(Ne.push(e),Ho(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Pr(e,t,n,r,i,o,l=null,c=[-1]){const a=ln;rn(e);const g=e.$$={fragment:null,ctx:[],props:o,update:At,not_equal:i,bound:ys(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(a?a.$$.context:[])),callbacks:ys(),dirty:c,skip_bound:!1,root:t.target||a.$$.root};l&&l(g.root);let m=!1;if(g.ctx=n?n(e,t.props||{},(h,d,...y)=>{const p=y.length?y[0]:d;return g.ctx&&i(g.ctx[h],g.ctx[h]=p)&&(!g.skip_bound&&g.bound[h]&&g.bound[h](p),m&&Yo(e,h)),d}):[],g.update(),m=!0,Kt(g.before_update),g.fragment=r?r(g.ctx):!1,t.target){if(t.hydrate){const h=jo(t.target);g.fragment&&g.fragment.l(h),h.forEach(kt)}else g.fragment&&g.fragment.c();t.intro&&Dt(e.$$.fragment),Br(e,t.target,t.anchor),ii()}rn(a)}class qr{constructor(){nr(this,"$$");nr(this,"$$set")}$destroy(){jr(this,1),this.$destroy=At}$on(t,n){if(!Mr(n))return At;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const i=r.indexOf(n);i!==-1&&r.splice(i,1)}}$set(t){this.$$set&&!Mo(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Go="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Go);const Ct=()=>new Map,vr=e=>{const t=Ct();return e.forEach((n,r)=>{t.set(r,n)}),t},Ot=(e,t,n)=>{let r=e.get(t);return r===void 0&&e.set(t,r=n()),r},Jo=(e,t)=>{const n=[];for(const[r,i]of e)n.push(t(i,r));return n},Ko=(e,t)=>{for(const[n,r]of e)if(t(r,n))return!0;return!1},de=()=>new Set,ir=e=>e[e.length-1],$o=(e,t)=>{for(let n=0;n<t.length;n++)e.push(t[n])},se=Array.from,Xo=Array.isArray;class li{constructor(){this._observers=Ct()}on(t,n){return Ot(this._observers,t,de).add(n),n}once(t,n){const r=(...i)=>{this.off(t,r),n(...i)};this.on(t,r)}off(t,n){const r=this._observers.get(t);r!==void 0&&(r.delete(n),r.size===0&&this._observers.delete(t))}emit(t,n){return se((this._observers.get(t)||Ct()).values()).forEach(r=>r(...n))}destroy(){this._observers=Ct()}}class Vr{constructor(){this._observers=Ct()}on(t,n){Ot(this._observers,t,de).add(n)}once(t,n){const r=(...i)=>{this.off(t,r),n(...i)};this.on(t,r)}off(t,n){const r=this._observers.get(t);r!==void 0&&(r.delete(n),r.size===0&&this._observers.delete(t))}emit(t,n){return se((this._observers.get(t)||Ct()).values()).forEach(r=>r(...n))}destroy(){this._observers=Ct()}}const zt=Math.floor,Cn=Math.abs,Qo=Math.log10,Hr=(e,t)=>e<t?e:t,Re=(e,t)=>e>t?e:t,ci=e=>e!==0?e<0:1/e<0,ws=1,vs=2,or=4,lr=8,cn=32,ee=64,Lt=128,zn=31,Sr=63,_e=127,Zo=2147483647,ai=Number.MAX_SAFE_INTEGER,tl=Number.isInteger||(e=>typeof e=="number"&&isFinite(e)&&zt(e)===e),el=String.fromCharCode,nl=e=>e.toLowerCase(),rl=/^\s*/g,sl=e=>e.replace(rl,""),il=/([A-Z])/g,Ss=(e,t)=>sl(e.replace(il,n=>`${t}${nl(n)}`)),ol=e=>{const t=unescape(encodeURIComponent(e)),n=t.length,r=new Uint8Array(n);for(let i=0;i<n;i++)r[i]=t.codePointAt(i);return r},an=typeof TextEncoder<"u"?new TextEncoder:null,ll=e=>an.encode(e),Er=an?ll:ol;let sn=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});sn&&sn.decode(new Uint8Array).length===1&&(sn=null);class pn{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const mt=()=>new pn,cl=e=>{let t=e.cpos;for(let n=0;n<e.bufs.length;n++)t+=e.bufs[n].length;return t},ut=e=>{const t=new Uint8Array(cl(e));let n=0;for(let r=0;r<e.bufs.length;r++){const i=e.bufs[r];t.set(i,n),n+=i.length}return t.set(new Uint8Array(e.cbuf.buffer,0,e.cpos),n),t},al=(e,t)=>{const n=e.cbuf.length;n-e.cpos<t&&(e.bufs.push(new Uint8Array(e.cbuf.buffer,0,e.cpos)),e.cbuf=new Uint8Array(Re(n,t)*2),e.cpos=0)},pt=(e,t)=>{const n=e.cbuf.length;e.cpos===n&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(n*2),e.cpos=0),e.cbuf[e.cpos++]=t},un=pt,Y=(e,t)=>{for(;t>_e;)pt(e,Lt|_e&t),t=zt(t/128);pt(e,_e&t)},Wr=(e,t)=>{const n=ci(t);for(n&&(t=-t),pt(e,(t>Sr?Lt:0)|(n?ee:0)|Sr&t),t=zt(t/64);t>0;)pt(e,(t>_e?Lt:0)|_e&t),t=zt(t/128)},kr=new Uint8Array(3e4),ul=kr.length/3,hl=(e,t)=>{if(t.length<ul){const n=an.encodeInto(t,kr).written||0;Y(e,n);for(let r=0;r<n;r++)pt(e,kr[r])}else ht(e,Er(t))},fl=(e,t)=>{const n=unescape(encodeURIComponent(t)),r=n.length;Y(e,r);for(let i=0;i<r;i++)pt(e,n.codePointAt(i))},Ht=an&&an.encodeInto?hl:fl,Yn=(e,t)=>{const n=e.cbuf.length,r=e.cpos,i=Hr(n-r,t.length),o=t.length-i;e.cbuf.set(t.subarray(0,i),r),e.cpos+=i,o>0&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(Re(n*2,o)),e.cbuf.set(t.subarray(i)),e.cpos=o)},ht=(e,t)=>{Y(e,t.byteLength),Yn(e,t)},zr=(e,t)=>{al(e,t);const n=new DataView(e.cbuf.buffer,e.cpos,t);return e.cpos+=t,n},dl=(e,t)=>zr(e,4).setFloat32(0,t,!1),gl=(e,t)=>zr(e,8).setFloat64(0,t,!1),pl=(e,t)=>zr(e,8).setBigInt64(0,t,!1),Es=new DataView(new ArrayBuffer(4)),yl=e=>(Es.setFloat32(0,e),Es.getFloat32(0)===e),Ve=(e,t)=>{switch(typeof t){case"string":pt(e,119),Ht(e,t);break;case"number":tl(t)&&Cn(t)<=Zo?(pt(e,125),Wr(e,t)):yl(t)?(pt(e,124),dl(e,t)):(pt(e,123),gl(e,t));break;case"bigint":pt(e,122),pl(e,t);break;case"object":if(t===null)pt(e,126);else if(Xo(t)){pt(e,117),Y(e,t.length);for(let n=0;n<t.length;n++)Ve(e,t[n])}else if(t instanceof Uint8Array)pt(e,116),ht(e,t);else{pt(e,118);const n=Object.keys(t);Y(e,n.length);for(let r=0;r<n.length;r++){const i=n[r];Ht(e,i),Ve(e,t[i])}}break;case"boolean":pt(e,t?120:121);break;default:pt(e,127)}};class ks extends pn{constructor(t){super(),this.w=t,this.s=null,this.count=0}write(t){this.s===t?this.count++:(this.count>0&&Y(this,this.count-1),this.count=1,this.w(this,t),this.s=t)}}const Cs=e=>{e.count>0&&(Wr(e.encoder,e.count===1?e.s:-e.s),e.count>1&&Y(e.encoder,e.count-2))};class Rn{constructor(){this.encoder=new pn,this.s=0,this.count=0}write(t){this.s===t?this.count++:(Cs(this),this.count=1,this.s=t)}toUint8Array(){return Cs(this),ut(this.encoder)}}const Rs=e=>{if(e.count>0){const t=e.diff*2+(e.count===1?0:1);Wr(e.encoder,t),e.count>1&&Y(e.encoder,e.count-2)}};class cr{constructor(){this.encoder=new pn,this.s=0,this.count=0,this.diff=0}write(t){this.diff===t-this.s?(this.s=t,this.count++):(Rs(this),this.count=1,this.diff=t-this.s,this.s=t)}toUint8Array(){return Rs(this),ut(this.encoder)}}class ml{constructor(){this.sarr=[],this.s="",this.lensE=new Rn}write(t){this.s+=t,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(t.length)}toUint8Array(){const t=new pn;return this.sarr.push(this.s),this.s="",Ht(t,this.sarr.join("")),Yn(t,this.lensE.toUint8Array()),ut(t)}}const Bt=e=>new Error(e),Wt=()=>{throw Bt("Method unimplemented")},Yt=()=>{throw Bt("Unexpected case")},ui=Bt("Unexpected end of array"),hi=Bt("Integer out of Range");class Gn{constructor(t){this.arr=t,this.pos=0}}const $t=e=>new Gn(e),bl=e=>e.pos!==e.arr.length,_l=(e,t)=>{const n=new Uint8Array(e.arr.buffer,e.pos+e.arr.byteOffset,t);return e.pos+=t,n},yt=e=>_l(e,$(e)),ve=e=>e.arr[e.pos++],$=e=>{let t=0,n=1;const r=e.arr.length;for(;e.pos<r;){const i=e.arr[e.pos++];if(t=t+(i&_e)*n,n*=128,i<Lt)return t;if(t>ai)throw hi}throw ui},Yr=e=>{let t=e.arr[e.pos++],n=t&Sr,r=64;const i=(t&ee)>0?-1:1;if(!(t&Lt))return i*n;const o=e.arr.length;for(;e.pos<o;){if(t=e.arr[e.pos++],n=n+(t&_e)*r,r*=128,t<Lt)return i*n;if(n>ai)throw hi}throw ui},wl=e=>{let t=$(e);if(t===0)return"";{let n=String.fromCodePoint(ve(e));if(--t<100)for(;t--;)n+=String.fromCodePoint(ve(e));else for(;t>0;){const r=t<1e4?t:1e4,i=e.arr.subarray(e.pos,e.pos+r);e.pos+=r,n+=String.fromCodePoint.apply(null,i),t-=r}return decodeURIComponent(escape(n))}},vl=e=>sn.decode(yt(e)),ne=sn?vl:wl,Gr=(e,t)=>{const n=new DataView(e.arr.buffer,e.arr.byteOffset+e.pos,t);return e.pos+=t,n},Sl=e=>Gr(e,4).getFloat32(0,!1),El=e=>Gr(e,8).getFloat64(0,!1),kl=e=>Gr(e,8).getBigInt64(0,!1),Cl=[e=>{},e=>null,Yr,Sl,El,kl,e=>!1,e=>!0,ne,e=>{const t=$(e),n={};for(let r=0;r<t;r++){const i=ne(e);n[i]=He(e)}return n},e=>{const t=$(e),n=[];for(let r=0;r<t;r++)n.push(He(e));return n},yt],He=e=>Cl[127-ve(e)](e);class As extends Gn{constructor(t,n){super(t),this.reader=n,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),bl(this)?this.count=$(this)+1:this.count=-1),this.count--,this.s}}class An extends Gn{constructor(t){super(t),this.s=0,this.count=0}read(){if(this.count===0){this.s=Yr(this);const t=ci(this.s);this.count=1,t&&(this.s=-this.s,this.count=$(this)+2)}return this.count--,this.s}}class ar extends Gn{constructor(t){super(t),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const t=Yr(this),n=t&1;this.diff=zt(t/2),this.count=1,n&&(this.count=$(this)+2)}return this.s+=this.diff,this.count--,this.s}}class Rl{constructor(t){this.decoder=new An(t),this.str=ne(this.decoder),this.spos=0}read(){const t=this.spos+this.decoder.read(),n=this.str.slice(this.spos,t);return this.spos=t,n}}const Al=crypto.getRandomValues.bind(crypto),Tl=Math.random,fi=()=>Al(new Uint32Array(1))[0],Dl="10000000-1000-4000-8000"+-1e11,di=()=>Dl.replace(/[018]/g,e=>(e^fi()&15>>e/4).toString(16)),ie=Date.now,We=e=>new Promise(e);Promise.all.bind(Promise);const Ll=e=>Promise.reject(e),Jr=e=>Promise.resolve(e),Ts=e=>e===void 0?null:e;class Ol{constructor(){this.map=new Map}setItem(t,n){this.map.set(t,n)}getItem(t){return this.map.get(t)}}let gi=new Ol,Kr=!0;try{typeof localStorage<"u"&&localStorage&&(gi=localStorage,Kr=!1)}catch{}const pi=gi,Il=e=>Kr||addEventListener("storage",e),Ml=e=>Kr||removeEventListener("storage",e),Nl=Object.assign,Ul=Object.keys,xl=(e,t)=>{for(const n in e)t(e[n],n)},Ln=e=>Ul(e).length,Fl=e=>{for(const t in e)return!1;return!0},Bl=(e,t)=>{for(const n in e)if(!t(e[n],n))return!1;return!0},yi=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),jl=(e,t)=>e===t||Ln(e)===Ln(t)&&Bl(e,(n,r)=>(n!==void 0||yi(t,r))&&t[r]===n),$r=(e,t,n=0)=>{try{for(;n<e.length;n++)e[n](...t)}finally{n<e.length&&$r(e,t,n+1)}},Pl=()=>{},ql=e=>e,Vl=(e,t)=>e===t,on=(e,t)=>{if(e==null||t==null)return Vl(e,t);if(e.constructor!==t.constructor)return!1;if(e===t)return!0;switch(e.constructor){case ArrayBuffer:e=new Uint8Array(e),t=new Uint8Array(t);case Uint8Array:{if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;break}case Set:{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;break}case Map:{if(e.size!==t.size)return!1;for(const n of e.keys())if(!t.has(n)||!on(e.get(n),t.get(n)))return!1;break}case Object:if(Ln(e)!==Ln(t))return!1;for(const n in e)if(!yi(e,n)||!on(e[n],t[n]))return!1;break;case Array:if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!on(e[n],t[n]))return!1;break;default:return!1}return!0},Hl=(e,t)=>t.includes(e);var mi={};const ze=typeof process<"u"&&process.release&&/node|io\.js/.test(process.release.name)&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]",bi=typeof window<"u"&&typeof document<"u"&&!ze;let Pt;const Wl=()=>{if(Pt===void 0)if(ze){Pt=Ct();const e=process.argv;let t=null;for(let n=0;n<e.length;n++){const r=e[n];r[0]==="-"?(t!==null&&Pt.set(t,""),t=r):t!==null&&(Pt.set(t,r),t=null)}t!==null&&Pt.set(t,"")}else typeof location=="object"?(Pt=Ct(),(location.search||"?").slice(1).split("&").forEach(e=>{if(e.length!==0){const[t,n]=e.split("=");Pt.set(`--${Ss(t,"-")}`,n),Pt.set(`-${Ss(t,"-")}`,n)}})):Pt=Ct();return Pt},Cr=e=>Wl().has(e),On=e=>Ts(ze?mi[e.toUpperCase().replaceAll("-","_")]:pi.getItem(e)),zl=e=>Cr("--"+e)||On(e)!==null;zl("production");const Ds=ze&&Hl(mi.FORCE_COLOR,["true","1","2"]),Yl=!Cr("no-colors")&&(!ze||process.stdout.isTTY||Ds)&&(!ze||Cr("color")||Ds||On("COLORTERM")!==null||(On("TERM")||"").includes("color")),_i=e=>new Uint8Array(e),Gl=(e,t,n)=>new Uint8Array(e,t,n),Jl=e=>new Uint8Array(e),Kl=e=>{let t="";for(let n=0;n<e.byteLength;n++)t+=el(e[n]);return btoa(t)},$l=e=>Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("base64"),Xl=e=>{const t=atob(e),n=_i(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n},Ql=e=>{const t=Buffer.from(e,"base64");return Gl(t.buffer,t.byteOffset,t.byteLength)},wi=bi?Kl:$l,vi=bi?Xl:Ql,Zl=e=>{const t=_i(e.byteLength);return t.set(e),t};class tc{constructor(t,n){this.left=t,this.right=n}}const Zt=(e,t)=>new tc(e,t);typeof DOMParser<"u"&&new DOMParser;const ec=e=>Jo(e,(t,n)=>`${n}:${t};`).join(""),nc=JSON.stringify,oe=Symbol,Nt=oe(),Se=oe(),Si=oe(),Xr=oe(),Ei=oe(),ki=oe(),Ci=oe(),Qr=oe(),Jn=oe(),rc=e=>{var r;e.length===1&&((r=e[0])==null?void 0:r.constructor)===Function&&(e=e[0]());const t=[];let n=0;for(;n<e.length;n++){const i=e[n];i===void 0||i.constructor===String||i.constructor===Number||i.constructor===Object&&t.push(JSON.stringify(i))}return t},Ls=[Ei,Ci,Qr,Si];let ur=0,Os=ie();const sc=(e,t)=>{const n=Ls[ur],r=On("log"),i=r!==null&&(r==="*"||r==="true"||new RegExp(r,"gi").test(t));return ur=(ur+1)%Ls.length,t+=": ",i?(...o)=>{var a;o.length===1&&((a=o[0])==null?void 0:a.constructor)===Function&&(o=o[0]());const l=ie(),c=l-Os;Os=l,e(n,t,Jn,...o.map(g=>{switch(g!=null&&g.constructor===Uint8Array&&(g=Array.from(g)),typeof g){case"string":case"symbol":return g;default:return nc(g)}}),n," +"+c+"ms")}:Pl},ic={[Nt]:Zt("font-weight","bold"),[Se]:Zt("font-weight","normal"),[Si]:Zt("color","blue"),[Ei]:Zt("color","green"),[Xr]:Zt("color","grey"),[ki]:Zt("color","red"),[Ci]:Zt("color","purple"),[Qr]:Zt("color","orange"),[Jn]:Zt("color","black")},oc=e=>{var l;e.length===1&&((l=e[0])==null?void 0:l.constructor)===Function&&(e=e[0]());const t=[],n=[],r=Ct();let i=[],o=0;for(;o<e.length;o++){const c=e[o],a=ic[c];if(a!==void 0)r.set(a.left,a.right);else{if(c===void 0)break;if(c.constructor===String||c.constructor===Number){const g=ec(r);o>0||g.length>0?(t.push("%c"+c),n.push(g)):t.push(c)}else break}}for(o>0&&(i=n,i.unshift(t.join("")));o<e.length;o++){const c=e[o];c instanceof Symbol||i.push(c)}return i},lc=Yl?oc:rc,Ri=(...e)=>{console.log(...lc(e)),cc.forEach(t=>t.print(e))},cc=de(),ac=e=>sc(Ri,e),Ai=e=>({[Symbol.iterator](){return this},next:e}),uc=(e,t)=>Ai(()=>{let n;do n=e.next();while(!n.done&&!t(n.value));return n}),hr=(e,t)=>Ai(()=>{const{done:n,value:r}=e.next();return{done:n,value:n?void 0:t(r)}});class Zr{constructor(t,n){this.clock=t,this.len=n}}class yn{constructor(){this.clients=new Map}}const Ti=(e,t,n)=>t.clients.forEach((r,i)=>{const o=e.doc.store.clients.get(i);for(let l=0;l<r.length;l++){const c=r[l];Vi(e,o,c.clock,c.len,n)}}),hc=(e,t)=>{let n=0,r=e.length-1;for(;n<=r;){const i=zt((n+r)/2),o=e[i],l=o.clock;if(l<=t){if(t<l+o.len)return i;n=i+1}else r=i-1}return null},Di=(e,t)=>{const n=e.clients.get(t.client);return n!==void 0&&hc(n,t.clock)!==null},ts=e=>{e.clients.forEach(t=>{t.sort((i,o)=>i.clock-o.clock);let n,r;for(n=1,r=1;n<t.length;n++){const i=t[r-1],o=t[n];i.clock+i.len>=o.clock?i.len=Re(i.len,o.clock+o.len-i.clock):(r<n&&(t[r]=o),r++)}t.length=r})},fc=e=>{const t=new yn;for(let n=0;n<e.length;n++)e[n].clients.forEach((r,i)=>{if(!t.clients.has(i)){const o=r.slice();for(let l=n+1;l<e.length;l++)$o(o,e[l].clients.get(i)||[]);t.clients.set(i,o)}});return ts(t),t},In=(e,t,n,r)=>{Ot(e.clients,t,()=>[]).push(new Zr(n,r))},dc=()=>new yn,gc=e=>{const t=dc();return e.clients.forEach((n,r)=>{const i=[];for(let o=0;o<n.length;o++){const l=n[o];if(l.deleted){const c=l.id.clock;let a=l.length;if(o+1<n.length)for(let g=n[o+1];o+1<n.length&&g.deleted;g=n[++o+1])a+=g.length;i.push(new Zr(c,a))}}i.length>0&&t.clients.set(r,i)}),t},$e=(e,t)=>{Y(e.restEncoder,t.clients.size),se(t.clients.entries()).sort((n,r)=>r[0]-n[0]).forEach(([n,r])=>{e.resetDsCurVal(),Y(e.restEncoder,n);const i=r.length;Y(e.restEncoder,i);for(let o=0;o<i;o++){const l=r[o];e.writeDsClock(l.clock),e.writeDsLen(l.len)}})},es=e=>{const t=new yn,n=$(e.restDecoder);for(let r=0;r<n;r++){e.resetDsCurVal();const i=$(e.restDecoder),o=$(e.restDecoder);if(o>0){const l=Ot(t.clients,i,()=>[]);for(let c=0;c<o;c++)l.push(new Zr(e.readDsClock(),e.readDsLen()))}}return t},Is=(e,t,n)=>{const r=new yn,i=$(e.restDecoder);for(let o=0;o<i;o++){e.resetDsCurVal();const l=$(e.restDecoder),c=$(e.restDecoder),a=n.clients.get(l)||[],g=bt(n,l);for(let m=0;m<c;m++){const h=e.readDsClock(),d=h+e.readDsLen();if(h<g){g<d&&In(r,l,g,d-g);let y=Gt(a,h),p=a[y];for(!p.deleted&&p.id.clock<h&&(a.splice(y+1,0,jn(t,p,h-p.id.clock)),y++);y<a.length&&(p=a[y++],p.id.clock<d);)p.deleted||(d<p.id.clock+p.length&&a.splice(y,0,jn(t,p,d-p.id.clock)),p.delete(t))}else In(r,l,h,d-h)}}if(r.clients.size>0){const o=new Ee;return Y(o.restEncoder,0),$e(o,r),o.toUint8Array()}return null},Li=fi;class Xe extends li{constructor({guid:t=di(),collectionid:n=null,gc:r=!0,gcFilter:i=()=>!0,meta:o=null,autoLoad:l=!1,shouldLoad:c=!0}={}){super(),this.gc=r,this.gcFilter=i,this.clientID=Li(),this.guid=t,this.collectionid=n,this.share=new Map,this.store=new Pi,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=c,this.autoLoad=l,this.meta=o,this.isLoaded=!1,this.isSynced=!1,this.whenLoaded=We(g=>{this.on("load",()=>{this.isLoaded=!0,g(this)})});const a=()=>We(g=>{const m=h=>{(h===void 0||h===!0)&&(this.off("sync",m),g())};this.on("sync",m)});this.on("sync",g=>{g===!1&&this.isSynced&&(this.whenSynced=a()),this.isSynced=g===void 0||g===!0,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=a()}load(){const t=this._item;t!==null&&!this.shouldLoad&&ot(t.parent.doc,n=>{n.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(se(this.subdocs).map(t=>t.guid))}transact(t,n=null){return ot(this,t,n)}get(t,n=wt){const r=Ot(this.share,t,()=>{const o=new n;return o._integrate(this,null),o}),i=r.constructor;if(n!==wt&&i!==n)if(i===wt){const o=new n;o._map=r._map,r._map.forEach(l=>{for(;l!==null;l=l.left)l.parent=o}),o._start=r._start;for(let l=o._start;l!==null;l=l.right)l.parent=o;return o._length=r._length,this.share.set(t,o),o._integrate(this,null),o}else throw new Error(`Type with the name ${t} has already been defined with a different constructor`);return r}getArray(t=""){return this.get(t,je)}getText(t=""){return this.get(t,Je)}getMap(t=""){return this.get(t,Ge)}getXmlElement(t=""){return this.get(t,Ke)}getXmlFragment(t=""){return this.get(t,ke)}toJSON(){const t={};return this.share.forEach((n,r)=>{t[r]=n.toJSON()}),t}destroy(){se(this.subdocs).forEach(n=>n.destroy());const t=this._item;if(t!==null){this._item=null;const n=t.content;n.doc=new Xe({guid:this.guid,...n.opts,shouldLoad:!1}),n.doc._item=t,ot(t.parent.doc,r=>{const i=n.doc;t.deleted||r.subdocsAdded.add(i),r.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class Oi{constructor(t){this.restDecoder=t}resetDsCurVal(){}readDsClock(){return $(this.restDecoder)}readDsLen(){return $(this.restDecoder)}}class Ii extends Oi{readLeftID(){return rt($(this.restDecoder),$(this.restDecoder))}readRightID(){return rt($(this.restDecoder),$(this.restDecoder))}readClient(){return $(this.restDecoder)}readInfo(){return ve(this.restDecoder)}readString(){return ne(this.restDecoder)}readParentInfo(){return $(this.restDecoder)===1}readTypeRef(){return $(this.restDecoder)}readLen(){return $(this.restDecoder)}readAny(){return He(this.restDecoder)}readBuf(){return Zl(yt(this.restDecoder))}readJSON(){return JSON.parse(ne(this.restDecoder))}readKey(){return ne(this.restDecoder)}}class pc{constructor(t){this.dsCurrVal=0,this.restDecoder=t}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=$(this.restDecoder),this.dsCurrVal}readDsLen(){const t=$(this.restDecoder)+1;return this.dsCurrVal+=t,t}}class Ye extends pc{constructor(t){super(t),this.keys=[],$(t),this.keyClockDecoder=new ar(yt(t)),this.clientDecoder=new An(yt(t)),this.leftClockDecoder=new ar(yt(t)),this.rightClockDecoder=new ar(yt(t)),this.infoDecoder=new As(yt(t),ve),this.stringDecoder=new Rl(yt(t)),this.parentInfoDecoder=new As(yt(t),ve),this.typeRefDecoder=new An(yt(t)),this.lenDecoder=new An(yt(t))}readLeftID(){return new Be(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new Be(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return He(this.restDecoder)}readBuf(){return yt(this.restDecoder)}readJSON(){return He(this.restDecoder)}readKey(){const t=this.keyClockDecoder.read();if(t<this.keys.length)return this.keys[t];{const n=this.stringDecoder.read();return this.keys.push(n),n}}}class Mi{constructor(){this.restEncoder=mt()}toUint8Array(){return ut(this.restEncoder)}resetDsCurVal(){}writeDsClock(t){Y(this.restEncoder,t)}writeDsLen(t){Y(this.restEncoder,t)}}class mn extends Mi{writeLeftID(t){Y(this.restEncoder,t.client),Y(this.restEncoder,t.clock)}writeRightID(t){Y(this.restEncoder,t.client),Y(this.restEncoder,t.clock)}writeClient(t){Y(this.restEncoder,t)}writeInfo(t){un(this.restEncoder,t)}writeString(t){Ht(this.restEncoder,t)}writeParentInfo(t){Y(this.restEncoder,t?1:0)}writeTypeRef(t){Y(this.restEncoder,t)}writeLen(t){Y(this.restEncoder,t)}writeAny(t){Ve(this.restEncoder,t)}writeBuf(t){ht(this.restEncoder,t)}writeJSON(t){Ht(this.restEncoder,JSON.stringify(t))}writeKey(t){Ht(this.restEncoder,t)}}class Ni{constructor(){this.restEncoder=mt(),this.dsCurrVal=0}toUint8Array(){return ut(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(t){const n=t-this.dsCurrVal;this.dsCurrVal=t,Y(this.restEncoder,n)}writeDsLen(t){t===0&&Yt(),Y(this.restEncoder,t-1),this.dsCurrVal+=t}}class Ee extends Ni{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new cr,this.clientEncoder=new Rn,this.leftClockEncoder=new cr,this.rightClockEncoder=new cr,this.infoEncoder=new ks(un),this.stringEncoder=new ml,this.parentInfoEncoder=new ks(un),this.typeRefEncoder=new Rn,this.lenEncoder=new Rn}toUint8Array(){const t=mt();return Y(t,0),ht(t,this.keyClockEncoder.toUint8Array()),ht(t,this.clientEncoder.toUint8Array()),ht(t,this.leftClockEncoder.toUint8Array()),ht(t,this.rightClockEncoder.toUint8Array()),ht(t,ut(this.infoEncoder)),ht(t,this.stringEncoder.toUint8Array()),ht(t,ut(this.parentInfoEncoder)),ht(t,this.typeRefEncoder.toUint8Array()),ht(t,this.lenEncoder.toUint8Array()),Yn(t,ut(this.restEncoder)),ut(t)}writeLeftID(t){this.clientEncoder.write(t.client),this.leftClockEncoder.write(t.clock)}writeRightID(t){this.clientEncoder.write(t.client),this.rightClockEncoder.write(t.clock)}writeClient(t){this.clientEncoder.write(t)}writeInfo(t){this.infoEncoder.write(t)}writeString(t){this.stringEncoder.write(t)}writeParentInfo(t){this.parentInfoEncoder.write(t?1:0)}writeTypeRef(t){this.typeRefEncoder.write(t)}writeLen(t){this.lenEncoder.write(t)}writeAny(t){Ve(this.restEncoder,t)}writeBuf(t){ht(this.restEncoder,t)}writeJSON(t){Ve(this.restEncoder,t)}writeKey(t){const n=this.keyMap.get(t);n===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(t)):this.keyClockEncoder.write(n)}}const yc=(e,t,n,r)=>{r=Re(r,t[0].id.clock);const i=Gt(t,r);Y(e.restEncoder,t.length-i),e.writeClient(n),Y(e.restEncoder,r);const o=t[i];o.write(e,r-o.id.clock);for(let l=i+1;l<t.length;l++)t[l].write(e,0)},ns=(e,t,n)=>{const r=new Map;n.forEach((i,o)=>{bt(t,o)>i&&r.set(o,i)}),Kn(t).forEach((i,o)=>{n.has(o)||r.set(o,0)}),Y(e.restEncoder,r.size),se(r.entries()).sort((i,o)=>o[0]-i[0]).forEach(([i,o])=>{yc(e,t.clients.get(i),i,o)})},mc=(e,t)=>{const n=Ct(),r=$(e.restDecoder);for(let i=0;i<r;i++){const o=$(e.restDecoder),l=new Array(o),c=e.readClient();let a=$(e.restDecoder);n.set(c,{i:0,refs:l});for(let g=0;g<o;g++){const m=e.readInfo();switch(zn&m){case 0:{const h=e.readLen();l[g]=new It(rt(c,a),h),a+=h;break}case 10:{const h=$(e.restDecoder);l[g]=new Mt(rt(c,a),h),a+=h;break}default:{const h=(m&(ee|Lt))===0,d=new dt(rt(c,a),null,(m&Lt)===Lt?e.readLeftID():null,null,(m&ee)===ee?e.readRightID():null,h?e.readParentInfo()?t.get(e.readString()):e.readLeftID():null,h&&(m&cn)===cn?e.readString():null,lo(e,m));l[g]=d,a+=d.length}}}}return n},bc=(e,t,n)=>{const r=[];let i=se(n.keys()).sort((y,p)=>y-p);if(i.length===0)return null;const o=()=>{if(i.length===0)return null;let y=n.get(i[i.length-1]);for(;y.refs.length===y.i;)if(i.pop(),i.length>0)y=n.get(i[i.length-1]);else return null;return y};let l=o();if(l===null)return null;const c=new Pi,a=new Map,g=(y,p)=>{const w=a.get(y);(w==null||w>p)&&a.set(y,p)};let m=l.refs[l.i++];const h=new Map,d=()=>{for(const y of r){const p=y.id.client,w=n.get(p);w?(w.i--,c.clients.set(p,w.refs.slice(w.i)),n.delete(p),w.i=0,w.refs=[]):c.clients.set(p,[y]),i=i.filter(I=>I!==p)}r.length=0};for(;;){if(m.constructor!==Mt){const p=Ot(h,m.id.client,()=>bt(t,m.id.client))-m.id.clock;if(p<0)r.push(m),g(m.id.client,m.id.clock-1),d();else{const w=m.getMissing(e,t);if(w!==null){r.push(m);const I=n.get(w)||{refs:[],i:0};if(I.refs.length===I.i)g(w,bt(t,w)),d();else{m=I.refs[I.i++];continue}}else(p===0||p<m.length)&&(m.integrate(e,p),h.set(m.id.client,m.id.clock+m.length))}}if(r.length>0)m=r.pop();else if(l!==null&&l.i<l.refs.length)m=l.refs[l.i++];else{if(l=o(),l===null)break;m=l.refs[l.i++]}}if(c.clients.size>0){const y=new Ee;return ns(y,c,new Map),Y(y.restEncoder,0),{missing:a,update:y.toUint8Array()}}return null},_c=(e,t)=>ns(e,t.doc.store,t.beforeState),wc=(e,t,n,r=new Ye(e))=>ot(t,i=>{i.local=!1;let o=!1;const l=i.doc,c=l.store,a=mc(r,l),g=bc(i,c,a),m=c.pendingStructs;if(m){for(const[d,y]of m.missing)if(y<bt(c,d)){o=!0;break}if(g){for(const[d,y]of g.missing){const p=m.missing.get(d);(p==null||p>y)&&m.missing.set(d,y)}m.update=Mn([m.update,g.update])}}else c.pendingStructs=g;const h=Is(r,i,c);if(c.pendingDs){const d=new Ye($t(c.pendingDs));$(d.restDecoder);const y=Is(d,i,c);h&&y?c.pendingDs=Mn([h,y]):c.pendingDs=h||y}else c.pendingDs=h;if(o){const d=c.pendingStructs.update;c.pendingStructs=null,Ui(i.doc,d)}},n,!1),Ui=(e,t,n,r=Ye)=>{const i=$t(t);wc(i,e,n,new r(i))},xi=(e,t,n)=>Ui(e,t,n,Ii),vc=(e,t,n=new Map)=>{ns(e,t.store,n),$e(e,gc(t.store))},Sc=(e,t=new Uint8Array([0]),n=new Ee)=>{const r=Fi(t);vc(n,e,r);const i=[n.toUint8Array()];if(e.store.pendingDs&&i.push(e.store.pendingDs),e.store.pendingStructs&&i.push(Fc(e.store.pendingStructs.update,t)),i.length>1){if(n.constructor===mn)return Uc(i.map((o,l)=>l===0?o:jc(o)));if(n.constructor===Ee)return Mn(i)}return i[0]},rs=(e,t)=>Sc(e,t,new mn),Ec=e=>{const t=new Map,n=$(e.restDecoder);for(let r=0;r<n;r++){const i=$(e.restDecoder),o=$(e.restDecoder);t.set(i,o)}return t},Fi=e=>Ec(new Oi($t(e))),Bi=(e,t)=>(Y(e.restEncoder,t.size),se(t.entries()).sort((n,r)=>r[0]-n[0]).forEach(([n,r])=>{Y(e.restEncoder,n),Y(e.restEncoder,r)}),e),kc=(e,t)=>Bi(e,Kn(t.store)),Cc=(e,t=new Ni)=>(e instanceof Map?Bi(t,e):kc(t,e),t.toUint8Array()),Rc=e=>Cc(e,new Mi);class Ac{constructor(){this.l=[]}}const Ms=()=>new Ac,Ns=(e,t)=>e.l.push(t),Us=(e,t)=>{const n=e.l,r=n.length;e.l=n.filter(i=>t!==i),r===e.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},ji=(e,t,n)=>$r(e.l,[t,n]);class Be{constructor(t,n){this.client=t,this.clock=n}}const wn=(e,t)=>e===t||e!==null&&t!==null&&e.client===t.client&&e.clock===t.clock,rt=(e,t)=>new Be(e,t),Tc=e=>{for(const[t,n]of e.doc.share.entries())if(n===e)return t;throw Yt()},Ue=(e,t)=>t===void 0?!e.deleted:t.sv.has(e.id.client)&&(t.sv.get(e.id.client)||0)>e.id.clock&&!Di(t.ds,e.id),Rr=(e,t)=>{const n=Ot(e.meta,Rr,de),r=e.doc.store;n.has(t)||(t.sv.forEach((i,o)=>{i<bt(r,o)&&ge(e,rt(o,i))}),Ti(e,t.ds,i=>{}),n.add(t))};class Pi{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const Kn=e=>{const t=new Map;return e.clients.forEach((n,r)=>{const i=n[n.length-1];t.set(r,i.id.clock+i.length)}),t},bt=(e,t)=>{const n=e.clients.get(t);if(n===void 0)return 0;const r=n[n.length-1];return r.id.clock+r.length},qi=(e,t)=>{let n=e.clients.get(t.id.client);if(n===void 0)n=[],e.clients.set(t.id.client,n);else{const r=n[n.length-1];if(r.id.clock+r.length!==t.id.clock)throw Yt()}n.push(t)},Gt=(e,t)=>{let n=0,r=e.length-1,i=e[r],o=i.id.clock;if(o===t)return r;let l=zt(t/(o+i.length-1)*r);for(;n<=r;){if(i=e[l],o=i.id.clock,o<=t){if(t<o+i.length)return l;n=l+1}else r=l-1;l=zt((n+r)/2)}throw Yt()},Dc=(e,t)=>{const n=e.clients.get(t.client);return n[Gt(n,t.clock)]},fr=Dc,Ar=(e,t,n)=>{const r=Gt(t,n),i=t[r];return i.id.clock<n&&i instanceof dt?(t.splice(r+1,0,jn(e,i,n-i.id.clock)),r+1):r},ge=(e,t)=>{const n=e.doc.store.clients.get(t.client);return n[Ar(e,n,t.clock)]},xs=(e,t,n)=>{const r=t.clients.get(n.client),i=Gt(r,n.clock),o=r[i];return n.clock!==o.id.clock+o.length-1&&o.constructor!==It&&r.splice(i+1,0,jn(e,o,n.clock-o.id.clock+1)),o},Lc=(e,t,n)=>{const r=e.clients.get(t.id.client);r[Gt(r,t.id.clock)]=n},Vi=(e,t,n,r,i)=>{if(r===0)return;const o=n+r;let l=Ar(e,t,n),c;do c=t[l++],o<c.id.clock+c.length&&Ar(e,t,o),i(c);while(l<t.length&&t[l].id.clock<o)};class Oc{constructor(t,n,r){this.doc=t,this.deleteSet=new yn,this.beforeState=Kn(t.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=n,this.meta=new Map,this.local=r,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const Fs=(e,t)=>t.deleteSet.clients.size===0&&!Ko(t.afterState,(n,r)=>t.beforeState.get(r)!==n)?!1:(ts(t.deleteSet),_c(e,t),$e(e,t.deleteSet),!0),Bs=(e,t,n)=>{const r=t._item;(r===null||r.id.clock<(e.beforeState.get(r.id.client)||0)&&!r.deleted)&&Ot(e.changed,t,de).add(n)},Tn=(e,t)=>{let n=e[t],r=e[t-1],i=t;for(;i>0;n=r,r=e[--i-1]){if(r.deleted===n.deleted&&r.constructor===n.constructor&&r.mergeWith(n)){n instanceof dt&&n.parentSub!==null&&n.parent._map.get(n.parentSub)===n&&n.parent._map.set(n.parentSub,r);continue}break}const o=t-i;return o&&e.splice(t+1-o,o),o},Ic=(e,t,n)=>{for(const[r,i]of e.clients.entries()){const o=t.clients.get(r);for(let l=i.length-1;l>=0;l--){const c=i[l],a=c.clock+c.len;for(let g=Gt(o,c.clock),m=o[g];g<o.length&&m.id.clock<a;m=o[++g]){const h=o[g];if(c.clock+c.len<=h.id.clock)break;h instanceof dt&&h.deleted&&!h.keep&&n(h)&&h.gc(t,!1)}}}},Mc=(e,t)=>{e.clients.forEach((n,r)=>{const i=t.clients.get(r);for(let o=n.length-1;o>=0;o--){const l=n[o],c=Hr(i.length-1,1+Gt(i,l.clock+l.len-1));for(let a=c,g=i[a];a>0&&g.id.clock>=l.clock;g=i[a])a-=1+Tn(i,a)}})},Hi=(e,t)=>{if(t<e.length){const n=e[t],r=n.doc,i=r.store,o=n.deleteSet,l=n._mergeStructs;try{ts(o),n.afterState=Kn(n.doc.store),r.emit("beforeObserverCalls",[n,r]);const c=[];n.changed.forEach((a,g)=>c.push(()=>{(g._item===null||!g._item.deleted)&&g._callObserver(n,a)})),c.push(()=>{n.changedParentTypes.forEach((a,g)=>{g._dEH.l.length>0&&(g._item===null||!g._item.deleted)&&(a=a.filter(m=>m.target._item===null||!m.target._item.deleted),a.forEach(m=>{m.currentTarget=g,m._path=null}),a.sort((m,h)=>m.path.length-h.path.length),ji(g._dEH,a,n))})}),c.push(()=>r.emit("afterTransaction",[n,r])),$r(c,[]),n._needFormattingCleanup&&Zc(n)}finally{r.gc&&Ic(o,i,r.gcFilter),Mc(o,i),n.afterState.forEach((m,h)=>{const d=n.beforeState.get(h)||0;if(d!==m){const y=i.clients.get(h),p=Re(Gt(y,d),1);for(let w=y.length-1;w>=p;)w-=1+Tn(y,w)}});for(let m=l.length-1;m>=0;m--){const{client:h,clock:d}=l[m].id,y=i.clients.get(h),p=Gt(y,d);p+1<y.length&&Tn(y,p+1)>1||p>0&&Tn(y,p)}if(!n.local&&n.afterState.get(r.clientID)!==n.beforeState.get(r.clientID)&&(Ri(Qr,Nt,"[yjs] ",Se,ki,"Changed the client-id because another client seems to be using it."),r.clientID=Li()),r.emit("afterTransactionCleanup",[n,r]),r._observers.has("update")){const m=new mn;Fs(m,n)&&r.emit("update",[m.toUint8Array(),n.origin,r,n])}if(r._observers.has("updateV2")){const m=new Ee;Fs(m,n)&&r.emit("updateV2",[m.toUint8Array(),n.origin,r,n])}const{subdocsAdded:c,subdocsLoaded:a,subdocsRemoved:g}=n;(c.size>0||g.size>0||a.size>0)&&(c.forEach(m=>{m.clientID=r.clientID,m.collectionid==null&&(m.collectionid=r.collectionid),r.subdocs.add(m)}),g.forEach(m=>r.subdocs.delete(m)),r.emit("subdocs",[{loaded:a,added:c,removed:g},r,n]),g.forEach(m=>m.destroy())),e.length<=t+1?(r._transactionCleanups=[],r.emit("afterAllTransactions",[r,e])):Hi(e,t+1)}}},ot=(e,t,n=null,r=!0)=>{const i=e._transactionCleanups;let o=!1,l=null;e._transaction===null&&(o=!0,e._transaction=new Oc(e,n,r),i.push(e._transaction),i.length===1&&e.emit("beforeAllTransactions",[e]),e.emit("beforeTransaction",[e._transaction,e]));try{l=t(e._transaction)}finally{if(o){const c=e._transaction===i[0];e._transaction=null,c&&Hi(i,0)}}return l};function*Nc(e){const t=$(e.restDecoder);for(let n=0;n<t;n++){const r=$(e.restDecoder),i=e.readClient();let o=$(e.restDecoder);for(let l=0;l<r;l++){const c=e.readInfo();if(c===10){const a=$(e.restDecoder);yield new Mt(rt(i,o),a),o+=a}else if(zn&c){const a=(c&(ee|Lt))===0,g=new dt(rt(i,o),null,(c&Lt)===Lt?e.readLeftID():null,null,(c&ee)===ee?e.readRightID():null,a?e.readParentInfo()?e.readString():e.readLeftID():null,a&&(c&cn)===cn?e.readString():null,lo(e,c));yield g,o+=g.length}else{const a=e.readLen();yield new It(rt(i,o),a),o+=a}}}}class ss{constructor(t,n){this.gen=Nc(t),this.curr=null,this.done=!1,this.filterSkips=n,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===Mt);return this.curr}}class is{constructor(t){this.currClient=0,this.startClock=0,this.written=0,this.encoder=t,this.clientStructs=[]}}const Uc=e=>Mn(e,Ii,mn),xc=(e,t)=>{if(e.constructor===It){const{client:n,clock:r}=e.id;return new It(rt(n,r+t),e.length-t)}else if(e.constructor===Mt){const{client:n,clock:r}=e.id;return new Mt(rt(n,r+t),e.length-t)}else{const n=e,{client:r,clock:i}=n.id;return new dt(rt(r,i+t),null,rt(r,i+t-1),null,n.rightOrigin,n.parent,n.parentSub,n.content.splice(t))}},Mn=(e,t=Ye,n=Ee)=>{if(e.length===1)return e[0];const r=e.map(m=>new t($t(m)));let i=r.map(m=>new ss(m,!0)),o=null;const l=new n,c=new is(l);for(;i=i.filter(d=>d.curr!==null),i.sort((d,y)=>{if(d.curr.id.client===y.curr.id.client){const p=d.curr.id.clock-y.curr.id.clock;return p===0?d.curr.constructor===y.curr.constructor?0:d.curr.constructor===Mt?1:-1:p}else return y.curr.id.client-d.curr.id.client}),i.length!==0;){const m=i[0],h=m.curr.id.client;if(o!==null){let d=m.curr,y=!1;for(;d!==null&&d.id.clock+d.length<=o.struct.id.clock+o.struct.length&&d.id.client>=o.struct.id.client;)d=m.next(),y=!0;if(d===null||d.id.client!==h||y&&d.id.clock>o.struct.id.clock+o.struct.length)continue;if(h!==o.struct.id.client)ue(c,o.struct,o.offset),o={struct:d,offset:0},m.next();else if(o.struct.id.clock+o.struct.length<d.id.clock)if(o.struct.constructor===Mt)o.struct.length=d.id.clock+d.length-o.struct.id.clock;else{ue(c,o.struct,o.offset);const p=d.id.clock-o.struct.id.clock-o.struct.length;o={struct:new Mt(rt(h,o.struct.id.clock+o.struct.length),p),offset:0}}else{const p=o.struct.id.clock+o.struct.length-d.id.clock;p>0&&(o.struct.constructor===Mt?o.struct.length-=p:d=xc(d,p)),o.struct.mergeWith(d)||(ue(c,o.struct,o.offset),o={struct:d,offset:0},m.next())}}else o={struct:m.curr,offset:0},m.next();for(let d=m.curr;d!==null&&d.id.client===h&&d.id.clock===o.struct.id.clock+o.struct.length&&d.constructor!==Mt;d=m.next())ue(c,o.struct,o.offset),o={struct:d,offset:0}}o!==null&&(ue(c,o.struct,o.offset),o=null),os(c);const a=r.map(m=>es(m)),g=fc(a);return $e(l,g),l.toUint8Array()},Fc=(e,t,n=Ye,r=Ee)=>{const i=Fi(t),o=new r,l=new is(o),c=new n($t(e)),a=new ss(c,!1);for(;a.curr;){const m=a.curr,h=m.id.client,d=i.get(h)||0;if(a.curr.constructor===Mt){a.next();continue}if(m.id.clock+m.length>d)for(ue(l,m,Re(d-m.id.clock,0)),a.next();a.curr&&a.curr.id.client===h;)ue(l,a.curr,0),a.next();else for(;a.curr&&a.curr.id.client===h&&a.curr.id.clock+a.curr.length<=d;)a.next()}os(l);const g=es(c);return $e(o,g),o.toUint8Array()},Wi=e=>{e.written>0&&(e.clientStructs.push({written:e.written,restEncoder:ut(e.encoder.restEncoder)}),e.encoder.restEncoder=mt(),e.written=0)},ue=(e,t,n)=>{e.written>0&&e.currClient!==t.id.client&&Wi(e),e.written===0&&(e.currClient=t.id.client,e.encoder.writeClient(t.id.client),Y(e.encoder.restEncoder,t.id.clock+n)),t.write(e.encoder,n),e.written++},os=e=>{Wi(e);const t=e.encoder.restEncoder;Y(t,e.clientStructs.length);for(let n=0;n<e.clientStructs.length;n++){const r=e.clientStructs[n];Y(t,r.written),Yn(t,r.restEncoder)}},Bc=(e,t,n,r)=>{const i=new n($t(e)),o=new ss(i,!1),l=new r,c=new is(l);for(let g=o.curr;g!==null;g=o.next())ue(c,t(g),0);os(c);const a=es(i);return $e(l,a),l.toUint8Array()},jc=e=>Bc(e,ql,Ye,mn),js="You must not compute changes after the event-handler fired.";class $n{constructor(t,n){this.target=t,this.currentTarget=t,this.transaction=n,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=Pc(this.currentTarget,this.target))}deletes(t){return Di(this.transaction.deleteSet,t.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw Bt(js);const t=new Map,n=this.target;this.transaction.changed.get(n).forEach(i=>{if(i!==null){const o=n._map.get(i);let l,c;if(this.adds(o)){let a=o.left;for(;a!==null&&this.adds(a);)a=a.left;if(this.deletes(o))if(a!==null&&this.deletes(a))l="delete",c=ir(a.content.getContent());else return;else a!==null&&this.deletes(a)?(l="update",c=ir(a.content.getContent())):(l="add",c=void 0)}else if(this.deletes(o))l="delete",c=ir(o.content.getContent());else return;t.set(i,{action:l,oldValue:c})}}),this._keys=t}return this._keys}get delta(){return this.changes.delta}adds(t){return t.id.clock>=(this.transaction.beforeState.get(t.id.client)||0)}get changes(){let t=this._changes;if(t===null){if(this.transaction.doc._transactionCleanups.length===0)throw Bt(js);const n=this.target,r=de(),i=de(),o=[];if(t={added:r,deleted:i,delta:o,keys:this.keys},this.transaction.changed.get(n).has(null)){let c=null;const a=()=>{c&&o.push(c)};for(let g=n._start;g!==null;g=g.right)g.deleted?this.deletes(g)&&!this.adds(g)&&((c===null||c.delete===void 0)&&(a(),c={delete:0}),c.delete+=g.length,i.add(g)):this.adds(g)?((c===null||c.insert===void 0)&&(a(),c={insert:[]}),c.insert=c.insert.concat(g.content.getContent()),r.add(g)):((c===null||c.retain===void 0)&&(a(),c={retain:0}),c.retain+=g.length);c!==null&&c.retain===void 0&&a()}this._changes=t}return t}}const Pc=(e,t)=>{const n=[];for(;t._item!==null&&t!==e;){if(t._item.parentSub!==null)n.unshift(t._item.parentSub);else{let r=0,i=t._item.parent._start;for(;i!==t._item&&i!==null;)i.deleted||r++,i=i.right;n.unshift(r)}t=t._item.parent}return n},zi=80;let ls=0;class qc{constructor(t,n){t.marker=!0,this.p=t,this.index=n,this.timestamp=ls++}}const Vc=e=>{e.timestamp=ls++},Yi=(e,t,n)=>{e.p.marker=!1,e.p=t,t.marker=!0,e.index=n,e.timestamp=ls++},Hc=(e,t,n)=>{if(e.length>=zi){const r=e.reduce((i,o)=>i.timestamp<o.timestamp?i:o);return Yi(r,t,n),r}else{const r=new qc(t,n);return e.push(r),r}},Xn=(e,t)=>{if(e._start===null||t===0||e._searchMarker===null)return null;const n=e._searchMarker.length===0?null:e._searchMarker.reduce((o,l)=>Cn(t-o.index)<Cn(t-l.index)?o:l);let r=e._start,i=0;for(n!==null&&(r=n.p,i=n.index,Vc(n));r.right!==null&&i<t;){if(!r.deleted&&r.countable){if(t<i+r.length)break;i+=r.length}r=r.right}for(;r.left!==null&&i>t;)r=r.left,!r.deleted&&r.countable&&(i-=r.length);for(;r.left!==null&&r.left.id.client===r.id.client&&r.left.id.clock+r.left.length===r.id.clock;)r=r.left,!r.deleted&&r.countable&&(i-=r.length);return n!==null&&Cn(n.index-i)<r.parent.length/zi?(Yi(n,r,i),n):Hc(e._searchMarker,r,i)},hn=(e,t,n)=>{for(let r=e.length-1;r>=0;r--){const i=e[r];if(n>0){let o=i.p;for(o.marker=!1;o&&(o.deleted||!o.countable);)o=o.left,o&&!o.deleted&&o.countable&&(i.index-=o.length);if(o===null||o.marker===!0){e.splice(r,1);continue}i.p=o,o.marker=!0}(t<i.index||n>0&&t===i.index)&&(i.index=Re(t,i.index+n))}},Qn=(e,t,n)=>{const r=e,i=t.changedParentTypes;for(;Ot(i,e,()=>[]).push(n),e._item!==null;)e=e._item.parent;ji(r._eH,n,t)};class wt{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=Ms(),this._dEH=Ms(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(t,n){this.doc=t,this._item=n}_copy(){throw Wt()}clone(){throw Wt()}_write(t){}get _first(){let t=this._start;for(;t!==null&&t.deleted;)t=t.right;return t}_callObserver(t,n){!t.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(t){Ns(this._eH,t)}observeDeep(t){Ns(this._dEH,t)}unobserve(t){Us(this._eH,t)}unobserveDeep(t){Us(this._dEH,t)}toJSON(){}}const Gi=(e,t,n)=>{t<0&&(t=e._length+t),n<0&&(n=e._length+n);let r=n-t;const i=[];let o=e._start;for(;o!==null&&r>0;){if(o.countable&&!o.deleted){const l=o.content.getContent();if(l.length<=t)t-=l.length;else{for(let c=t;c<l.length&&r>0;c++)i.push(l[c]),r--;t=0}}o=o.right}return i},Ji=e=>{const t=[];let n=e._start;for(;n!==null;){if(n.countable&&!n.deleted){const r=n.content.getContent();for(let i=0;i<r.length;i++)t.push(r[i])}n=n.right}return t},fn=(e,t)=>{let n=0,r=e._start;for(;r!==null;){if(r.countable&&!r.deleted){const i=r.content.getContent();for(let o=0;o<i.length;o++)t(i[o],n++,e)}r=r.right}},Ki=(e,t)=>{const n=[];return fn(e,(r,i)=>{n.push(t(r,i,e))}),n},Wc=e=>{let t=e._start,n=null,r=0;return{[Symbol.iterator](){return this},next:()=>{if(n===null){for(;t!==null&&t.deleted;)t=t.right;if(t===null)return{done:!0,value:void 0};n=t.content.getContent(),r=0,t=t.right}const i=n[r++];return n.length<=r&&(n=null),{done:!1,value:i}}}},$i=(e,t)=>{const n=Xn(e,t);let r=e._start;for(n!==null&&(r=n.p,t-=n.index);r!==null;r=r.right)if(!r.deleted&&r.countable){if(t<r.length)return r.content.getContent()[t];t-=r.length}},Nn=(e,t,n,r)=>{let i=n;const o=e.doc,l=o.clientID,c=o.store,a=n===null?t._start:n.right;let g=[];const m=()=>{g.length>0&&(i=new dt(rt(l,bt(c,l)),i,i&&i.lastId,a,a&&a.id,t,null,new Ce(g)),i.integrate(e,0),g=[])};r.forEach(h=>{if(h===null)g.push(h);else switch(h.constructor){case Number:case Object:case Boolean:case Array:case String:g.push(h);break;default:switch(m(),h.constructor){case Uint8Array:case ArrayBuffer:i=new dt(rt(l,bt(c,l)),i,i&&i.lastId,a,a&&a.id,t,null,new bn(new Uint8Array(h))),i.integrate(e,0);break;case Xe:i=new dt(rt(l,bt(c,l)),i,i&&i.lastId,a,a&&a.id,t,null,new _n(h)),i.integrate(e,0);break;default:if(h instanceof wt)i=new dt(rt(l,bt(c,l)),i,i&&i.lastId,a,a&&a.id,t,null,new le(h)),i.integrate(e,0);else throw new Error("Unexpected content type in insert operation")}}}),m()},Xi=()=>Bt("Length exceeded!"),Qi=(e,t,n,r)=>{if(n>t._length)throw Xi();if(n===0)return t._searchMarker&&hn(t._searchMarker,n,r.length),Nn(e,t,null,r);const i=n,o=Xn(t,n);let l=t._start;for(o!==null&&(l=o.p,n-=o.index,n===0&&(l=l.prev,n+=l&&l.countable&&!l.deleted?l.length:0));l!==null;l=l.right)if(!l.deleted&&l.countable){if(n<=l.length){n<l.length&&ge(e,rt(l.id.client,l.id.clock+n));break}n-=l.length}return t._searchMarker&&hn(t._searchMarker,i,r.length),Nn(e,t,l,r)},zc=(e,t,n)=>{let i=(t._searchMarker||[]).reduce((o,l)=>l.index>o.index?l:o,{index:0,p:t._start}).p;if(i)for(;i.right;)i=i.right;return Nn(e,t,i,n)},Zi=(e,t,n,r)=>{if(r===0)return;const i=n,o=r,l=Xn(t,n);let c=t._start;for(l!==null&&(c=l.p,n-=l.index);c!==null&&n>0;c=c.right)!c.deleted&&c.countable&&(n<c.length&&ge(e,rt(c.id.client,c.id.clock+n)),n-=c.length);for(;r>0&&c!==null;)c.deleted||(r<c.length&&ge(e,rt(c.id.client,c.id.clock+r)),c.delete(e),r-=c.length),c=c.right;if(r>0)throw Xi();t._searchMarker&&hn(t._searchMarker,i,-o+r)},Un=(e,t,n)=>{const r=t._map.get(n);r!==void 0&&r.delete(e)},cs=(e,t,n,r)=>{const i=t._map.get(n)||null,o=e.doc,l=o.clientID;let c;if(r==null)c=new Ce([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:c=new Ce([r]);break;case Uint8Array:c=new bn(r);break;case Xe:c=new _n(r);break;default:if(r instanceof wt)c=new le(r);else throw new Error("Unexpected content type")}new dt(rt(l,bt(o.store,l)),i,i&&i.lastId,null,null,t,n,c).integrate(e,0)},as=(e,t)=>{const n=e._map.get(t);return n!==void 0&&!n.deleted?n.content.getContent()[n.length-1]:void 0},to=e=>{const t={};return e._map.forEach((n,r)=>{n.deleted||(t[r]=n.content.getContent()[n.length-1])}),t},eo=(e,t)=>{const n=e._map.get(t);return n!==void 0&&!n.deleted},Yc=(e,t)=>{const n={};return e._map.forEach((r,i)=>{let o=r;for(;o!==null&&(!t.sv.has(o.id.client)||o.id.clock>=(t.sv.get(o.id.client)||0));)o=o.left;o!==null&&Ue(o,t)&&(n[i]=o.content.getContent()[o.length-1])}),n},vn=e=>uc(e.entries(),t=>!t[1].deleted);class Gc extends $n{constructor(t,n){super(t,n),this._transaction=n}}class je extends wt{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(t){const n=new je;return n.push(t),n}_integrate(t,n){super._integrate(t,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new je}clone(){const t=new je;return t.insert(0,this.toArray().map(n=>n instanceof wt?n.clone():n)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}_callObserver(t,n){super._callObserver(t,n),Qn(this,t,new Gc(this,t))}insert(t,n){this.doc!==null?ot(this.doc,r=>{Qi(r,this,t,n)}):this._prelimContent.splice(t,0,...n)}push(t){this.doc!==null?ot(this.doc,n=>{zc(n,this,t)}):this._prelimContent.push(...t)}unshift(t){this.insert(0,t)}delete(t,n=1){this.doc!==null?ot(this.doc,r=>{Zi(r,this,t,n)}):this._prelimContent.splice(t,n)}get(t){return $i(this,t)}toArray(){return Ji(this)}slice(t=0,n=this.length){return Gi(this,t,n)}toJSON(){return this.map(t=>t instanceof wt?t.toJSON():t)}map(t){return Ki(this,t)}forEach(t){fn(this,t)}[Symbol.iterator](){return Wc(this)}_write(t){t.writeTypeRef(ma)}}const Jc=e=>new je;class Kc extends $n{constructor(t,n,r){super(t,n),this.keysChanged=r}}class Ge extends wt{constructor(t){super(),this._prelimContent=null,t===void 0?this._prelimContent=new Map:this._prelimContent=new Map(t)}_integrate(t,n){super._integrate(t,n),this._prelimContent.forEach((r,i)=>{this.set(i,r)}),this._prelimContent=null}_copy(){return new Ge}clone(){const t=new Ge;return this.forEach((n,r)=>{t.set(r,n instanceof wt?n.clone():n)}),t}_callObserver(t,n){Qn(this,t,new Kc(this,t,n))}toJSON(){const t={};return this._map.forEach((n,r)=>{if(!n.deleted){const i=n.content.getContent()[n.length-1];t[r]=i instanceof wt?i.toJSON():i}}),t}get size(){return[...vn(this._map)].length}keys(){return hr(vn(this._map),t=>t[0])}values(){return hr(vn(this._map),t=>t[1].content.getContent()[t[1].length-1])}entries(){return hr(vn(this._map),t=>[t[0],t[1].content.getContent()[t[1].length-1]])}forEach(t){this._map.forEach((n,r)=>{n.deleted||t(n.content.getContent()[n.length-1],r,this)})}[Symbol.iterator](){return this.entries()}delete(t){this.doc!==null?ot(this.doc,n=>{Un(n,this,t)}):this._prelimContent.delete(t)}set(t,n){return this.doc!==null?ot(this.doc,r=>{cs(r,this,t,n)}):this._prelimContent.set(t,n),n}get(t){return as(this,t)}has(t){return eo(this,t)}clear(){this.doc!==null?ot(this.doc,t=>{this.forEach(function(n,r,i){Un(t,i,r)})}):this._prelimContent.clear()}_write(t){t.writeTypeRef(ba)}}const $c=e=>new Ge,he=(e,t)=>e===t||typeof e=="object"&&typeof t=="object"&&e&&t&&jl(e,t);class Tr{constructor(t,n,r,i){this.left=t,this.right=n,this.index=r,this.currentAttributes=i}forward(){switch(this.right===null&&Yt(),this.right.content.constructor){case gt:this.right.deleted||Qe(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const Ps=(e,t,n)=>{for(;t.right!==null&&n>0;){switch(t.right.content.constructor){case gt:t.right.deleted||Qe(t.currentAttributes,t.right.content);break;default:t.right.deleted||(n<t.right.length&&ge(e,rt(t.right.id.client,t.right.id.clock+n)),t.index+=t.right.length,n-=t.right.length);break}t.left=t.right,t.right=t.right.right}return t},Sn=(e,t,n,r)=>{const i=new Map,o=r?Xn(t,n):null;if(o){const l=new Tr(o.p.left,o.p,o.index,i);return Ps(e,l,n-o.index)}else{const l=new Tr(null,t._start,0,i);return Ps(e,l,n)}},no=(e,t,n,r)=>{for(;n.right!==null&&(n.right.deleted===!0||n.right.content.constructor===gt&&he(r.get(n.right.content.key),n.right.content.value));)n.right.deleted||r.delete(n.right.content.key),n.forward();const i=e.doc,o=i.clientID;r.forEach((l,c)=>{const a=n.left,g=n.right,m=new dt(rt(o,bt(i.store,o)),a,a&&a.lastId,g,g&&g.id,t,null,new gt(c,l));m.integrate(e,0),n.right=m,n.forward()})},Qe=(e,t)=>{const{key:n,value:r}=t;r===null?e.delete(n):e.set(n,r)},ro=(e,t)=>{for(;e.right!==null;){if(!(e.right.deleted||e.right.content.constructor===gt&&he(t[e.right.content.key]??null,e.right.content.value)))break;e.forward()}},so=(e,t,n,r)=>{const i=e.doc,o=i.clientID,l=new Map;for(const c in r){const a=r[c],g=n.currentAttributes.get(c)??null;if(!he(g,a)){l.set(c,g);const{left:m,right:h}=n;n.right=new dt(rt(o,bt(i.store,o)),m,m&&m.lastId,h,h&&h.id,t,null,new gt(c,a)),n.right.integrate(e,0),n.forward()}}return l},dr=(e,t,n,r,i)=>{n.currentAttributes.forEach((d,y)=>{i[y]===void 0&&(i[y]=null)});const o=e.doc,l=o.clientID;ro(n,i);const c=so(e,t,n,i),a=r.constructor===String?new Jt(r):r instanceof wt?new le(r):new Ae(r);let{left:g,right:m,index:h}=n;t._searchMarker&&hn(t._searchMarker,n.index,a.getLength()),m=new dt(rt(l,bt(o.store,l)),g,g&&g.lastId,m,m&&m.id,t,null,a),m.integrate(e,0),n.right=m,n.index=h,n.forward(),no(e,t,n,c)},qs=(e,t,n,r,i)=>{const o=e.doc,l=o.clientID;ro(n,i);const c=so(e,t,n,i);t:for(;n.right!==null&&(r>0||c.size>0&&(n.right.deleted||n.right.content.constructor===gt));){if(!n.right.deleted)switch(n.right.content.constructor){case gt:{const{key:a,value:g}=n.right.content,m=i[a];if(m!==void 0){if(he(m,g))c.delete(a);else{if(r===0)break t;c.set(a,g)}n.right.delete(e)}else n.currentAttributes.set(a,g);break}default:r<n.right.length&&ge(e,rt(n.right.id.client,n.right.id.clock+r)),r-=n.right.length;break}n.forward()}if(r>0){let a="";for(;r>0;r--)a+=`
`;n.right=new dt(rt(l,bt(o.store,l)),n.left,n.left&&n.left.lastId,n.right,n.right&&n.right.id,t,null,new Jt(a)),n.right.integrate(e,0),n.forward()}no(e,t,n,c)},io=(e,t,n,r,i)=>{let o=t;const l=Ct();for(;o&&(!o.countable||o.deleted);){if(!o.deleted&&o.content.constructor===gt){const g=o.content;l.set(g.key,g)}o=o.right}let c=0,a=!1;for(;t!==o;){if(n===t&&(a=!0),!t.deleted){const g=t.content;switch(g.constructor){case gt:{const{key:m,value:h}=g,d=r.get(m)??null;(l.get(m)!==g||d===h)&&(t.delete(e),c++,!a&&(i.get(m)??null)===h&&d!==h&&(d===null?i.delete(m):i.set(m,d))),!a&&!t.deleted&&Qe(i,g);break}}}t=t.right}return c},Xc=(e,t)=>{for(;t&&t.right&&(t.right.deleted||!t.right.countable);)t=t.right;const n=new Set;for(;t&&(t.deleted||!t.countable);){if(!t.deleted&&t.content.constructor===gt){const r=t.content.key;n.has(r)?t.delete(e):n.add(r)}t=t.left}},Qc=e=>{let t=0;return ot(e.doc,n=>{let r=e._start,i=e._start,o=Ct();const l=vr(o);for(;i;){if(i.deleted===!1)switch(i.content.constructor){case gt:Qe(l,i.content);break;default:t+=io(n,r,i,o,l),o=vr(l),r=i;break}i=i.right}}),t},Zc=e=>{const t=new Set,n=e.doc;for(const[r,i]of e.afterState.entries()){const o=e.beforeState.get(r)||0;i!==o&&Vi(e,n.store.clients.get(r),o,i,l=>{!l.deleted&&l.content.constructor===gt&&l.constructor!==It&&t.add(l.parent)})}ot(n,r=>{Ti(e,e.deleteSet,i=>{if(i instanceof It||!i.parent._hasFormatting||t.has(i.parent))return;const o=i.parent;i.content.constructor===gt?t.add(o):Xc(r,i)});for(const i of t)Qc(i)})},Vs=(e,t,n)=>{const r=n,i=vr(t.currentAttributes),o=t.right;for(;n>0&&t.right!==null;){if(t.right.deleted===!1)switch(t.right.content.constructor){case le:case Ae:case Jt:n<t.right.length&&ge(e,rt(t.right.id.client,t.right.id.clock+n)),n-=t.right.length,t.right.delete(e);break}t.forward()}o&&io(e,o,t.right,i,t.currentAttributes);const l=(t.left||t.right).parent;return l._searchMarker&&hn(l._searchMarker,t.index,-r+n),t};class ta extends $n{constructor(t,n,r){super(t,n),this.childListChanged=!1,this.keysChanged=new Set,r.forEach(i=>{i===null?this.childListChanged=!0:this.keysChanged.add(i)})}get changes(){if(this._changes===null){const t={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=t}return this._changes}get delta(){if(this._delta===null){const t=this.target.doc,n=[];ot(t,r=>{const i=new Map,o=new Map;let l=this.target._start,c=null;const a={};let g="",m=0,h=0;const d=()=>{if(c!==null){let y=null;switch(c){case"delete":h>0&&(y={delete:h}),h=0;break;case"insert":(typeof g=="object"||g.length>0)&&(y={insert:g},i.size>0&&(y.attributes={},i.forEach((p,w)=>{p!==null&&(y.attributes[w]=p)}))),g="";break;case"retain":m>0&&(y={retain:m},Fl(a)||(y.attributes=Nl({},a))),m=0;break}y&&n.push(y),c=null}};for(;l!==null;){switch(l.content.constructor){case le:case Ae:this.adds(l)?this.deletes(l)||(d(),c="insert",g=l.content.getContent()[0],d()):this.deletes(l)?(c!=="delete"&&(d(),c="delete"),h+=1):l.deleted||(c!=="retain"&&(d(),c="retain"),m+=1);break;case Jt:this.adds(l)?this.deletes(l)||(c!=="insert"&&(d(),c="insert"),g+=l.content.str):this.deletes(l)?(c!=="delete"&&(d(),c="delete"),h+=l.length):l.deleted||(c!=="retain"&&(d(),c="retain"),m+=l.length);break;case gt:{const{key:y,value:p}=l.content;if(this.adds(l)){if(!this.deletes(l)){const w=i.get(y)??null;he(w,p)?p!==null&&l.delete(r):(c==="retain"&&d(),he(p,o.get(y)??null)?delete a[y]:a[y]=p)}}else if(this.deletes(l)){o.set(y,p);const w=i.get(y)??null;he(w,p)||(c==="retain"&&d(),a[y]=w)}else if(!l.deleted){o.set(y,p);const w=a[y];w!==void 0&&(he(w,p)?w!==null&&l.delete(r):(c==="retain"&&d(),p===null?delete a[y]:a[y]=p))}l.deleted||(c==="insert"&&d(),Qe(i,l.content));break}}l=l.right}for(d();n.length>0;){const y=n[n.length-1];if(y.retain!==void 0&&y.attributes===void 0)n.pop();else break}}),this._delta=n}return this._delta}}class Je extends wt{constructor(t){super(),this._pending=t!==void 0?[()=>this.insert(0,t)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this._length}_integrate(t,n){super._integrate(t,n);try{this._pending.forEach(r=>r())}catch(r){console.error(r)}this._pending=null}_copy(){return new Je}clone(){const t=new Je;return t.applyDelta(this.toDelta()),t}_callObserver(t,n){super._callObserver(t,n);const r=new ta(this,t,n);Qn(this,t,r),!t.local&&this._hasFormatting&&(t._needFormattingCleanup=!0)}toString(){let t="",n=this._start;for(;n!==null;)!n.deleted&&n.countable&&n.content.constructor===Jt&&(t+=n.content.str),n=n.right;return t}toJSON(){return this.toString()}applyDelta(t,{sanitize:n=!0}={}){this.doc!==null?ot(this.doc,r=>{const i=new Tr(null,this._start,0,new Map);for(let o=0;o<t.length;o++){const l=t[o];if(l.insert!==void 0){const c=!n&&typeof l.insert=="string"&&o===t.length-1&&i.right===null&&l.insert.slice(-1)===`
`?l.insert.slice(0,-1):l.insert;(typeof c!="string"||c.length>0)&&dr(r,this,i,c,l.attributes||{})}else l.retain!==void 0?qs(r,this,i,l.retain,l.attributes||{}):l.delete!==void 0&&Vs(r,i,l.delete)}}):this._pending.push(()=>this.applyDelta(t))}toDelta(t,n,r){const i=[],o=new Map,l=this.doc;let c="",a=this._start;function g(){if(c.length>0){const h={};let d=!1;o.forEach((p,w)=>{d=!0,h[w]=p});const y={insert:c};d&&(y.attributes=h),i.push(y),c=""}}const m=()=>{for(;a!==null;){if(Ue(a,t)||n!==void 0&&Ue(a,n))switch(a.content.constructor){case Jt:{const h=o.get("ychange");t!==void 0&&!Ue(a,t)?(h===void 0||h.user!==a.id.client||h.type!=="removed")&&(g(),o.set("ychange",r?r("removed",a.id):{type:"removed"})):n!==void 0&&!Ue(a,n)?(h===void 0||h.user!==a.id.client||h.type!=="added")&&(g(),o.set("ychange",r?r("added",a.id):{type:"added"})):h!==void 0&&(g(),o.delete("ychange")),c+=a.content.str;break}case le:case Ae:{g();const h={insert:a.content.getContent()[0]};if(o.size>0){const d={};h.attributes=d,o.forEach((y,p)=>{d[p]=y})}i.push(h);break}case gt:Ue(a,t)&&(g(),Qe(o,a.content));break}a=a.right}g()};return t||n?ot(l,h=>{t&&Rr(h,t),n&&Rr(h,n),m()},"cleanup"):m(),i}insert(t,n,r){if(n.length<=0)return;const i=this.doc;i!==null?ot(i,o=>{const l=Sn(o,this,t,!r);r||(r={},l.currentAttributes.forEach((c,a)=>{r[a]=c})),dr(o,this,l,n,r)}):this._pending.push(()=>this.insert(t,n,r))}insertEmbed(t,n,r){const i=this.doc;i!==null?ot(i,o=>{const l=Sn(o,this,t,!r);dr(o,this,l,n,r||{})}):this._pending.push(()=>this.insertEmbed(t,n,r||{}))}delete(t,n){if(n===0)return;const r=this.doc;r!==null?ot(r,i=>{Vs(i,Sn(i,this,t,!0),n)}):this._pending.push(()=>this.delete(t,n))}format(t,n,r){if(n===0)return;const i=this.doc;i!==null?ot(i,o=>{const l=Sn(o,this,t,!1);l.right!==null&&qs(o,this,l,n,r)}):this._pending.push(()=>this.format(t,n,r))}removeAttribute(t){this.doc!==null?ot(this.doc,n=>{Un(n,this,t)}):this._pending.push(()=>this.removeAttribute(t))}setAttribute(t,n){this.doc!==null?ot(this.doc,r=>{cs(r,this,t,n)}):this._pending.push(()=>this.setAttribute(t,n))}getAttribute(t){return as(this,t)}getAttributes(){return to(this)}_write(t){t.writeTypeRef(_a)}}const ea=e=>new Je;class gr{constructor(t,n=()=>!0){this._filter=n,this._root=t,this._currentNode=t._start,this._firstCall=!0}[Symbol.iterator](){return this}next(){let t=this._currentNode,n=t&&t.content&&t.content.type;if(t!==null&&(!this._firstCall||t.deleted||!this._filter(n)))do if(n=t.content.type,!t.deleted&&(n.constructor===Ke||n.constructor===ke)&&n._start!==null)t=n._start;else for(;t!==null;)if(t.right!==null){t=t.right;break}else t.parent===this._root?t=null:t=t.parent._item;while(t!==null&&(t.deleted||!this._filter(t.content.type)));return this._firstCall=!1,t===null?{value:void 0,done:!0}:(this._currentNode=t,{value:t.content.type,done:!1})}}class ke extends wt{constructor(){super(),this._prelimContent=[]}get firstChild(){const t=this._first;return t?t.content.getContent()[0]:null}_integrate(t,n){super._integrate(t,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new ke}clone(){const t=new ke;return t.insert(0,this.toArray().map(n=>n instanceof wt?n.clone():n)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(t){return new gr(this,t)}querySelector(t){t=t.toUpperCase();const r=new gr(this,i=>i.nodeName&&i.nodeName.toUpperCase()===t).next();return r.done?null:r.value}querySelectorAll(t){return t=t.toUpperCase(),se(new gr(this,n=>n.nodeName&&n.nodeName.toUpperCase()===t))}_callObserver(t,n){Qn(this,t,new sa(this,n,t))}toString(){return Ki(this,t=>t.toString()).join("")}toJSON(){return this.toString()}toDOM(t=document,n={},r){const i=t.createDocumentFragment();return r!==void 0&&r._createAssociation(i,this),fn(this,o=>{i.insertBefore(o.toDOM(t,n,r),null)}),i}insert(t,n){this.doc!==null?ot(this.doc,r=>{Qi(r,this,t,n)}):this._prelimContent.splice(t,0,...n)}insertAfter(t,n){if(this.doc!==null)ot(this.doc,r=>{const i=t&&t instanceof wt?t._item:t;Nn(r,this,i,n)});else{const r=this._prelimContent,i=t===null?0:r.findIndex(o=>o===t)+1;if(i===0&&t!==null)throw Bt("Reference item not found");r.splice(i,0,...n)}}delete(t,n=1){this.doc!==null?ot(this.doc,r=>{Zi(r,this,t,n)}):this._prelimContent.splice(t,n)}toArray(){return Ji(this)}push(t){this.insert(this.length,t)}unshift(t){this.insert(0,t)}get(t){return $i(this,t)}slice(t=0,n=this.length){return Gi(this,t,n)}forEach(t){fn(this,t)}_write(t){t.writeTypeRef(va)}}const na=e=>new ke;class Ke extends ke{constructor(t="UNDEFINED"){super(),this.nodeName=t,this._prelimAttrs=new Map}get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_integrate(t,n){super._integrate(t,n),this._prelimAttrs.forEach((r,i)=>{this.setAttribute(i,r)}),this._prelimAttrs=null}_copy(){return new Ke(this.nodeName)}clone(){const t=new Ke(this.nodeName),n=this.getAttributes();return xl(n,(r,i)=>{typeof r=="string"&&t.setAttribute(i,r)}),t.insert(0,this.toArray().map(r=>r instanceof wt?r.clone():r)),t}toString(){const t=this.getAttributes(),n=[],r=[];for(const c in t)r.push(c);r.sort();const i=r.length;for(let c=0;c<i;c++){const a=r[c];n.push(a+'="'+t[a]+'"')}const o=this.nodeName.toLocaleLowerCase(),l=n.length>0?" "+n.join(" "):"";return`<${o}${l}>${super.toString()}</${o}>`}removeAttribute(t){this.doc!==null?ot(this.doc,n=>{Un(n,this,t)}):this._prelimAttrs.delete(t)}setAttribute(t,n){this.doc!==null?ot(this.doc,r=>{cs(r,this,t,n)}):this._prelimAttrs.set(t,n)}getAttribute(t){return as(this,t)}hasAttribute(t){return eo(this,t)}getAttributes(t){return t?Yc(this,t):to(this)}toDOM(t=document,n={},r){const i=t.createElement(this.nodeName),o=this.getAttributes();for(const l in o){const c=o[l];typeof c=="string"&&i.setAttribute(l,c)}return fn(this,l=>{i.appendChild(l.toDOM(t,n,r))}),r!==void 0&&r._createAssociation(i,this),i}_write(t){t.writeTypeRef(wa),t.writeKey(this.nodeName)}}const ra=e=>new Ke(e.readKey());class sa extends $n{constructor(t,n,r){super(t,r),this.childListChanged=!1,this.attributesChanged=new Set,n.forEach(i=>{i===null?this.childListChanged=!0:this.attributesChanged.add(i)})}}class xn extends Ge{constructor(t){super(),this.hookName=t}_copy(){return new xn(this.hookName)}clone(){const t=new xn(this.hookName);return this.forEach((n,r)=>{t.set(r,n)}),t}toDOM(t=document,n={},r){const i=n[this.hookName];let o;return i!==void 0?o=i.createDom(this):o=document.createElement(this.hookName),o.setAttribute("data-yjs-hook",this.hookName),r!==void 0&&r._createAssociation(o,this),o}_write(t){t.writeTypeRef(Sa),t.writeKey(this.hookName)}}const ia=e=>new xn(e.readKey());class Fn extends Je{get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_copy(){return new Fn}clone(){const t=new Fn;return t.applyDelta(this.toDelta()),t}toDOM(t=document,n,r){const i=t.createTextNode(this.toString());return r!==void 0&&r._createAssociation(i,this),i}toString(){return this.toDelta().map(t=>{const n=[];for(const i in t.attributes){const o=[];for(const l in t.attributes[i])o.push({key:l,value:t.attributes[i][l]});o.sort((l,c)=>l.key<c.key?-1:1),n.push({nodeName:i,attrs:o})}n.sort((i,o)=>i.nodeName<o.nodeName?-1:1);let r="";for(let i=0;i<n.length;i++){const o=n[i];r+=`<${o.nodeName}`;for(let l=0;l<o.attrs.length;l++){const c=o.attrs[l];r+=` ${c.key}="${c.value}"`}r+=">"}r+=t.insert;for(let i=n.length-1;i>=0;i--)r+=`</${n[i].nodeName}>`;return r}).join("")}toJSON(){return this.toString()}_write(t){t.writeTypeRef(Ea)}}const oa=e=>new Fn;class us{constructor(t,n){this.id=t,this.length=n}get deleted(){throw Wt()}mergeWith(t){return!1}write(t,n,r){throw Wt()}integrate(t,n){throw Wt()}}const la=0;class It extends us{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,n){n>0&&(this.id.clock+=n,this.length-=n),qi(t.doc.store,this)}write(t,n){t.writeInfo(la),t.writeLen(this.length-n)}getMissing(t,n){return null}}class bn{constructor(t){this.content=t}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new bn(this.content)}splice(t){throw Wt()}mergeWith(t){return!1}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeBuf(this.content)}getRef(){return 3}}const ca=e=>new bn(e.readBuf());class dn{constructor(t){this.len=t}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new dn(this.len)}splice(t){const n=new dn(this.len-t);return this.len=t,n}mergeWith(t){return this.len+=t.len,!0}integrate(t,n){In(t.deleteSet,n.id.client,n.id.clock,this.len),n.markDeleted()}delete(t){}gc(t){}write(t,n){t.writeLen(this.len-n)}getRef(){return 1}}const aa=e=>new dn(e.readLen()),oo=(e,t)=>new Xe({guid:e,...t,shouldLoad:t.shouldLoad||t.autoLoad||!1});class _n{constructor(t){t._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=t;const n={};this.opts=n,t.gc||(n.gc=!1),t.autoLoad&&(n.autoLoad=!0),t.meta!==null&&(n.meta=t.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new _n(oo(this.doc.guid,this.opts))}splice(t){throw Wt()}mergeWith(t){return!1}integrate(t,n){this.doc._item=n,t.subdocsAdded.add(this.doc),this.doc.shouldLoad&&t.subdocsLoaded.add(this.doc)}delete(t){t.subdocsAdded.has(this.doc)?t.subdocsAdded.delete(this.doc):t.subdocsRemoved.add(this.doc)}gc(t){}write(t,n){t.writeString(this.doc.guid),t.writeAny(this.opts)}getRef(){return 9}}const ua=e=>new _n(oo(e.readString(),e.readAny()));class Ae{constructor(t){this.embed=t}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new Ae(this.embed)}splice(t){throw Wt()}mergeWith(t){return!1}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeJSON(this.embed)}getRef(){return 5}}const ha=e=>new Ae(e.readJSON());class gt{constructor(t,n){this.key=t,this.value=n}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new gt(this.key,this.value)}splice(t){throw Wt()}mergeWith(t){return!1}integrate(t,n){const r=n.parent;r._searchMarker=null,r._hasFormatting=!0}delete(t){}gc(t){}write(t,n){t.writeKey(this.key),t.writeJSON(this.value)}getRef(){return 6}}const fa=e=>new gt(e.readKey(),e.readJSON());class Bn{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Bn(this.arr)}splice(t){const n=new Bn(this.arr.slice(t));return this.arr=this.arr.slice(0,t),n}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){const r=this.arr.length;t.writeLen(r-n);for(let i=n;i<r;i++){const o=this.arr[i];t.writeString(o===void 0?"undefined":JSON.stringify(o))}}getRef(){return 2}}const da=e=>{const t=e.readLen(),n=[];for(let r=0;r<t;r++){const i=e.readString();i==="undefined"?n.push(void 0):n.push(JSON.parse(i))}return new Bn(n)};class Ce{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Ce(this.arr)}splice(t){const n=new Ce(this.arr.slice(t));return this.arr=this.arr.slice(0,t),n}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){const r=this.arr.length;t.writeLen(r-n);for(let i=n;i<r;i++){const o=this.arr[i];t.writeAny(o)}}getRef(){return 8}}const ga=e=>{const t=e.readLen(),n=[];for(let r=0;r<t;r++)n.push(e.readAny());return new Ce(n)};class Jt{constructor(t){this.str=t}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new Jt(this.str)}splice(t){const n=new Jt(this.str.slice(t));this.str=this.str.slice(0,t);const r=this.str.charCodeAt(t-1);return r>=55296&&r<=56319&&(this.str=this.str.slice(0,t-1)+"",n.str=""+n.str.slice(1)),n}mergeWith(t){return this.str+=t.str,!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeString(n===0?this.str:this.str.slice(n))}getRef(){return 4}}const pa=e=>new Jt(e.readString()),ya=[Jc,$c,ea,ra,na,ia,oa],ma=0,ba=1,_a=2,wa=3,va=4,Sa=5,Ea=6;class le{constructor(t){this.type=t}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new le(this.type._copy())}splice(t){throw Wt()}mergeWith(t){return!1}integrate(t,n){this.type._integrate(t.doc,n)}delete(t){let n=this.type._start;for(;n!==null;)n.deleted?n.id.clock<(t.beforeState.get(n.id.client)||0)&&t._mergeStructs.push(n):n.delete(t),n=n.right;this.type._map.forEach(r=>{r.deleted?r.id.clock<(t.beforeState.get(r.id.client)||0)&&t._mergeStructs.push(r):r.delete(t)}),t.changed.delete(this.type)}gc(t){let n=this.type._start;for(;n!==null;)n.gc(t,!0),n=n.right;this.type._start=null,this.type._map.forEach(r=>{for(;r!==null;)r.gc(t,!0),r=r.left}),this.type._map=new Map}write(t,n){this.type._write(t)}getRef(){return 7}}const ka=e=>new le(ya[e.readTypeRef()](e)),jn=(e,t,n)=>{const{client:r,clock:i}=t.id,o=new dt(rt(r,i+n),t,rt(r,i+n-1),t.right,t.rightOrigin,t.parent,t.parentSub,t.content.splice(n));return t.deleted&&o.markDeleted(),t.keep&&(o.keep=!0),t.redone!==null&&(o.redone=rt(t.redone.client,t.redone.clock+n)),t.right=o,o.right!==null&&(o.right.left=o),e._mergeStructs.push(o),o.parentSub!==null&&o.right===null&&o.parent._map.set(o.parentSub,o),t.length=n,o};class dt extends us{constructor(t,n,r,i,o,l,c,a){super(t,a.getLength()),this.origin=r,this.left=n,this.right=i,this.rightOrigin=o,this.parent=l,this.parentSub=c,this.redone=null,this.content=a,this.info=this.content.isCountable()?vs:0}set marker(t){(this.info&lr)>0!==t&&(this.info^=lr)}get marker(){return(this.info&lr)>0}get keep(){return(this.info&ws)>0}set keep(t){this.keep!==t&&(this.info^=ws)}get countable(){return(this.info&vs)>0}get deleted(){return(this.info&or)>0}set deleted(t){this.deleted!==t&&(this.info^=or)}markDeleted(){this.info|=or}getMissing(t,n){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=bt(n,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=bt(n,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===Be&&this.id.client!==this.parent.client&&this.parent.clock>=bt(n,this.parent.client))return this.parent.client;if(this.origin&&(this.left=xs(t,n,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=ge(t,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===It||this.right&&this.right.constructor===It)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===dt&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===dt&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===Be){const r=fr(n,this.parent);r.constructor===It?this.parent=null:this.parent=r.content.type}return null}integrate(t,n){if(n>0&&(this.id.clock+=n,this.left=xs(t,t.doc.store,rt(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(n),this.length-=n),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let r=this.left,i;if(r!==null)i=r.right;else if(this.parentSub!==null)for(i=this.parent._map.get(this.parentSub)||null;i!==null&&i.left!==null;)i=i.left;else i=this.parent._start;const o=new Set,l=new Set;for(;i!==null&&i!==this.right;){if(l.add(i),o.add(i),wn(this.origin,i.origin)){if(i.id.client<this.id.client)r=i,o.clear();else if(wn(this.rightOrigin,i.rightOrigin))break}else if(i.origin!==null&&l.has(fr(t.doc.store,i.origin)))o.has(fr(t.doc.store,i.origin))||(r=i,o.clear());else break;i=i.right}this.left=r}if(this.left!==null){const r=this.left.right;this.right=r,this.left.right=this}else{let r;if(this.parentSub!==null)for(r=this.parent._map.get(this.parentSub)||null;r!==null&&r.left!==null;)r=r.left;else r=this.parent._start,this.parent._start=this;this.right=r}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(t)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),qi(t.doc.store,this),this.content.integrate(t,this),Bs(t,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(t)}else new It(this.id,this.length).integrate(t,0)}get next(){let t=this.right;for(;t!==null&&t.deleted;)t=t.right;return t}get prev(){let t=this.left;for(;t!==null&&t.deleted;)t=t.left;return t}get lastId(){return this.length===1?this.id:rt(this.id.client,this.id.clock+this.length-1)}mergeWith(t){if(this.constructor===t.constructor&&wn(t.origin,this.lastId)&&this.right===t&&wn(this.rightOrigin,t.rightOrigin)&&this.id.client===t.id.client&&this.id.clock+this.length===t.id.clock&&this.deleted===t.deleted&&this.redone===null&&t.redone===null&&this.content.constructor===t.content.constructor&&this.content.mergeWith(t.content)){const n=this.parent._searchMarker;return n&&n.forEach(r=>{r.p===t&&(r.p=this,!this.deleted&&this.countable&&(r.index-=this.length))}),t.keep&&(this.keep=!0),this.right=t.right,this.right!==null&&(this.right.left=this),this.length+=t.length,!0}return!1}delete(t){if(!this.deleted){const n=this.parent;this.countable&&this.parentSub===null&&(n._length-=this.length),this.markDeleted(),In(t.deleteSet,this.id.client,this.id.clock,this.length),Bs(t,n,this.parentSub),this.content.delete(t)}}gc(t,n){if(!this.deleted)throw Yt();this.content.gc(t),n?Lc(t,this,new It(this.id,this.length)):this.content=new dn(this.length)}write(t,n){const r=n>0?rt(this.id.client,this.id.clock+n-1):this.origin,i=this.rightOrigin,o=this.parentSub,l=this.content.getRef()&zn|(r===null?0:Lt)|(i===null?0:ee)|(o===null?0:cn);if(t.writeInfo(l),r!==null&&t.writeLeftID(r),i!==null&&t.writeRightID(i),r===null&&i===null){const c=this.parent;if(c._item!==void 0){const a=c._item;if(a===null){const g=Tc(c);t.writeParentInfo(!0),t.writeString(g)}else t.writeParentInfo(!1),t.writeLeftID(a.id)}else c.constructor===String?(t.writeParentInfo(!0),t.writeString(c)):c.constructor===Be?(t.writeParentInfo(!1),t.writeLeftID(c)):Yt();o!==null&&t.writeString(o)}this.content.write(t,n)}}const lo=(e,t)=>Ca[t&zn](e),Ca=[()=>{Yt()},aa,da,ca,pa,ha,fa,ka,ga,ua,()=>{Yt()}],Ra=10;class Mt extends us{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,n){Yt()}write(t,n){t.writeInfo(Ra),Y(t.restEncoder,this.length-n)}getMissing(t,n){return null}}const co=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},ao="__ $YJS$ __";co[ao]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");co[ao]=!0;var qt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Aa(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Ta(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var i=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return e[r]}})}),n}var Dn={},Zn={};Object.defineProperty(Zn,"__esModule",{value:!0});Zn.readableMap=void 0;function Da(e){let t=new Map(Object.entries(e.toJSON())),n=[];const r=l=>{t!==l&&(t=l,n.forEach(c=>c(t)))},i=(l,c)=>{const a=l.target;r(new Map(Object.entries(a.toJSON())))};return{subscribe:l=>(n=[...n,l],n.length===1&&(t=new Map(Object.entries(e.toJSON())),e.observe(i)),l(t),()=>{n=n.filter(c=>c!==l),n.length===0&&e.unobserve(i)}),y:e}}Zn.readableMap=Da;var tr={};Object.defineProperty(tr,"__esModule",{value:!0});tr.readableArray=void 0;function La(e){let t=e.toArray(),n=[];const r=l=>{t!==l&&(t=l,n.forEach(c=>c(t)))},i=(l,c)=>{const a=l.target;r(a.toArray())};return{subscribe:l=>(n=[...n,l],n.length===1&&(t=e.toArray(),e.observe(i)),l(t),()=>{n=n.filter(c=>c!==l),n.length===0&&e.unobserve(i)}),y:e}}tr.readableArray=La;var er={};const Me=[];function uo(e,t){return{subscribe:ho(e,t).subscribe}}function ho(e,t=At){let n;const r=new Set;function i(c){if(Hn(e,c)&&(e=c,n)){const a=!Me.length;for(const g of r)g[1](),Me.push(g,e);if(a){for(let g=0;g<Me.length;g+=2)Me[g][0](Me[g+1]);Me.length=0}}}function o(c){i(c(e))}function l(c,a=At){const g=[c,a];return r.add(g),r.size===1&&(n=t(i,o)||At),c(e),()=>{r.delete(g),r.size===0&&n&&(n(),n=null)}}return{set:i,update:o,subscribe:l}}function Oa(e,t,n){const r=!Array.isArray(e),i=r?[e]:e;if(!i.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const o=t.length<2;return uo(n,(l,c)=>{let a=!1;const g=[];let m=0,h=At;const d=()=>{if(m)return;h();const p=t(r?g[0]:g,l,c);o?l(p):h=Mr(p)?p:At},y=i.map((p,w)=>Nr(p,I=>{g[w]=I,m&=~(1<<w),a&&d()},()=>{m|=1<<w}));return a=!0,d(),function(){Kt(y),h(),a=!1}})}function Ia(e){return{subscribe:e.subscribe.bind(e)}}const Ma=Object.freeze(Object.defineProperty({__proto__:null,derived:Oa,get:No,readable:uo,readonly:Ia,writable:ho},Symbol.toStringTag,{value:"Module"})),Na=Ta(Ma);Object.defineProperty(er,"__esModule",{value:!0});er.readableUndo=void 0;const Ua=Na;function xa(e){return Ua.readable({undoSize:0,redoSize:0},n=>{let r=0,i=0;const o=()=>{r=e.undoStack.length,i=e.redoStack.length,n({undoSize:r,redoSize:i})},l=()=>{o()},c=()=>{o()};return e.on("stack-item-added",l),e.on("stack-item-popped",c),()=>{e.off("stack-item-added",l),e.off("stack-item-popped",c)}})}er.readableUndo=xa;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.readableUndo=e.readableArray=e.readableMap=void 0;var t=Zn;Object.defineProperty(e,"readableMap",{enumerable:!0,get:function(){return t.readableMap}});var n=tr;Object.defineProperty(e,"readableArray",{enumerable:!0,get:function(){return n.readableArray}});var r=er;Object.defineProperty(e,"readableUndo",{enumerable:!0,get:function(){return r.readableUndo}})})(Dn);const Fa=1200,Ba=2500,Pn=3e4,Dr=e=>{if(e.shouldConnect&&e.ws===null){const t=new WebSocket(e.url),n=e.binaryType;let r=null;n&&(t.binaryType=n),e.ws=t,e.connecting=!0,e.connected=!1,t.onmessage=l=>{e.lastMessageReceived=ie();const c=l.data,a=typeof c=="string"?JSON.parse(c):c;a&&a.type==="pong"&&(clearTimeout(r),r=setTimeout(o,Pn/2)),e.emit("message",[a,e])};const i=l=>{e.ws!==null&&(e.ws=null,e.connecting=!1,e.connected?(e.connected=!1,e.emit("disconnect",[{type:"disconnect",error:l},e])):e.unsuccessfulReconnects++,setTimeout(Dr,Hr(Qo(e.unsuccessfulReconnects+1)*Fa,Ba),e)),clearTimeout(r)},o=()=>{e.ws===t&&e.send({type:"ping"})};t.onclose=()=>i(null),t.onerror=l=>i(l),t.onopen=()=>{e.lastMessageReceived=ie(),e.connecting=!1,e.connected=!0,e.unsuccessfulReconnects=0,e.emit("connect",[{type:"connect"},e]),r=setTimeout(o,Pn/2)}}};class ja extends Vr{constructor(t,{binaryType:n}={}){super(),this.url=t,this.ws=null,this.binaryType=n||null,this.connected=!1,this.connecting=!1,this.unsuccessfulReconnects=0,this.lastMessageReceived=0,this.shouldConnect=!0,this._checkInterval=setInterval(()=>{this.connected&&Pn<ie()-this.lastMessageReceived&&this.ws.close()},Pn/2),Dr(this)}send(t){this.ws&&this.ws.send(JSON.stringify(t))}destroy(){clearInterval(this._checkInterval),this.disconnect(),super.destroy()}disconnect(){this.shouldConnect=!1,this.ws!==null&&this.ws.close()}connect(){this.shouldConnect=!0,!this.connected&&this.ws===null&&Dr(this)}}const fo=new Map;class Pa{constructor(t){this.room=t,this.onmessage=null,this._onChange=n=>n.key===t&&this.onmessage!==null&&this.onmessage({data:vi(n.newValue||"")}),Il(this._onChange)}postMessage(t){pi.setItem(this.room,wi(Jl(t)))}close(){Ml(this._onChange)}}const qa=typeof BroadcastChannel>"u"?Pa:BroadcastChannel,hs=e=>Ot(fo,e,()=>{const t=de(),n=new qa(e);return n.onmessage=r=>t.forEach(i=>i(r.data,"broadcastchannel")),{bc:n,subs:t}}),Va=(e,t)=>(hs(e).subs.add(t),t),Ha=(e,t)=>{const n=hs(e),r=n.subs.delete(t);return r&&n.subs.size===0&&(n.bc.close(),fo.delete(e)),r},Wa=(e,t,n=null)=>{const r=hs(e);r.bc.postMessage(t),r.subs.forEach(i=>i(t,n))},za=()=>{let e=!0;return(t,n)=>{if(e){e=!1;try{t()}finally{e=!0}}else n!==void 0&&n()}};function En(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var go={exports:{}};(function(e,t){(function(n){e.exports=n()})(function(){var n=Math.floor,r=Math.abs,i=Math.pow;return function(){function o(l,c,a){function g(d,y){if(!c[d]){if(!l[d]){var p=typeof En=="function"&&En;if(!y&&p)return p(d,!0);if(m)return m(d,!0);var w=new Error("Cannot find module '"+d+"'");throw w.code="MODULE_NOT_FOUND",w}var I=c[d]={exports:{}};l[d][0].call(I.exports,function(O){var x=l[d][1][O];return g(x||O)},I,I.exports,o,l,c,a)}return c[d].exports}for(var m=typeof En=="function"&&En,h=0;h<a.length;h++)g(a[h]);return g}return o}()({1:[function(o,l,c){function a(v){var S=v.length;if(0<S%4)throw new Error("Invalid string. Length must be a multiple of 4");var R=v.indexOf("=");R===-1&&(R=S);var E=R===S?0:4-R%4;return[R,E]}function g(v,S,R){return 3*(S+R)/4-R}function m(v){var S,R,E=a(v),D=E[0],U=E[1],C=new I(g(v,D,U)),A=0,F=0<U?D-4:D;for(R=0;R<F;R+=4)S=w[v.charCodeAt(R)]<<18|w[v.charCodeAt(R+1)]<<12|w[v.charCodeAt(R+2)]<<6|w[v.charCodeAt(R+3)],C[A++]=255&S>>16,C[A++]=255&S>>8,C[A++]=255&S;return U===2&&(S=w[v.charCodeAt(R)]<<2|w[v.charCodeAt(R+1)]>>4,C[A++]=255&S),U===1&&(S=w[v.charCodeAt(R)]<<10|w[v.charCodeAt(R+1)]<<4|w[v.charCodeAt(R+2)]>>2,C[A++]=255&S>>8,C[A++]=255&S),C}function h(v){return p[63&v>>18]+p[63&v>>12]+p[63&v>>6]+p[63&v]}function d(v,S,R){for(var E,D=[],U=S;U<R;U+=3)E=(16711680&v[U]<<16)+(65280&v[U+1]<<8)+(255&v[U+2]),D.push(h(E));return D.join("")}function y(v){for(var S,R=v.length,E=R%3,D=[],U=16383,C=0,A=R-E;C<A;C+=U)D.push(d(v,C,C+U>A?A:C+U));return E===1?(S=v[R-1],D.push(p[S>>2]+p[63&S<<4]+"==")):E===2&&(S=(v[R-2]<<8)+v[R-1],D.push(p[S>>10]+p[63&S>>4]+p[63&S<<2]+"=")),D.join("")}c.byteLength=function(v){var S=a(v),R=S[0],E=S[1];return 3*(R+E)/4-E},c.toByteArray=m,c.fromByteArray=y;for(var p=[],w=[],I=typeof Uint8Array>"u"?Array:Uint8Array,O="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",x=0,b=O.length;x<b;++x)p[x]=O[x],w[O.charCodeAt(x)]=x;w[45]=62,w[95]=63},{}],2:[function(){},{}],3:[function(o,l,c){(function(){(function(){var a=String.fromCharCode,g=Math.min;function m(s){if(2147483647<s)throw new RangeError('The value "'+s+'" is invalid for option "size"');var u=new Uint8Array(s);return u.__proto__=h.prototype,u}function h(s,u,f){if(typeof s=="number"){if(typeof u=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return w(s)}return d(s,u,f)}function d(s,u,f){if(typeof s=="string")return I(s,u);if(ArrayBuffer.isView(s))return O(s);if(s==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof s);if(L(s,ArrayBuffer)||s&&L(s.buffer,ArrayBuffer))return x(s,u,f);if(typeof s=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var k=s.valueOf&&s.valueOf();if(k!=null&&k!==s)return h.from(k,u,f);var T=b(s);if(T)return T;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof s[Symbol.toPrimitive]=="function")return h.from(s[Symbol.toPrimitive]("string"),u,f);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof s)}function y(s){if(typeof s!="number")throw new TypeError('"size" argument must be of type number');if(0>s)throw new RangeError('The value "'+s+'" is invalid for option "size"')}function p(s,u,f){return y(s),0>=s||u===void 0?m(s):typeof f=="string"?m(s).fill(u,f):m(s).fill(u)}function w(s){return y(s),m(0>s?0:0|v(s))}function I(s,u){if((typeof u!="string"||u==="")&&(u="utf8"),!h.isEncoding(u))throw new TypeError("Unknown encoding: "+u);var f=0|S(s,u),k=m(f),T=k.write(s,u);return T!==f&&(k=k.slice(0,T)),k}function O(s){for(var u=0>s.length?0:0|v(s.length),f=m(u),k=0;k<u;k+=1)f[k]=255&s[k];return f}function x(s,u,f){if(0>u||s.byteLength<u)throw new RangeError('"offset" is outside of buffer bounds');if(s.byteLength<u+(f||0))throw new RangeError('"length" is outside of buffer bounds');var k;return k=u===void 0&&f===void 0?new Uint8Array(s):f===void 0?new Uint8Array(s,u):new Uint8Array(s,u,f),k.__proto__=h.prototype,k}function b(s){if(h.isBuffer(s)){var u=0|v(s.length),f=m(u);return f.length===0||s.copy(f,0,0,u),f}return s.length===void 0?s.type==="Buffer"&&Array.isArray(s.data)?O(s.data):void 0:typeof s.length!="number"||M(s.length)?m(0):O(s)}function v(s){if(s>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|s}function S(s,u){if(h.isBuffer(s))return s.length;if(ArrayBuffer.isView(s)||L(s,ArrayBuffer))return s.byteLength;if(typeof s!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof s);var f=s.length,k=2<arguments.length&&arguments[2]===!0;if(!k&&f===0)return 0;for(var T=!1;;)switch(u){case"ascii":case"latin1":case"binary":return f;case"utf8":case"utf-8":return Qt(s).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*f;case"hex":return f>>>1;case"base64":return xt(s).length;default:if(T)return k?-1:Qt(s).length;u=(""+u).toLowerCase(),T=!0}}function R(s,u,f){var k=!1;if((u===void 0||0>u)&&(u=0),u>this.length||((f===void 0||f>this.length)&&(f=this.length),0>=f)||(f>>>=0,u>>>=0,f<=u))return"";for(s||(s="utf8");;)switch(s){case"hex":return ct(this,u,f);case"utf8":case"utf-8":return lt(this,u,f);case"ascii":return q(this,u,f);case"latin1":case"binary":return X(this,u,f);case"base64":return Q(this,u,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,u,f);default:if(k)throw new TypeError("Unknown encoding: "+s);s=(s+"").toLowerCase(),k=!0}}function E(s,u,f){var k=s[u];s[u]=s[f],s[f]=k}function D(s,u,f,k,T){if(s.length===0)return-1;if(typeof f=="string"?(k=f,f=0):2147483647<f?f=2147483647:-2147483648>f&&(f=-2147483648),f=+f,M(f)&&(f=T?0:s.length-1),0>f&&(f=s.length+f),f>=s.length){if(T)return-1;f=s.length-1}else if(0>f)if(T)f=0;else return-1;if(typeof u=="string"&&(u=h.from(u,k)),h.isBuffer(u))return u.length===0?-1:U(s,u,f,k,T);if(typeof u=="number")return u&=255,typeof Uint8Array.prototype.indexOf=="function"?T?Uint8Array.prototype.indexOf.call(s,u,f):Uint8Array.prototype.lastIndexOf.call(s,u,f):U(s,[u],f,k,T);throw new TypeError("val must be string, number or Buffer")}function U(s,u,f,k,T){function N(De,Ze){return H===1?De[Ze]:De.readUInt16BE(Ze*H)}var H=1,et=s.length,at=u.length;if(k!==void 0&&(k=(k+"").toLowerCase(),k==="ucs2"||k==="ucs-2"||k==="utf16le"||k==="utf-16le")){if(2>s.length||2>u.length)return-1;H=2,et/=2,at/=2,f/=2}var nt;if(T){var tt=-1;for(nt=f;nt<et;nt++)if(N(s,nt)!==N(u,tt===-1?0:nt-tt))tt!==-1&&(nt-=nt-tt),tt=-1;else if(tt===-1&&(tt=nt),nt-tt+1===at)return tt*H}else for(f+at>et&&(f=et-at),nt=f;0<=nt;nt--){for(var _t=!0,me=0;me<at;me++)if(N(s,nt+me)!==N(u,me)){_t=!1;break}if(_t)return nt}return-1}function C(s,u,f,k){f=+f||0;var T=s.length-f;k?(k=+k,k>T&&(k=T)):k=T;var N=u.length;k>N/2&&(k=N/2);for(var H,et=0;et<k;++et){if(H=parseInt(u.substr(2*et,2),16),M(H))return et;s[f+et]=H}return et}function A(s,u,f,k){return Ft(Qt(u,s.length-f),s,f,k)}function F(s,u,f,k){return Ft(ye(u),s,f,k)}function B(s,u,f,k){return F(s,u,f,k)}function G(s,u,f,k){return Ft(xt(u),s,f,k)}function W(s,u,f,k){return Ft(ce(u,s.length-f),s,f,k)}function Q(s,u,f){return u===0&&f===s.length?j.fromByteArray(s):j.fromByteArray(s.slice(u,f))}function lt(s,u,f){f=g(s.length,f);for(var k=[],T=u;T<f;){var N=s[T],H=null,et=239<N?4:223<N?3:191<N?2:1;if(T+et<=f){var at,nt,tt,_t;et===1?128>N&&(H=N):et===2?(at=s[T+1],(192&at)==128&&(_t=(31&N)<<6|63&at,127<_t&&(H=_t))):et===3?(at=s[T+1],nt=s[T+2],(192&at)==128&&(192&nt)==128&&(_t=(15&N)<<12|(63&at)<<6|63&nt,2047<_t&&(55296>_t||57343<_t)&&(H=_t))):et===4&&(at=s[T+1],nt=s[T+2],tt=s[T+3],(192&at)==128&&(192&nt)==128&&(192&tt)==128&&(_t=(15&N)<<18|(63&at)<<12|(63&nt)<<6|63&tt,65535<_t&&1114112>_t&&(H=_t)))}H===null?(H=65533,et=1):65535<H&&(H-=65536,k.push(55296|1023&H>>>10),H=56320|1023&H),k.push(H),T+=et}return it(k)}function it(s){var u=s.length;if(u<=4096)return a.apply(String,s);for(var f="",k=0;k<u;)f+=a.apply(String,s.slice(k,k+=4096));return f}function q(s,u,f){var k="";f=g(s.length,f);for(var T=u;T<f;++T)k+=a(127&s[T]);return k}function X(s,u,f){var k="";f=g(s.length,f);for(var T=u;T<f;++T)k+=a(s[T]);return k}function ct(s,u,f){var k=s.length;(!u||0>u)&&(u=0),(!f||0>f||f>k)&&(f=k);for(var T="",N=u;N<f;++N)T+=Xt(s[N]);return T}function P(s,u,f){for(var k=s.slice(u,f),T="",N=0;N<k.length;N+=2)T+=a(k[N]+256*k[N+1]);return T}function V(s,u,f){if(s%1!=0||0>s)throw new RangeError("offset is not uint");if(s+u>f)throw new RangeError("Trying to access beyond buffer length")}function K(s,u,f,k,T,N){if(!h.isBuffer(s))throw new TypeError('"buffer" argument must be a Buffer instance');if(u>T||u<N)throw new RangeError('"value" argument is out of bounds');if(f+k>s.length)throw new RangeError("Index out of range")}function ft(s,u,f,k){if(f+k>s.length)throw new RangeError("Index out of range");if(0>f)throw new RangeError("Index out of range")}function Et(s,u,f,k,T){return u=+u,f>>>=0,T||ft(s,u,f,4),z.write(s,u,f,k,23,4),f+4}function jt(s,u,f,k,T){return u=+u,f>>>=0,T||ft(s,u,f,8),z.write(s,u,f,k,52,8),f+8}function pe(s){if(s=s.split("=")[0],s=s.trim().replace(_,""),2>s.length)return"";for(;s.length%4!=0;)s+="=";return s}function Xt(s){return 16>s?"0"+s.toString(16):s.toString(16)}function Qt(s,u){u=u||1/0;for(var f,k=s.length,T=null,N=[],H=0;H<k;++H){if(f=s.charCodeAt(H),55295<f&&57344>f){if(!T){if(56319<f){-1<(u-=3)&&N.push(239,191,189);continue}else if(H+1===k){-1<(u-=3)&&N.push(239,191,189);continue}T=f;continue}if(56320>f){-1<(u-=3)&&N.push(239,191,189),T=f;continue}f=(T-55296<<10|f-56320)+65536}else T&&-1<(u-=3)&&N.push(239,191,189);if(T=null,128>f){if(0>(u-=1))break;N.push(f)}else if(2048>f){if(0>(u-=2))break;N.push(192|f>>6,128|63&f)}else if(65536>f){if(0>(u-=3))break;N.push(224|f>>12,128|63&f>>6,128|63&f)}else if(1114112>f){if(0>(u-=4))break;N.push(240|f>>18,128|63&f>>12,128|63&f>>6,128|63&f)}else throw new Error("Invalid code point")}return N}function ye(s){for(var u=[],f=0;f<s.length;++f)u.push(255&s.charCodeAt(f));return u}function ce(s,u){for(var f,k,T,N=[],H=0;H<s.length&&!(0>(u-=2));++H)f=s.charCodeAt(H),k=f>>8,T=f%256,N.push(T),N.push(k);return N}function xt(s){return j.toByteArray(pe(s))}function Ft(s,u,f,k){for(var T=0;T<k&&!(T+f>=u.length||T>=s.length);++T)u[T+f]=s[T];return T}function L(s,u){return s instanceof u||s!=null&&s.constructor!=null&&s.constructor.name!=null&&s.constructor.name===u.name}function M(s){return s!==s}var j=o("base64-js"),z=o("ieee754");c.Buffer=h,c.SlowBuffer=function(s){return+s!=s&&(s=0),h.alloc(+s)},c.INSPECT_MAX_BYTES=50,c.kMaxLength=2147483647,h.TYPED_ARRAY_SUPPORT=function(){try{var s=new Uint8Array(1);return s.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},s.foo()===42}catch{return!1}}(),h.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(h.prototype,"parent",{enumerable:!0,get:function(){return h.isBuffer(this)?this.buffer:void 0}}),Object.defineProperty(h.prototype,"offset",{enumerable:!0,get:function(){return h.isBuffer(this)?this.byteOffset:void 0}}),typeof Symbol<"u"&&Symbol.species!=null&&h[Symbol.species]===h&&Object.defineProperty(h,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),h.poolSize=8192,h.from=function(s,u,f){return d(s,u,f)},h.prototype.__proto__=Uint8Array.prototype,h.__proto__=Uint8Array,h.alloc=function(s,u,f){return p(s,u,f)},h.allocUnsafe=function(s){return w(s)},h.allocUnsafeSlow=function(s){return w(s)},h.isBuffer=function(s){return s!=null&&s._isBuffer===!0&&s!==h.prototype},h.compare=function(s,u){if(L(s,Uint8Array)&&(s=h.from(s,s.offset,s.byteLength)),L(u,Uint8Array)&&(u=h.from(u,u.offset,u.byteLength)),!h.isBuffer(s)||!h.isBuffer(u))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(s===u)return 0;for(var f=s.length,k=u.length,T=0,N=g(f,k);T<N;++T)if(s[T]!==u[T]){f=s[T],k=u[T];break}return f<k?-1:k<f?1:0},h.isEncoding=function(s){switch((s+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(s,u){if(!Array.isArray(s))throw new TypeError('"list" argument must be an Array of Buffers');if(s.length===0)return h.alloc(0);var f;if(u===void 0)for(u=0,f=0;f<s.length;++f)u+=s[f].length;var k=h.allocUnsafe(u),T=0;for(f=0;f<s.length;++f){var N=s[f];if(L(N,Uint8Array)&&(N=h.from(N)),!h.isBuffer(N))throw new TypeError('"list" argument must be an Array of Buffers');N.copy(k,T),T+=N.length}return k},h.byteLength=S,h.prototype._isBuffer=!0,h.prototype.swap16=function(){var s=this.length;if(s%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var u=0;u<s;u+=2)E(this,u,u+1);return this},h.prototype.swap32=function(){var s=this.length;if(s%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var u=0;u<s;u+=4)E(this,u,u+3),E(this,u+1,u+2);return this},h.prototype.swap64=function(){var s=this.length;if(s%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var u=0;u<s;u+=8)E(this,u,u+7),E(this,u+1,u+6),E(this,u+2,u+5),E(this,u+3,u+4);return this},h.prototype.toString=function(){var s=this.length;return s===0?"":arguments.length===0?lt(this,0,s):R.apply(this,arguments)},h.prototype.toLocaleString=h.prototype.toString,h.prototype.equals=function(s){if(!h.isBuffer(s))throw new TypeError("Argument must be a Buffer");return this===s||h.compare(this,s)===0},h.prototype.inspect=function(){var s="",u=c.INSPECT_MAX_BYTES;return s=this.toString("hex",0,u).replace(/(.{2})/g,"$1 ").trim(),this.length>u&&(s+=" ... "),"<Buffer "+s+">"},h.prototype.compare=function(s,u,f,k,T){if(L(s,Uint8Array)&&(s=h.from(s,s.offset,s.byteLength)),!h.isBuffer(s))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof s);if(u===void 0&&(u=0),f===void 0&&(f=s?s.length:0),k===void 0&&(k=0),T===void 0&&(T=this.length),0>u||f>s.length||0>k||T>this.length)throw new RangeError("out of range index");if(k>=T&&u>=f)return 0;if(k>=T)return-1;if(u>=f)return 1;if(u>>>=0,f>>>=0,k>>>=0,T>>>=0,this===s)return 0;for(var N=T-k,H=f-u,et=g(N,H),at=this.slice(k,T),nt=s.slice(u,f),tt=0;tt<et;++tt)if(at[tt]!==nt[tt]){N=at[tt],H=nt[tt];break}return N<H?-1:H<N?1:0},h.prototype.includes=function(s,u,f){return this.indexOf(s,u,f)!==-1},h.prototype.indexOf=function(s,u,f){return D(this,s,u,f,!0)},h.prototype.lastIndexOf=function(s,u,f){return D(this,s,u,f,!1)},h.prototype.write=function(s,u,f,k){if(u===void 0)k="utf8",f=this.length,u=0;else if(f===void 0&&typeof u=="string")k=u,f=this.length,u=0;else if(isFinite(u))u>>>=0,isFinite(f)?(f>>>=0,k===void 0&&(k="utf8")):(k=f,f=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var T=this.length-u;if((f===void 0||f>T)&&(f=T),0<s.length&&(0>f||0>u)||u>this.length)throw new RangeError("Attempt to write outside buffer bounds");k||(k="utf8");for(var N=!1;;)switch(k){case"hex":return C(this,s,u,f);case"utf8":case"utf-8":return A(this,s,u,f);case"ascii":return F(this,s,u,f);case"latin1":case"binary":return B(this,s,u,f);case"base64":return G(this,s,u,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return W(this,s,u,f);default:if(N)throw new TypeError("Unknown encoding: "+k);k=(""+k).toLowerCase(),N=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},h.prototype.slice=function(s,u){var f=this.length;s=~~s,u=u===void 0?f:~~u,0>s?(s+=f,0>s&&(s=0)):s>f&&(s=f),0>u?(u+=f,0>u&&(u=0)):u>f&&(u=f),u<s&&(u=s);var k=this.subarray(s,u);return k.__proto__=h.prototype,k},h.prototype.readUIntLE=function(s,u,f){s>>>=0,u>>>=0,f||V(s,u,this.length);for(var k=this[s],T=1,N=0;++N<u&&(T*=256);)k+=this[s+N]*T;return k},h.prototype.readUIntBE=function(s,u,f){s>>>=0,u>>>=0,f||V(s,u,this.length);for(var k=this[s+--u],T=1;0<u&&(T*=256);)k+=this[s+--u]*T;return k},h.prototype.readUInt8=function(s,u){return s>>>=0,u||V(s,1,this.length),this[s]},h.prototype.readUInt16LE=function(s,u){return s>>>=0,u||V(s,2,this.length),this[s]|this[s+1]<<8},h.prototype.readUInt16BE=function(s,u){return s>>>=0,u||V(s,2,this.length),this[s]<<8|this[s+1]},h.prototype.readUInt32LE=function(s,u){return s>>>=0,u||V(s,4,this.length),(this[s]|this[s+1]<<8|this[s+2]<<16)+16777216*this[s+3]},h.prototype.readUInt32BE=function(s,u){return s>>>=0,u||V(s,4,this.length),16777216*this[s]+(this[s+1]<<16|this[s+2]<<8|this[s+3])},h.prototype.readIntLE=function(s,u,f){s>>>=0,u>>>=0,f||V(s,u,this.length);for(var k=this[s],T=1,N=0;++N<u&&(T*=256);)k+=this[s+N]*T;return T*=128,k>=T&&(k-=i(2,8*u)),k},h.prototype.readIntBE=function(s,u,f){s>>>=0,u>>>=0,f||V(s,u,this.length);for(var k=u,T=1,N=this[s+--k];0<k&&(T*=256);)N+=this[s+--k]*T;return T*=128,N>=T&&(N-=i(2,8*u)),N},h.prototype.readInt8=function(s,u){return s>>>=0,u||V(s,1,this.length),128&this[s]?-1*(255-this[s]+1):this[s]},h.prototype.readInt16LE=function(s,u){s>>>=0,u||V(s,2,this.length);var f=this[s]|this[s+1]<<8;return 32768&f?4294901760|f:f},h.prototype.readInt16BE=function(s,u){s>>>=0,u||V(s,2,this.length);var f=this[s+1]|this[s]<<8;return 32768&f?4294901760|f:f},h.prototype.readInt32LE=function(s,u){return s>>>=0,u||V(s,4,this.length),this[s]|this[s+1]<<8|this[s+2]<<16|this[s+3]<<24},h.prototype.readInt32BE=function(s,u){return s>>>=0,u||V(s,4,this.length),this[s]<<24|this[s+1]<<16|this[s+2]<<8|this[s+3]},h.prototype.readFloatLE=function(s,u){return s>>>=0,u||V(s,4,this.length),z.read(this,s,!0,23,4)},h.prototype.readFloatBE=function(s,u){return s>>>=0,u||V(s,4,this.length),z.read(this,s,!1,23,4)},h.prototype.readDoubleLE=function(s,u){return s>>>=0,u||V(s,8,this.length),z.read(this,s,!0,52,8)},h.prototype.readDoubleBE=function(s,u){return s>>>=0,u||V(s,8,this.length),z.read(this,s,!1,52,8)},h.prototype.writeUIntLE=function(s,u,f,k){if(s=+s,u>>>=0,f>>>=0,!k){var T=i(2,8*f)-1;K(this,s,u,f,T,0)}var N=1,H=0;for(this[u]=255&s;++H<f&&(N*=256);)this[u+H]=255&s/N;return u+f},h.prototype.writeUIntBE=function(s,u,f,k){if(s=+s,u>>>=0,f>>>=0,!k){var T=i(2,8*f)-1;K(this,s,u,f,T,0)}var N=f-1,H=1;for(this[u+N]=255&s;0<=--N&&(H*=256);)this[u+N]=255&s/H;return u+f},h.prototype.writeUInt8=function(s,u,f){return s=+s,u>>>=0,f||K(this,s,u,1,255,0),this[u]=255&s,u+1},h.prototype.writeUInt16LE=function(s,u,f){return s=+s,u>>>=0,f||K(this,s,u,2,65535,0),this[u]=255&s,this[u+1]=s>>>8,u+2},h.prototype.writeUInt16BE=function(s,u,f){return s=+s,u>>>=0,f||K(this,s,u,2,65535,0),this[u]=s>>>8,this[u+1]=255&s,u+2},h.prototype.writeUInt32LE=function(s,u,f){return s=+s,u>>>=0,f||K(this,s,u,4,4294967295,0),this[u+3]=s>>>24,this[u+2]=s>>>16,this[u+1]=s>>>8,this[u]=255&s,u+4},h.prototype.writeUInt32BE=function(s,u,f){return s=+s,u>>>=0,f||K(this,s,u,4,4294967295,0),this[u]=s>>>24,this[u+1]=s>>>16,this[u+2]=s>>>8,this[u+3]=255&s,u+4},h.prototype.writeIntLE=function(s,u,f,k){if(s=+s,u>>>=0,!k){var T=i(2,8*f-1);K(this,s,u,f,T-1,-T)}var N=0,H=1,et=0;for(this[u]=255&s;++N<f&&(H*=256);)0>s&&et===0&&this[u+N-1]!==0&&(et=1),this[u+N]=255&(s/H>>0)-et;return u+f},h.prototype.writeIntBE=function(s,u,f,k){if(s=+s,u>>>=0,!k){var T=i(2,8*f-1);K(this,s,u,f,T-1,-T)}var N=f-1,H=1,et=0;for(this[u+N]=255&s;0<=--N&&(H*=256);)0>s&&et===0&&this[u+N+1]!==0&&(et=1),this[u+N]=255&(s/H>>0)-et;return u+f},h.prototype.writeInt8=function(s,u,f){return s=+s,u>>>=0,f||K(this,s,u,1,127,-128),0>s&&(s=255+s+1),this[u]=255&s,u+1},h.prototype.writeInt16LE=function(s,u,f){return s=+s,u>>>=0,f||K(this,s,u,2,32767,-32768),this[u]=255&s,this[u+1]=s>>>8,u+2},h.prototype.writeInt16BE=function(s,u,f){return s=+s,u>>>=0,f||K(this,s,u,2,32767,-32768),this[u]=s>>>8,this[u+1]=255&s,u+2},h.prototype.writeInt32LE=function(s,u,f){return s=+s,u>>>=0,f||K(this,s,u,4,2147483647,-2147483648),this[u]=255&s,this[u+1]=s>>>8,this[u+2]=s>>>16,this[u+3]=s>>>24,u+4},h.prototype.writeInt32BE=function(s,u,f){return s=+s,u>>>=0,f||K(this,s,u,4,2147483647,-2147483648),0>s&&(s=4294967295+s+1),this[u]=s>>>24,this[u+1]=s>>>16,this[u+2]=s>>>8,this[u+3]=255&s,u+4},h.prototype.writeFloatLE=function(s,u,f){return Et(this,s,u,!0,f)},h.prototype.writeFloatBE=function(s,u,f){return Et(this,s,u,!1,f)},h.prototype.writeDoubleLE=function(s,u,f){return jt(this,s,u,!0,f)},h.prototype.writeDoubleBE=function(s,u,f){return jt(this,s,u,!1,f)},h.prototype.copy=function(s,u,f,k){if(!h.isBuffer(s))throw new TypeError("argument should be a Buffer");if(f||(f=0),k||k===0||(k=this.length),u>=s.length&&(u=s.length),u||(u=0),0<k&&k<f&&(k=f),k===f||s.length===0||this.length===0)return 0;if(0>u)throw new RangeError("targetStart out of bounds");if(0>f||f>=this.length)throw new RangeError("Index out of range");if(0>k)throw new RangeError("sourceEnd out of bounds");k>this.length&&(k=this.length),s.length-u<k-f&&(k=s.length-u+f);var T=k-f;if(this===s&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(u,f,k);else if(this===s&&f<u&&u<k)for(var N=T-1;0<=N;--N)s[N+u]=this[N+f];else Uint8Array.prototype.set.call(s,this.subarray(f,k),u);return T},h.prototype.fill=function(s,u,f,k){if(typeof s=="string"){if(typeof u=="string"?(k=u,u=0,f=this.length):typeof f=="string"&&(k=f,f=this.length),k!==void 0&&typeof k!="string")throw new TypeError("encoding must be a string");if(typeof k=="string"&&!h.isEncoding(k))throw new TypeError("Unknown encoding: "+k);if(s.length===1){var T=s.charCodeAt(0);(k==="utf8"&&128>T||k==="latin1")&&(s=T)}}else typeof s=="number"&&(s&=255);if(0>u||this.length<u||this.length<f)throw new RangeError("Out of range index");if(f<=u)return this;u>>>=0,f=f===void 0?this.length:f>>>0,s||(s=0);var N;if(typeof s=="number")for(N=u;N<f;++N)this[N]=s;else{var H=h.isBuffer(s)?s:h.from(s,k),et=H.length;if(et===0)throw new TypeError('The value "'+s+'" is invalid for argument "value"');for(N=0;N<f-u;++N)this[N+u]=H[N%et]}return this};var _=/[^+/0-9A-Za-z-_]/g}).call(this)}).call(this,o("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:9}],4:[function(o,l,c){(function(a){(function(){function g(){let h;try{h=c.storage.getItem("debug")}catch{}return!h&&typeof a<"u"&&"env"in a&&(h=a.env.DEBUG),h}c.formatArgs=function(h){if(h[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+h[0]+(this.useColors?"%c ":" ")+"+"+l.exports.humanize(this.diff),!this.useColors)return;const d="color: "+this.color;h.splice(1,0,d,"color: inherit");let y=0,p=0;h[0].replace(/%[a-zA-Z%]/g,w=>{w==="%%"||(y++,w==="%c"&&(p=y))}),h.splice(p,0,d)},c.save=function(h){try{h?c.storage.setItem("debug",h):c.storage.removeItem("debug")}catch{}},c.load=g,c.useColors=function(){return!!(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},c.storage=function(){try{return localStorage}catch{}}(),c.destroy=(()=>{let h=!1;return()=>{h||(h=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),c.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],c.log=console.debug||console.log||(()=>{}),l.exports=o("./common")(c);const{formatters:m}=l.exports;m.j=function(h){try{return JSON.stringify(h)}catch(d){return"[UnexpectedJSONParseError]: "+d.message}}}).call(this)}).call(this,o("_process"))},{"./common":5,_process:12}],5:[function(o,l){l.exports=function(c){function a(h){function d(...w){if(!d.enabled)return;const I=d,O=+new Date,x=O-(y||O);I.diff=x,I.prev=y,I.curr=O,y=O,w[0]=a.coerce(w[0]),typeof w[0]!="string"&&w.unshift("%O");let b=0;w[0]=w[0].replace(/%([a-zA-Z%])/g,(S,R)=>{if(S==="%%")return"%";b++;const E=a.formatters[R];if(typeof E=="function"){const D=w[b];S=E.call(I,D),w.splice(b,1),b--}return S}),a.formatArgs.call(I,w),(I.log||a.log).apply(I,w)}let y,p=null;return d.namespace=h,d.useColors=a.useColors(),d.color=a.selectColor(h),d.extend=g,d.destroy=a.destroy,Object.defineProperty(d,"enabled",{enumerable:!0,configurable:!1,get:()=>p===null?a.enabled(h):p,set:w=>{p=w}}),typeof a.init=="function"&&a.init(d),d}function g(h,d){const y=a(this.namespace+(typeof d>"u"?":":d)+h);return y.log=this.log,y}function m(h){return h.toString().substring(2,h.toString().length-2).replace(/\.\*\?$/,"*")}return a.debug=a,a.default=a,a.coerce=function(h){return h instanceof Error?h.stack||h.message:h},a.disable=function(){const h=[...a.names.map(m),...a.skips.map(m).map(d=>"-"+d)].join(",");return a.enable(""),h},a.enable=function(h){a.save(h),a.names=[],a.skips=[];let d;const y=(typeof h=="string"?h:"").split(/[\s,]+/),p=y.length;for(d=0;d<p;d++)y[d]&&(h=y[d].replace(/\*/g,".*?"),h[0]==="-"?a.skips.push(new RegExp("^"+h.substr(1)+"$")):a.names.push(new RegExp("^"+h+"$")))},a.enabled=function(h){if(h[h.length-1]==="*")return!0;let d,y;for(d=0,y=a.skips.length;d<y;d++)if(a.skips[d].test(h))return!1;for(d=0,y=a.names.length;d<y;d++)if(a.names[d].test(h))return!0;return!1},a.humanize=o("ms"),a.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(c).forEach(h=>{a[h]=c[h]}),a.names=[],a.skips=[],a.formatters={},a.selectColor=function(h){let d=0;for(let y=0;y<h.length;y++)d=(d<<5)-d+h.charCodeAt(y),d|=0;return a.colors[r(d)%a.colors.length]},a.enable(a.load()),a}},{ms:11}],6:[function(o,l){function c(a,g){for(const m in g)Object.defineProperty(a,m,{value:g[m],enumerable:!0,configurable:!0});return a}l.exports=function(a,g,m){if(!a||typeof a=="string")throw new TypeError("Please pass an Error to err-code");m||(m={}),typeof g=="object"&&(m=g,g=""),g&&(m.code=g);try{return c(a,m)}catch{m.message=a.message,m.stack=a.stack;const d=function(){};return d.prototype=Object.create(Object.getPrototypeOf(a)),c(new d,m)}}},{}],7:[function(o,l){function c(C){console&&console.warn&&console.warn(C)}function a(){a.init.call(this)}function g(C){if(typeof C!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof C)}function m(C){return C._maxListeners===void 0?a.defaultMaxListeners:C._maxListeners}function h(C,A,F,B){var G,W,Q;if(g(F),W=C._events,W===void 0?(W=C._events=Object.create(null),C._eventsCount=0):(W.newListener!==void 0&&(C.emit("newListener",A,F.listener?F.listener:F),W=C._events),Q=W[A]),Q===void 0)Q=W[A]=F,++C._eventsCount;else if(typeof Q=="function"?Q=W[A]=B?[F,Q]:[Q,F]:B?Q.unshift(F):Q.push(F),G=m(C),0<G&&Q.length>G&&!Q.warned){Q.warned=!0;var lt=new Error("Possible EventEmitter memory leak detected. "+Q.length+" "+(A+" listeners added. Use emitter.setMaxListeners() to increase limit"));lt.name="MaxListenersExceededWarning",lt.emitter=C,lt.type=A,lt.count=Q.length,c(lt)}return C}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function y(C,A,F){var B={fired:!1,wrapFn:void 0,target:C,type:A,listener:F},G=d.bind(B);return G.listener=F,B.wrapFn=G,G}function p(C,A,F){var B=C._events;if(B===void 0)return[];var G=B[A];return G===void 0?[]:typeof G=="function"?F?[G.listener||G]:[G]:F?x(G):I(G,G.length)}function w(C){var A=this._events;if(A!==void 0){var F=A[C];if(typeof F=="function")return 1;if(F!==void 0)return F.length}return 0}function I(C,A){for(var F=Array(A),B=0;B<A;++B)F[B]=C[B];return F}function O(C,A){for(;A+1<C.length;A++)C[A]=C[A+1];C.pop()}function x(C){for(var A=Array(C.length),F=0;F<A.length;++F)A[F]=C[F].listener||C[F];return A}function b(C,A,F){typeof C.on=="function"&&v(C,"error",A,F)}function v(C,A,F,B){if(typeof C.on=="function")B.once?C.once(A,F):C.on(A,F);else if(typeof C.addEventListener=="function")C.addEventListener(A,function G(W){B.once&&C.removeEventListener(A,G),F(W)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof C)}var S,R=typeof Reflect=="object"?Reflect:null,E=R&&typeof R.apply=="function"?R.apply:function(C,A,F){return Function.prototype.apply.call(C,A,F)};S=R&&typeof R.ownKeys=="function"?R.ownKeys:Object.getOwnPropertySymbols?function(C){return Object.getOwnPropertyNames(C).concat(Object.getOwnPropertySymbols(C))}:function(C){return Object.getOwnPropertyNames(C)};var D=Number.isNaN||function(C){return C!==C};l.exports=a,l.exports.once=function(C,A){return new Promise(function(F,B){function G(Q){C.removeListener(A,W),B(Q)}function W(){typeof C.removeListener=="function"&&C.removeListener("error",G),F([].slice.call(arguments))}v(C,A,W,{once:!0}),A!=="error"&&b(C,G,{once:!0})})},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var U=10;Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return U},set:function(C){if(typeof C!="number"||0>C||D(C))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+C+".");U=C}}),a.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(C){if(typeof C!="number"||0>C||D(C))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+C+".");return this._maxListeners=C,this},a.prototype.getMaxListeners=function(){return m(this)},a.prototype.emit=function(C){for(var A=[],F=1;F<arguments.length;F++)A.push(arguments[F]);var B=C==="error",G=this._events;if(G!==void 0)B=B&&G.error===void 0;else if(!B)return!1;if(B){var W;if(0<A.length&&(W=A[0]),W instanceof Error)throw W;var Q=new Error("Unhandled error."+(W?" ("+W.message+")":""));throw Q.context=W,Q}var lt=G[C];if(lt===void 0)return!1;if(typeof lt=="function")E(lt,this,A);else for(var it=lt.length,q=I(lt,it),F=0;F<it;++F)E(q[F],this,A);return!0},a.prototype.addListener=function(C,A){return h(this,C,A,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(C,A){return h(this,C,A,!0)},a.prototype.once=function(C,A){return g(A),this.on(C,y(this,C,A)),this},a.prototype.prependOnceListener=function(C,A){return g(A),this.prependListener(C,y(this,C,A)),this},a.prototype.removeListener=function(C,A){var F,B,G,W,Q;if(g(A),B=this._events,B===void 0)return this;if(F=B[C],F===void 0)return this;if(F===A||F.listener===A)--this._eventsCount==0?this._events=Object.create(null):(delete B[C],B.removeListener&&this.emit("removeListener",C,F.listener||A));else if(typeof F!="function"){for(G=-1,W=F.length-1;0<=W;W--)if(F[W]===A||F[W].listener===A){Q=F[W].listener,G=W;break}if(0>G)return this;G===0?F.shift():O(F,G),F.length===1&&(B[C]=F[0]),B.removeListener!==void 0&&this.emit("removeListener",C,Q||A)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(C){var A,F,B;if(F=this._events,F===void 0)return this;if(F.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):F[C]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete F[C]),this;if(arguments.length===0){var G,W=Object.keys(F);for(B=0;B<W.length;++B)G=W[B],G!=="removeListener"&&this.removeAllListeners(G);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(A=F[C],typeof A=="function")this.removeListener(C,A);else if(A!==void 0)for(B=A.length-1;0<=B;B--)this.removeListener(C,A[B]);return this},a.prototype.listeners=function(C){return p(this,C,!0)},a.prototype.rawListeners=function(C){return p(this,C,!1)},a.listenerCount=function(C,A){return typeof C.listenerCount=="function"?C.listenerCount(A):w.call(C,A)},a.prototype.listenerCount=w,a.prototype.eventNames=function(){return 0<this._eventsCount?S(this._events):[]}},{}],8:[function(o,l){l.exports=function(){if(typeof globalThis>"u")return null;var c={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return c.RTCPeerConnection?c:null}},{}],9:[function(o,l,c){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */c.read=function(a,g,m,h,d){var y,p,w=8*d-h-1,I=(1<<w)-1,O=I>>1,x=-7,b=m?d-1:0,v=m?-1:1,S=a[g+b];for(b+=v,y=S&(1<<-x)-1,S>>=-x,x+=w;0<x;y=256*y+a[g+b],b+=v,x-=8);for(p=y&(1<<-x)-1,y>>=-x,x+=h;0<x;p=256*p+a[g+b],b+=v,x-=8);if(y===0)y=1-O;else{if(y===I)return p?NaN:(S?-1:1)*(1/0);p+=i(2,h),y-=O}return(S?-1:1)*p*i(2,y-h)},c.write=function(a,g,m,h,d,y){var p,w,I,O=Math.LN2,x=Math.log,b=8*y-d-1,v=(1<<b)-1,S=v>>1,R=d===23?i(2,-24)-i(2,-77):0,E=h?0:y-1,D=h?1:-1,U=0>g||g===0&&0>1/g?1:0;for(g=r(g),isNaN(g)||g===1/0?(w=isNaN(g)?1:0,p=v):(p=n(x(g)/O),1>g*(I=i(2,-p))&&(p--,I*=2),g+=1<=p+S?R/I:R*i(2,1-S),2<=g*I&&(p++,I/=2),p+S>=v?(w=0,p=v):1<=p+S?(w=(g*I-1)*i(2,d),p+=S):(w=g*i(2,S-1)*i(2,d),p=0));8<=d;a[m+E]=255&w,E+=D,w/=256,d-=8);for(p=p<<d|w,b+=d;0<b;a[m+E]=255&p,E+=D,p/=256,b-=8);a[m+E-D]|=128*U}},{}],10:[function(o,l){l.exports=typeof Object.create=="function"?function(c,a){a&&(c.super_=a,c.prototype=Object.create(a.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}))}:function(c,a){if(a){c.super_=a;var g=function(){};g.prototype=a.prototype,c.prototype=new g,c.prototype.constructor=c}}},{}],11:[function(o,l){var c=Math.round;function a(d){if(d+="",!(100<d.length)){var y=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(d);if(y){var p=parseFloat(y[1]),w=(y[2]||"ms").toLowerCase();return w==="years"||w==="year"||w==="yrs"||w==="yr"||w==="y"?315576e5*p:w==="weeks"||w==="week"||w==="w"?6048e5*p:w==="days"||w==="day"||w==="d"?864e5*p:w==="hours"||w==="hour"||w==="hrs"||w==="hr"||w==="h"?36e5*p:w==="minutes"||w==="minute"||w==="mins"||w==="min"||w==="m"?6e4*p:w==="seconds"||w==="second"||w==="secs"||w==="sec"||w==="s"?1e3*p:w==="milliseconds"||w==="millisecond"||w==="msecs"||w==="msec"||w==="ms"?p:void 0}}}function g(d){var y=r(d);return 864e5<=y?c(d/864e5)+"d":36e5<=y?c(d/36e5)+"h":6e4<=y?c(d/6e4)+"m":1e3<=y?c(d/1e3)+"s":d+"ms"}function m(d){var y=r(d);return 864e5<=y?h(d,y,864e5,"day"):36e5<=y?h(d,y,36e5,"hour"):6e4<=y?h(d,y,6e4,"minute"):1e3<=y?h(d,y,1e3,"second"):d+" ms"}function h(d,y,p,w){return c(d/p)+" "+w+(y>=1.5*p?"s":"")}l.exports=function(d,y){y=y||{};var p=typeof d;if(p=="string"&&0<d.length)return a(d);if(p==="number"&&isFinite(d))return y.long?m(d):g(d);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(d))}},{}],12:[function(o,l){function c(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function g(R){if(w===setTimeout)return setTimeout(R,0);if((w===c||!w)&&setTimeout)return w=setTimeout,setTimeout(R,0);try{return w(R,0)}catch{try{return w.call(null,R,0)}catch{return w.call(this,R,0)}}}function m(R){if(I===clearTimeout)return clearTimeout(R);if((I===a||!I)&&clearTimeout)return I=clearTimeout,clearTimeout(R);try{return I(R)}catch{try{return I.call(null,R)}catch{return I.call(this,R)}}}function h(){v&&x&&(v=!1,x.length?b=x.concat(b):S=-1,b.length&&d())}function d(){if(!v){var R=g(h);v=!0;for(var E=b.length;E;){for(x=b,b=[];++S<E;)x&&x[S].run();S=-1,E=b.length}x=null,v=!1,m(R)}}function y(R,E){this.fun=R,this.array=E}function p(){}var w,I,O=l.exports={};(function(){try{w=typeof setTimeout=="function"?setTimeout:c}catch{w=c}try{I=typeof clearTimeout=="function"?clearTimeout:a}catch{I=a}})();var x,b=[],v=!1,S=-1;O.nextTick=function(R){var E=Array(arguments.length-1);if(1<arguments.length)for(var D=1;D<arguments.length;D++)E[D-1]=arguments[D];b.push(new y(R,E)),b.length!==1||v||g(d)},y.prototype.run=function(){this.fun.apply(null,this.array)},O.title="browser",O.browser=!0,O.env={},O.argv=[],O.version="",O.versions={},O.on=p,O.addListener=p,O.once=p,O.off=p,O.removeListener=p,O.removeAllListeners=p,O.emit=p,O.prependListener=p,O.prependOnceListener=p,O.listeners=function(){return[]},O.binding=function(){throw new Error("process.binding is not supported")},O.cwd=function(){return"/"},O.chdir=function(){throw new Error("process.chdir is not supported")},O.umask=function(){return 0}},{}],13:[function(o,l){(function(c){(function(){/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let a;l.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window>"u"?c:window):g=>(a||(a=Promise.resolve())).then(g).catch(m=>setTimeout(()=>{throw m},0))}).call(this)}).call(this,typeof qt>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:qt)},{}],14:[function(o,l){(function(c,a){(function(){var g=o("safe-buffer").Buffer,m=a.crypto||a.msCrypto;l.exports=m&&m.getRandomValues?function(h,d){if(h>4294967295)throw new RangeError("requested too many random bytes");var y=g.allocUnsafe(h);if(0<h)if(65536<h)for(var p=0;p<h;p+=65536)m.getRandomValues(y.slice(p,p+65536));else m.getRandomValues(y);return typeof d=="function"?c.nextTick(function(){d(null,y)}):y}:function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,o("_process"),typeof qt>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:qt)},{_process:12,"safe-buffer":30}],15:[function(o,l){function c(p,w){p.prototype=Object.create(w.prototype),p.prototype.constructor=p,p.__proto__=w}function a(p,w,I){function O(b,v,S){return typeof w=="string"?w:w(b,v,S)}I||(I=Error);var x=function(b){function v(S,R,E){return b.call(this,O(S,R,E))||this}return c(v,b),v}(I);x.prototype.name=I.name,x.prototype.code=p,y[p]=x}function g(p,w){if(Array.isArray(p)){var I=p.length;return p=p.map(function(O){return O+""}),2<I?"one of ".concat(w," ").concat(p.slice(0,I-1).join(", "),", or ")+p[I-1]:I===2?"one of ".concat(w," ").concat(p[0]," or ").concat(p[1]):"of ".concat(w," ").concat(p[0])}return"of ".concat(w," ").concat(p+"")}function m(p,w,I){return p.substr(!I||0>I?0:+I,w.length)===w}function h(p,w,I){return(I===void 0||I>p.length)&&(I=p.length),p.substring(I-w.length,I)===w}function d(p,w,I){return typeof I!="number"&&(I=0),!(I+w.length>p.length)&&p.indexOf(w,I)!==-1}var y={};a("ERR_INVALID_OPT_VALUE",function(p,w){return'The value "'+w+'" is invalid for option "'+p+'"'},TypeError),a("ERR_INVALID_ARG_TYPE",function(p,w,I){var O;typeof w=="string"&&m(w,"not ")?(O="must not be",w=w.replace(/^not /,"")):O="must be";var x;if(h(p," argument"))x="The ".concat(p," ").concat(O," ").concat(g(w,"type"));else{var b=d(p,".")?"property":"argument";x='The "'.concat(p,'" ').concat(b," ").concat(O," ").concat(g(w,"type"))}return x+=". Received type ".concat(typeof I),x},TypeError),a("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),a("ERR_METHOD_NOT_IMPLEMENTED",function(p){return"The "+p+" method is not implemented"}),a("ERR_STREAM_PREMATURE_CLOSE","Premature close"),a("ERR_STREAM_DESTROYED",function(p){return"Cannot call "+p+" after a stream was destroyed"}),a("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),a("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),a("ERR_STREAM_WRITE_AFTER_END","write after end"),a("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),a("ERR_UNKNOWN_ENCODING",function(p){return"Unknown encoding: "+p},TypeError),a("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),l.exports.codes=y},{}],16:[function(o,l){(function(c){(function(){function a(O){return this instanceof a?(d.call(this,O),y.call(this,O),this.allowHalfOpen=!0,void(O&&(O.readable===!1&&(this.readable=!1),O.writable===!1&&(this.writable=!1),O.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",g))))):new a(O)}function g(){this._writableState.ended||c.nextTick(m,this)}function m(O){O.end()}var h=Object.keys||function(O){var x=[];for(var b in O)x.push(b);return x};l.exports=a;var d=o("./_stream_readable"),y=o("./_stream_writable");o("inherits")(a,d);for(var p,w=h(y.prototype),I=0;I<w.length;I++)p=w[I],a.prototype[p]||(a.prototype[p]=y.prototype[p]);Object.defineProperty(a.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(a.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(a.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(a.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(O){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=O,this._writableState.destroyed=O)}})}).call(this)}).call(this,o("_process"))},{"./_stream_readable":18,"./_stream_writable":20,_process:12,inherits:10}],17:[function(o,l){function c(g){return this instanceof c?void a.call(this,g):new c(g)}l.exports=c;var a=o("./_stream_transform");o("inherits")(c,a),c.prototype._transform=function(g,m,h){h(null,g)}},{"./_stream_transform":19,inherits:10}],18:[function(o,l){(function(c,a){(function(){function g(_){return P.from(_)}function m(_){return P.isBuffer(_)||_ instanceof V}function h(_,s,u){return typeof _.prependListener=="function"?_.prependListener(s,u):void(_._events&&_._events[s]?Array.isArray(_._events[s])?_._events[s].unshift(u):_._events[s]=[u,_._events[s]]:_.on(s,u))}function d(_,s,u){it=it||o("./_stream_duplex"),_=_||{},typeof u!="boolean"&&(u=s instanceof it),this.objectMode=!!_.objectMode,u&&(this.objectMode=this.objectMode||!!_.readableObjectMode),this.highWaterMark=ye(this,_,"readableHighWaterMark",u),this.buffer=new pe,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=_.emitClose!==!1,this.autoDestroy=!!_.autoDestroy,this.destroyed=!1,this.defaultEncoding=_.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,_.encoding&&(!ft&&(ft=o("string_decoder/").StringDecoder),this.decoder=new ft(_.encoding),this.encoding=_.encoding)}function y(_){if(it=it||o("./_stream_duplex"),!(this instanceof y))return new y(_);var s=this instanceof it;this._readableState=new d(_,this,s),this.readable=!0,_&&(typeof _.read=="function"&&(this._read=_.read),typeof _.destroy=="function"&&(this._destroy=_.destroy)),ct.call(this)}function p(_,s,u,f,k){q("readableAddChunk",s);var T=_._readableState;if(s===null)T.reading=!1,b(_,T);else{var N;if(k||(N=I(T,s)),N)j(_,N);else if(!(T.objectMode||s&&0<s.length))f||(T.reading=!1,R(_,T));else if(typeof s=="string"||T.objectMode||Object.getPrototypeOf(s)===P.prototype||(s=g(s)),f)T.endEmitted?j(_,new M):w(_,T,s,!0);else if(T.ended)j(_,new Ft);else{if(T.destroyed)return!1;T.reading=!1,T.decoder&&!u?(s=T.decoder.write(s),T.objectMode||s.length!==0?w(_,T,s,!1):R(_,T)):w(_,T,s,!1)}}return!T.ended&&(T.length<T.highWaterMark||T.length===0)}function w(_,s,u,f){s.flowing&&s.length===0&&!s.sync?(s.awaitDrain=0,_.emit("data",u)):(s.length+=s.objectMode?1:u.length,f?s.buffer.unshift(u):s.buffer.push(u),s.needReadable&&v(_)),R(_,s)}function I(_,s){var u;return m(s)||typeof s=="string"||s===void 0||_.objectMode||(u=new xt("chunk",["string","Buffer","Uint8Array"],s)),u}function O(_){return 1073741824<=_?_=1073741824:(_--,_|=_>>>1,_|=_>>>2,_|=_>>>4,_|=_>>>8,_|=_>>>16,_++),_}function x(_,s){return 0>=_||s.length===0&&s.ended?0:s.objectMode?1:_===_?(_>s.highWaterMark&&(s.highWaterMark=O(_)),_<=s.length?_:s.ended?s.length:(s.needReadable=!0,0)):s.flowing&&s.length?s.buffer.head.data.length:s.length}function b(_,s){if(q("onEofChunk"),!s.ended){if(s.decoder){var u=s.decoder.end();u&&u.length&&(s.buffer.push(u),s.length+=s.objectMode?1:u.length)}s.ended=!0,s.sync?v(_):(s.needReadable=!1,!s.emittedReadable&&(s.emittedReadable=!0,S(_)))}}function v(_){var s=_._readableState;q("emitReadable",s.needReadable,s.emittedReadable),s.needReadable=!1,s.emittedReadable||(q("emitReadable",s.flowing),s.emittedReadable=!0,c.nextTick(S,_))}function S(_){var s=_._readableState;q("emitReadable_",s.destroyed,s.length,s.ended),!s.destroyed&&(s.length||s.ended)&&(_.emit("readable"),s.emittedReadable=!1),s.needReadable=!s.flowing&&!s.ended&&s.length<=s.highWaterMark,B(_)}function R(_,s){s.readingMore||(s.readingMore=!0,c.nextTick(E,_,s))}function E(_,s){for(;!s.reading&&!s.ended&&(s.length<s.highWaterMark||s.flowing&&s.length===0);){var u=s.length;if(q("maybeReadMore read 0"),_.read(0),u===s.length)break}s.readingMore=!1}function D(_){return function(){var s=_._readableState;q("pipeOnDrain",s.awaitDrain),s.awaitDrain&&s.awaitDrain--,s.awaitDrain===0&&X(_,"data")&&(s.flowing=!0,B(_))}}function U(_){var s=_._readableState;s.readableListening=0<_.listenerCount("readable"),s.resumeScheduled&&!s.paused?s.flowing=!0:0<_.listenerCount("data")&&_.resume()}function C(_){q("readable nexttick read 0"),_.read(0)}function A(_,s){s.resumeScheduled||(s.resumeScheduled=!0,c.nextTick(F,_,s))}function F(_,s){q("resume",s.reading),s.reading||_.read(0),s.resumeScheduled=!1,_.emit("resume"),B(_),s.flowing&&!s.reading&&_.read(0)}function B(_){var s=_._readableState;for(q("flow",s.flowing);s.flowing&&_.read()!==null;);}function G(_,s){if(s.length===0)return null;var u;return s.objectMode?u=s.buffer.shift():!_||_>=s.length?(u=s.decoder?s.buffer.join(""):s.buffer.length===1?s.buffer.first():s.buffer.concat(s.length),s.buffer.clear()):u=s.buffer.consume(_,s.decoder),u}function W(_){var s=_._readableState;q("endReadable",s.endEmitted),s.endEmitted||(s.ended=!0,c.nextTick(Q,s,_))}function Q(_,s){if(q("endReadableNT",_.endEmitted,_.length),!_.endEmitted&&_.length===0&&(_.endEmitted=!0,s.readable=!1,s.emit("end"),_.autoDestroy)){var u=s._writableState;(!u||u.autoDestroy&&u.finished)&&s.destroy()}}function lt(_,s){for(var u=0,f=_.length;u<f;u++)if(_[u]===s)return u;return-1}l.exports=y;var it;y.ReadableState=d;var q;o("events").EventEmitter;var X=function(_,s){return _.listeners(s).length},ct=o("./internal/streams/stream"),P=o("buffer").Buffer,V=a.Uint8Array||function(){},K=o("util");q=K&&K.debuglog?K.debuglog("stream"):function(){};var ft,Et,jt,pe=o("./internal/streams/buffer_list"),Xt=o("./internal/streams/destroy"),Qt=o("./internal/streams/state"),ye=Qt.getHighWaterMark,ce=o("../errors").codes,xt=ce.ERR_INVALID_ARG_TYPE,Ft=ce.ERR_STREAM_PUSH_AFTER_EOF,L=ce.ERR_METHOD_NOT_IMPLEMENTED,M=ce.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;o("inherits")(y,ct);var j=Xt.errorOrDestroy,z=["error","close","destroy","pause","resume"];Object.defineProperty(y.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(_){this._readableState&&(this._readableState.destroyed=_)}}),y.prototype.destroy=Xt.destroy,y.prototype._undestroy=Xt.undestroy,y.prototype._destroy=function(_,s){s(_)},y.prototype.push=function(_,s){var u,f=this._readableState;return f.objectMode?u=!0:typeof _=="string"&&(s=s||f.defaultEncoding,s!==f.encoding&&(_=P.from(_,s),s=""),u=!0),p(this,_,s,!1,u)},y.prototype.unshift=function(_){return p(this,_,null,!0,!1)},y.prototype.isPaused=function(){return this._readableState.flowing===!1},y.prototype.setEncoding=function(_){ft||(ft=o("string_decoder/").StringDecoder);var s=new ft(_);this._readableState.decoder=s,this._readableState.encoding=this._readableState.decoder.encoding;for(var u=this._readableState.buffer.head,f="";u!==null;)f+=s.write(u.data),u=u.next;return this._readableState.buffer.clear(),f!==""&&this._readableState.buffer.push(f),this._readableState.length=f.length,this},y.prototype.read=function(_){q("read",_),_=parseInt(_,10);var s=this._readableState,u=_;if(_!==0&&(s.emittedReadable=!1),_===0&&s.needReadable&&((s.highWaterMark===0?0<s.length:s.length>=s.highWaterMark)||s.ended))return q("read: emitReadable",s.length,s.ended),s.length===0&&s.ended?W(this):v(this),null;if(_=x(_,s),_===0&&s.ended)return s.length===0&&W(this),null;var f=s.needReadable;q("need readable",f),(s.length===0||s.length-_<s.highWaterMark)&&(f=!0,q("length less than watermark",f)),s.ended||s.reading?(f=!1,q("reading or ended",f)):f&&(q("do read"),s.reading=!0,s.sync=!0,s.length===0&&(s.needReadable=!0),this._read(s.highWaterMark),s.sync=!1,!s.reading&&(_=x(u,s)));var k;return k=0<_?G(_,s):null,k===null?(s.needReadable=s.length<=s.highWaterMark,_=0):(s.length-=_,s.awaitDrain=0),s.length===0&&(!s.ended&&(s.needReadable=!0),u!==_&&s.ended&&W(this)),k!==null&&this.emit("data",k),k},y.prototype._read=function(){j(this,new L("_read()"))},y.prototype.pipe=function(_,s){function u(Le,Oe){q("onunpipe"),Le===nt&&Oe&&Oe.hasUnpiped===!1&&(Oe.hasUnpiped=!0,k())}function f(){q("onend"),_.end()}function k(){q("cleanup"),_.removeListener("close",H),_.removeListener("finish",et),_.removeListener("drain",De),_.removeListener("error",N),_.removeListener("unpipe",u),nt.removeListener("end",f),nt.removeListener("end",at),nt.removeListener("data",T),Ze=!0,tt.awaitDrain&&(!_._writableState||_._writableState.needDrain)&&De()}function T(Le){q("ondata");var Oe=_.write(Le);q("dest.write",Oe),Oe===!1&&((tt.pipesCount===1&&tt.pipes===_||1<tt.pipesCount&&lt(tt.pipes,_)!==-1)&&!Ze&&(q("false write response, pause",tt.awaitDrain),tt.awaitDrain++),nt.pause())}function N(Le){q("onerror",Le),at(),_.removeListener("error",N),X(_,"error")===0&&j(_,Le)}function H(){_.removeListener("finish",et),at()}function et(){q("onfinish"),_.removeListener("close",H),at()}function at(){q("unpipe"),nt.unpipe(_)}var nt=this,tt=this._readableState;switch(tt.pipesCount){case 0:tt.pipes=_;break;case 1:tt.pipes=[tt.pipes,_];break;default:tt.pipes.push(_)}tt.pipesCount+=1,q("pipe count=%d opts=%j",tt.pipesCount,s);var _t=(!s||s.end!==!1)&&_!==c.stdout&&_!==c.stderr,me=_t?f:at;tt.endEmitted?c.nextTick(me):nt.once("end",me),_.on("unpipe",u);var De=D(nt);_.on("drain",De);var Ze=!1;return nt.on("data",T),h(_,"error",N),_.once("close",H),_.once("finish",et),_.emit("pipe",nt),tt.flowing||(q("pipe resume"),nt.resume()),_},y.prototype.unpipe=function(_){var s=this._readableState,u={hasUnpiped:!1};if(s.pipesCount===0)return this;if(s.pipesCount===1)return _&&_!==s.pipes?this:(_||(_=s.pipes),s.pipes=null,s.pipesCount=0,s.flowing=!1,_&&_.emit("unpipe",this,u),this);if(!_){var f=s.pipes,k=s.pipesCount;s.pipes=null,s.pipesCount=0,s.flowing=!1;for(var T=0;T<k;T++)f[T].emit("unpipe",this,{hasUnpiped:!1});return this}var N=lt(s.pipes,_);return N===-1?this:(s.pipes.splice(N,1),s.pipesCount-=1,s.pipesCount===1&&(s.pipes=s.pipes[0]),_.emit("unpipe",this,u),this)},y.prototype.on=function(_,s){var u=ct.prototype.on.call(this,_,s),f=this._readableState;return _==="data"?(f.readableListening=0<this.listenerCount("readable"),f.flowing!==!1&&this.resume()):_=="readable"&&!f.endEmitted&&!f.readableListening&&(f.readableListening=f.needReadable=!0,f.flowing=!1,f.emittedReadable=!1,q("on readable",f.length,f.reading),f.length?v(this):!f.reading&&c.nextTick(C,this)),u},y.prototype.addListener=y.prototype.on,y.prototype.removeListener=function(_,s){var u=ct.prototype.removeListener.call(this,_,s);return _==="readable"&&c.nextTick(U,this),u},y.prototype.removeAllListeners=function(_){var s=ct.prototype.removeAllListeners.apply(this,arguments);return(_==="readable"||_===void 0)&&c.nextTick(U,this),s},y.prototype.resume=function(){var _=this._readableState;return _.flowing||(q("resume"),_.flowing=!_.readableListening,A(this,_)),_.paused=!1,this},y.prototype.pause=function(){return q("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(q("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},y.prototype.wrap=function(_){var s=this,u=this._readableState,f=!1;for(var k in _.on("end",function(){if(q("wrapped end"),u.decoder&&!u.ended){var N=u.decoder.end();N&&N.length&&s.push(N)}s.push(null)}),_.on("data",function(N){if(q("wrapped data"),u.decoder&&(N=u.decoder.write(N)),!(u.objectMode&&N==null)&&(u.objectMode||N&&N.length)){var H=s.push(N);H||(f=!0,_.pause())}}),_)this[k]===void 0&&typeof _[k]=="function"&&(this[k]=function(N){return function(){return _[N].apply(_,arguments)}}(k));for(var T=0;T<z.length;T++)_.on(z[T],this.emit.bind(this,z[T]));return this._read=function(N){q("wrapped _read",N),f&&(f=!1,_.resume())},this},typeof Symbol=="function"&&(y.prototype[Symbol.asyncIterator]=function(){return Et===void 0&&(Et=o("./internal/streams/async_iterator")),Et(this)}),Object.defineProperty(y.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(y.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(y.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(_){this._readableState&&(this._readableState.flowing=_)}}),y._fromList=G,Object.defineProperty(y.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(y.from=function(_,s){return jt===void 0&&(jt=o("./internal/streams/from")),jt(y,_,s)})}).call(this)}).call(this,o("_process"),typeof qt>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:qt)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/async_iterator":21,"./internal/streams/buffer_list":22,"./internal/streams/destroy":23,"./internal/streams/from":25,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,events:7,inherits:10,"string_decoder/":31,util:2}],19:[function(o,l){function c(O,x){var b=this._transformState;b.transforming=!1;var v=b.writecb;if(v===null)return this.emit("error",new y);b.writechunk=null,b.writecb=null,x!=null&&this.push(x),v(O);var S=this._readableState;S.reading=!1,(S.needReadable||S.length<S.highWaterMark)&&this._read(S.highWaterMark)}function a(O){return this instanceof a?(I.call(this,O),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,O&&(typeof O.transform=="function"&&(this._transform=O.transform),typeof O.flush=="function"&&(this._flush=O.flush)),void this.on("prefinish",g)):new a(O)}function g(){var O=this;typeof this._flush!="function"||this._readableState.destroyed?m(this,null,null):this._flush(function(x,b){m(O,x,b)})}function m(O,x,b){if(x)return O.emit("error",x);if(b!=null&&O.push(b),O._writableState.length)throw new w;if(O._transformState.transforming)throw new p;return O.push(null)}l.exports=a;var h=o("../errors").codes,d=h.ERR_METHOD_NOT_IMPLEMENTED,y=h.ERR_MULTIPLE_CALLBACK,p=h.ERR_TRANSFORM_ALREADY_TRANSFORMING,w=h.ERR_TRANSFORM_WITH_LENGTH_0,I=o("./_stream_duplex");o("inherits")(a,I),a.prototype.push=function(O,x){return this._transformState.needTransform=!1,I.prototype.push.call(this,O,x)},a.prototype._transform=function(O,x,b){b(new d("_transform()"))},a.prototype._write=function(O,x,b){var v=this._transformState;if(v.writecb=b,v.writechunk=O,v.writeencoding=x,!v.transforming){var S=this._readableState;(v.needTransform||S.needReadable||S.length<S.highWaterMark)&&this._read(S.highWaterMark)}},a.prototype._read=function(){var O=this._transformState;O.writechunk===null||O.transforming?O.needTransform=!0:(O.transforming=!0,this._transform(O.writechunk,O.writeencoding,O.afterTransform))},a.prototype._destroy=function(O,x){I.prototype._destroy.call(this,O,function(b){x(b)})}},{"../errors":15,"./_stream_duplex":16,inherits:10}],20:[function(o,l){(function(c,a){(function(){function g(L){var M=this;this.next=null,this.entry=null,this.finish=function(){W(M,L)}}function m(L){return q.from(L)}function h(L){return q.isBuffer(L)||L instanceof X}function d(){}function y(L,M,j){Q=Q||o("./_stream_duplex"),L=L||{},typeof j!="boolean"&&(j=M instanceof Q),this.objectMode=!!L.objectMode,j&&(this.objectMode=this.objectMode||!!L.writableObjectMode),this.highWaterMark=V(this,L,"writableHighWaterMark",j),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var z=L.decodeStrings===!1;this.decodeStrings=!z,this.defaultEncoding=L.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(_){R(M,_)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=L.emitClose!==!1,this.autoDestroy=!!L.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new g(this)}function p(L){Q=Q||o("./_stream_duplex");var M=this instanceof Q;return M||Ft.call(p,this)?(this._writableState=new y(L,this,M),this.writable=!0,L&&(typeof L.write=="function"&&(this._write=L.write),typeof L.writev=="function"&&(this._writev=L.writev),typeof L.destroy=="function"&&(this._destroy=L.destroy),typeof L.final=="function"&&(this._final=L.final)),void it.call(this)):new p(L)}function w(L,M){var j=new ye;xt(L,j),c.nextTick(M,j)}function I(L,M,j,z){var _;return j===null?_=new Qt:typeof j!="string"&&!M.objectMode&&(_=new ft("chunk",["string","Buffer"],j)),!_||(xt(L,_),c.nextTick(z,_),!1)}function O(L,M,j){return L.objectMode||L.decodeStrings===!1||typeof M!="string"||(M=q.from(M,j)),M}function x(L,M,j,z,_,s){if(!j){var u=O(M,z,_);z!==u&&(j=!0,_="buffer",z=u)}var f=M.objectMode?1:z.length;M.length+=f;var k=M.length<M.highWaterMark;if(k||(M.needDrain=!0),M.writing||M.corked){var T=M.lastBufferedRequest;M.lastBufferedRequest={chunk:z,encoding:_,isBuf:j,callback:s,next:null},T?T.next=M.lastBufferedRequest:M.bufferedRequest=M.lastBufferedRequest,M.bufferedRequestCount+=1}else b(L,M,!1,f,z,_,s);return k}function b(L,M,j,z,_,s,u){M.writelen=z,M.writecb=u,M.writing=!0,M.sync=!0,M.destroyed?M.onwrite(new Xt("write")):j?L._writev(_,M.onwrite):L._write(_,s,M.onwrite),M.sync=!1}function v(L,M,j,z,_){--M.pendingcb,j?(c.nextTick(_,z),c.nextTick(B,L,M),L._writableState.errorEmitted=!0,xt(L,z)):(_(z),L._writableState.errorEmitted=!0,xt(L,z),B(L,M))}function S(L){L.writing=!1,L.writecb=null,L.length-=L.writelen,L.writelen=0}function R(L,M){var j=L._writableState,z=j.sync,_=j.writecb;if(typeof _!="function")throw new jt;if(S(j),M)v(L,j,z,M,_);else{var s=C(j)||L.destroyed;s||j.corked||j.bufferProcessing||!j.bufferedRequest||U(L,j),z?c.nextTick(E,L,j,s,_):E(L,j,s,_)}}function E(L,M,j,z){j||D(L,M),M.pendingcb--,z(),B(L,M)}function D(L,M){M.length===0&&M.needDrain&&(M.needDrain=!1,L.emit("drain"))}function U(L,M){M.bufferProcessing=!0;var j=M.bufferedRequest;if(L._writev&&j&&j.next){var z=M.bufferedRequestCount,_=Array(z),s=M.corkedRequestsFree;s.entry=j;for(var u=0,f=!0;j;)_[u]=j,j.isBuf||(f=!1),j=j.next,u+=1;_.allBuffers=f,b(L,M,!0,M.length,_,"",s.finish),M.pendingcb++,M.lastBufferedRequest=null,s.next?(M.corkedRequestsFree=s.next,s.next=null):M.corkedRequestsFree=new g(M),M.bufferedRequestCount=0}else{for(;j;){var k=j.chunk,T=j.encoding,N=j.callback,H=M.objectMode?1:k.length;if(b(L,M,!1,H,k,T,N),j=j.next,M.bufferedRequestCount--,M.writing)break}j===null&&(M.lastBufferedRequest=null)}M.bufferedRequest=j,M.bufferProcessing=!1}function C(L){return L.ending&&L.length===0&&L.bufferedRequest===null&&!L.finished&&!L.writing}function A(L,M){L._final(function(j){M.pendingcb--,j&&xt(L,j),M.prefinished=!0,L.emit("prefinish"),B(L,M)})}function F(L,M){M.prefinished||M.finalCalled||(typeof L._final!="function"||M.destroyed?(M.prefinished=!0,L.emit("prefinish")):(M.pendingcb++,M.finalCalled=!0,c.nextTick(A,L,M)))}function B(L,M){var j=C(M);if(j&&(F(L,M),M.pendingcb===0&&(M.finished=!0,L.emit("finish"),M.autoDestroy))){var z=L._readableState;(!z||z.autoDestroy&&z.endEmitted)&&L.destroy()}return j}function G(L,M,j){M.ending=!0,B(L,M),j&&(M.finished?c.nextTick(j):L.once("finish",j)),M.ended=!0,L.writable=!1}function W(L,M,j){var z=L.entry;for(L.entry=null;z;){var _=z.callback;M.pendingcb--,_(j),z=z.next}M.corkedRequestsFree.next=L}l.exports=p;var Q;p.WritableState=y;var lt={deprecate:o("util-deprecate")},it=o("./internal/streams/stream"),q=o("buffer").Buffer,X=a.Uint8Array||function(){},ct=o("./internal/streams/destroy"),P=o("./internal/streams/state"),V=P.getHighWaterMark,K=o("../errors").codes,ft=K.ERR_INVALID_ARG_TYPE,Et=K.ERR_METHOD_NOT_IMPLEMENTED,jt=K.ERR_MULTIPLE_CALLBACK,pe=K.ERR_STREAM_CANNOT_PIPE,Xt=K.ERR_STREAM_DESTROYED,Qt=K.ERR_STREAM_NULL_VALUES,ye=K.ERR_STREAM_WRITE_AFTER_END,ce=K.ERR_UNKNOWN_ENCODING,xt=ct.errorOrDestroy;o("inherits")(p,it),y.prototype.getBuffer=function(){for(var L=this.bufferedRequest,M=[];L;)M.push(L),L=L.next;return M},function(){try{Object.defineProperty(y.prototype,"buffer",{get:lt.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var Ft;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(Ft=Function.prototype[Symbol.hasInstance],Object.defineProperty(p,Symbol.hasInstance,{value:function(L){return!!Ft.call(this,L)||this===p&&L&&L._writableState instanceof y}})):Ft=function(L){return L instanceof this},p.prototype.pipe=function(){xt(this,new pe)},p.prototype.write=function(L,M,j){var z=this._writableState,_=!1,s=!z.objectMode&&h(L);return s&&!q.isBuffer(L)&&(L=m(L)),typeof M=="function"&&(j=M,M=null),s?M="buffer":!M&&(M=z.defaultEncoding),typeof j!="function"&&(j=d),z.ending?w(this,j):(s||I(this,z,L,j))&&(z.pendingcb++,_=x(this,z,s,L,M,j)),_},p.prototype.cork=function(){this._writableState.corked++},p.prototype.uncork=function(){var L=this._writableState;L.corked&&(L.corked--,!L.writing&&!L.corked&&!L.bufferProcessing&&L.bufferedRequest&&U(this,L))},p.prototype.setDefaultEncoding=function(L){if(typeof L=="string"&&(L=L.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((L+"").toLowerCase())))throw new ce(L);return this._writableState.defaultEncoding=L,this},Object.defineProperty(p.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(p.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),p.prototype._write=function(L,M,j){j(new Et("_write()"))},p.prototype._writev=null,p.prototype.end=function(L,M,j){var z=this._writableState;return typeof L=="function"?(j=L,L=null,M=null):typeof M=="function"&&(j=M,M=null),L!=null&&this.write(L,M),z.corked&&(z.corked=1,this.uncork()),z.ending||G(this,z,j),this},Object.defineProperty(p.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(p.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(L){this._writableState&&(this._writableState.destroyed=L)}}),p.prototype.destroy=ct.destroy,p.prototype._undestroy=ct.undestroy,p.prototype._destroy=function(L,M){M(L)}}).call(this)}).call(this,o("_process"),typeof qt>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:qt)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/destroy":23,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,inherits:10,"util-deprecate":32}],21:[function(o,l){(function(c){(function(){function a(D,U,C){return U in D?Object.defineProperty(D,U,{value:C,enumerable:!0,configurable:!0,writable:!0}):D[U]=C,D}function g(D,U){return{value:D,done:U}}function m(D){var U=D[w];if(U!==null){var C=D[S].read();C!==null&&(D[b]=null,D[w]=null,D[I]=null,U(g(C,!1)))}}function h(D){c.nextTick(m,D)}function d(D,U){return function(C,A){D.then(function(){return U[x]?void C(g(void 0,!0)):void U[v](C,A)},A)}}var y,p=o("./end-of-stream"),w=Symbol("lastResolve"),I=Symbol("lastReject"),O=Symbol("error"),x=Symbol("ended"),b=Symbol("lastPromise"),v=Symbol("handlePromise"),S=Symbol("stream"),R=Object.getPrototypeOf(function(){}),E=Object.setPrototypeOf((y={get stream(){return this[S]},next:function(){var D=this,U=this[O];if(U!==null)return Promise.reject(U);if(this[x])return Promise.resolve(g(void 0,!0));if(this[S].destroyed)return new Promise(function(B,G){c.nextTick(function(){D[O]?G(D[O]):B(g(void 0,!0))})});var C,A=this[b];if(A)C=new Promise(d(A,this));else{var F=this[S].read();if(F!==null)return Promise.resolve(g(F,!1));C=new Promise(this[v])}return this[b]=C,C}},a(y,Symbol.asyncIterator,function(){return this}),a(y,"return",function(){var D=this;return new Promise(function(U,C){D[S].destroy(null,function(A){return A?void C(A):void U(g(void 0,!0))})})}),y),R);l.exports=function(D){var U,C=Object.create(E,(U={},a(U,S,{value:D,writable:!0}),a(U,w,{value:null,writable:!0}),a(U,I,{value:null,writable:!0}),a(U,O,{value:null,writable:!0}),a(U,x,{value:D._readableState.endEmitted,writable:!0}),a(U,v,{value:function(A,F){var B=C[S].read();B?(C[b]=null,C[w]=null,C[I]=null,A(g(B,!1))):(C[w]=A,C[I]=F)},writable:!0}),U));return C[b]=null,p(D,function(A){if(A&&A.code!=="ERR_STREAM_PREMATURE_CLOSE"){var F=C[I];return F!==null&&(C[b]=null,C[w]=null,C[I]=null,F(A)),void(C[O]=A)}var B=C[w];B!==null&&(C[b]=null,C[w]=null,C[I]=null,B(g(void 0,!0))),C[x]=!0}),D.on("readable",h.bind(null,C)),C}}).call(this)}).call(this,o("_process"))},{"./end-of-stream":24,_process:12}],22:[function(o,l){function c(b,v){var S=Object.keys(b);if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(b);v&&(R=R.filter(function(E){return Object.getOwnPropertyDescriptor(b,E).enumerable})),S.push.apply(S,R)}return S}function a(b){for(var v,S=1;S<arguments.length;S++)v=arguments[S]==null?{}:arguments[S],S%2?c(Object(v),!0).forEach(function(R){g(b,R,v[R])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(v)):c(Object(v)).forEach(function(R){Object.defineProperty(b,R,Object.getOwnPropertyDescriptor(v,R))});return b}function g(b,v,S){return v in b?Object.defineProperty(b,v,{value:S,enumerable:!0,configurable:!0,writable:!0}):b[v]=S,b}function m(b,v){if(!(b instanceof v))throw new TypeError("Cannot call a class as a function")}function h(b,v){for(var S,R=0;R<v.length;R++)S=v[R],S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(b,S.key,S)}function d(b,v,S){return v&&h(b.prototype,v),S&&h(b,S),b}function y(b,v,S){w.prototype.copy.call(b,v,S)}var p=o("buffer"),w=p.Buffer,I=o("util"),O=I.inspect,x=O&&O.custom||"inspect";l.exports=function(){function b(){m(this,b),this.head=null,this.tail=null,this.length=0}return d(b,[{key:"push",value:function(v){var S={data:v,next:null};0<this.length?this.tail.next=S:this.head=S,this.tail=S,++this.length}},{key:"unshift",value:function(v){var S={data:v,next:this.head};this.length===0&&(this.tail=S),this.head=S,++this.length}},{key:"shift",value:function(){if(this.length!==0){var v=this.head.data;return this.head=this.length===1?this.tail=null:this.head.next,--this.length,v}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(v){if(this.length===0)return"";for(var S=this.head,R=""+S.data;S=S.next;)R+=v+S.data;return R}},{key:"concat",value:function(v){if(this.length===0)return w.alloc(0);for(var S=w.allocUnsafe(v>>>0),R=this.head,E=0;R;)y(R.data,S,E),E+=R.data.length,R=R.next;return S}},{key:"consume",value:function(v,S){var R;return v<this.head.data.length?(R=this.head.data.slice(0,v),this.head.data=this.head.data.slice(v)):v===this.head.data.length?R=this.shift():R=S?this._getString(v):this._getBuffer(v),R}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(v){var S=this.head,R=1,E=S.data;for(v-=E.length;S=S.next;){var D=S.data,U=v>D.length?D.length:v;if(E+=U===D.length?D:D.slice(0,v),v-=U,v===0){U===D.length?(++R,this.head=S.next?S.next:this.tail=null):(this.head=S,S.data=D.slice(U));break}++R}return this.length-=R,E}},{key:"_getBuffer",value:function(v){var S=w.allocUnsafe(v),R=this.head,E=1;for(R.data.copy(S),v-=R.data.length;R=R.next;){var D=R.data,U=v>D.length?D.length:v;if(D.copy(S,S.length-v,0,U),v-=U,v===0){U===D.length?(++E,this.head=R.next?R.next:this.tail=null):(this.head=R,R.data=D.slice(U));break}++E}return this.length-=E,S}},{key:x,value:function(v,S){return O(this,a({},S,{depth:0,customInspect:!1}))}}]),b}()},{buffer:3,util:2}],23:[function(o,l){(function(c){(function(){function a(h,d){m(h,d),g(h)}function g(h){h._writableState&&!h._writableState.emitClose||h._readableState&&!h._readableState.emitClose||h.emit("close")}function m(h,d){h.emit("error",d)}l.exports={destroy:function(h,d){var y=this,p=this._readableState&&this._readableState.destroyed,w=this._writableState&&this._writableState.destroyed;return p||w?(d?d(h):h&&(this._writableState?!this._writableState.errorEmitted&&(this._writableState.errorEmitted=!0,c.nextTick(m,this,h)):c.nextTick(m,this,h)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(h||null,function(I){!d&&I?y._writableState?y._writableState.errorEmitted?c.nextTick(g,y):(y._writableState.errorEmitted=!0,c.nextTick(a,y,I)):c.nextTick(a,y,I):d?(c.nextTick(g,y),d(I)):c.nextTick(g,y)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(h,d){var y=h._readableState,p=h._writableState;y&&y.autoDestroy||p&&p.autoDestroy?h.destroy(d):h.emit("error",d)}}}).call(this)}).call(this,o("_process"))},{_process:12}],24:[function(o,l){function c(d){var y=!1;return function(){if(!y){y=!0;for(var p=arguments.length,w=Array(p),I=0;I<p;I++)w[I]=arguments[I];d.apply(this,w)}}}function a(){}function g(d){return d.setHeader&&typeof d.abort=="function"}function m(d,y,p){if(typeof y=="function")return m(d,null,y);y||(y={}),p=c(p||a);var w=y.readable||y.readable!==!1&&d.readable,I=y.writable||y.writable!==!1&&d.writable,O=function(){d.writable||b()},x=d._writableState&&d._writableState.finished,b=function(){I=!1,x=!0,w||p.call(d)},v=d._readableState&&d._readableState.endEmitted,S=function(){w=!1,v=!0,I||p.call(d)},R=function(U){p.call(d,U)},E=function(){var U;return w&&!v?(d._readableState&&d._readableState.ended||(U=new h),p.call(d,U)):I&&!x?(d._writableState&&d._writableState.ended||(U=new h),p.call(d,U)):void 0},D=function(){d.req.on("finish",b)};return g(d)?(d.on("complete",b),d.on("abort",E),d.req?D():d.on("request",D)):I&&!d._writableState&&(d.on("end",O),d.on("close",O)),d.on("end",S),d.on("finish",b),y.error!==!1&&d.on("error",R),d.on("close",E),function(){d.removeListener("complete",b),d.removeListener("abort",E),d.removeListener("request",D),d.req&&d.req.removeListener("finish",b),d.removeListener("end",O),d.removeListener("close",O),d.removeListener("finish",b),d.removeListener("end",S),d.removeListener("error",R),d.removeListener("close",E)}}var h=o("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;l.exports=m},{"../../../errors":15}],25:[function(o,l){l.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],26:[function(o,l){function c(x){var b=!1;return function(){b||(b=!0,x.apply(void 0,arguments))}}function a(x){if(x)throw x}function g(x){return x.setHeader&&typeof x.abort=="function"}function m(x,b,v,S){S=c(S);var R=!1;x.on("close",function(){R=!0}),p===void 0&&(p=o("./end-of-stream")),p(x,{readable:b,writable:v},function(D){return D?S(D):(R=!0,void S())});var E=!1;return function(D){if(!R)return E?void 0:(E=!0,g(x)?x.abort():typeof x.destroy=="function"?x.destroy():void S(D||new O("pipe")))}}function h(x){x()}function d(x,b){return x.pipe(b)}function y(x){return x.length&&typeof x[x.length-1]=="function"?x.pop():a}var p,w=o("../../../errors").codes,I=w.ERR_MISSING_ARGS,O=w.ERR_STREAM_DESTROYED;l.exports=function(){for(var x=arguments.length,b=Array(x),v=0;v<x;v++)b[v]=arguments[v];var S=y(b);if(Array.isArray(b[0])&&(b=b[0]),2>b.length)throw new I("streams");var R,E=b.map(function(D,U){var C=U<b.length-1;return m(D,C,0<U,function(A){R||(R=A),A&&E.forEach(h),C||(E.forEach(h),S(R))})});return b.reduce(d)}},{"../../../errors":15,"./end-of-stream":24}],27:[function(o,l){function c(g,m,h){return g.highWaterMark==null?m?g[h]:null:g.highWaterMark}var a=o("../../../errors").codes.ERR_INVALID_OPT_VALUE;l.exports={getHighWaterMark:function(g,m,h,d){var y=c(m,d,h);if(y!=null){if(!(isFinite(y)&&n(y)===y)||0>y){var p=d?h:"highWaterMark";throw new a(p,y)}return n(y)}return g.objectMode?16:16384}}},{"../../../errors":15}],28:[function(o,l){l.exports=o("events").EventEmitter},{events:7}],29:[function(o,l,c){c=l.exports=o("./lib/_stream_readable.js"),c.Stream=c,c.Readable=c,c.Writable=o("./lib/_stream_writable.js"),c.Duplex=o("./lib/_stream_duplex.js"),c.Transform=o("./lib/_stream_transform.js"),c.PassThrough=o("./lib/_stream_passthrough.js"),c.finished=o("./lib/internal/streams/end-of-stream.js"),c.pipeline=o("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":16,"./lib/_stream_passthrough.js":17,"./lib/_stream_readable.js":18,"./lib/_stream_transform.js":19,"./lib/_stream_writable.js":20,"./lib/internal/streams/end-of-stream.js":24,"./lib/internal/streams/pipeline.js":26}],30:[function(o,l,c){function a(d,y){for(var p in d)y[p]=d[p]}function g(d,y,p){return h(d,y,p)}/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var m=o("buffer"),h=m.Buffer;h.from&&h.alloc&&h.allocUnsafe&&h.allocUnsafeSlow?l.exports=m:(a(m,c),c.Buffer=g),g.prototype=Object.create(h.prototype),a(h,g),g.from=function(d,y,p){if(typeof d=="number")throw new TypeError("Argument must not be a number");return h(d,y,p)},g.alloc=function(d,y,p){if(typeof d!="number")throw new TypeError("Argument must be a number");var w=h(d);return y===void 0?w.fill(0):typeof p=="string"?w.fill(y,p):w.fill(y),w},g.allocUnsafe=function(d){if(typeof d!="number")throw new TypeError("Argument must be a number");return h(d)},g.allocUnsafeSlow=function(d){if(typeof d!="number")throw new TypeError("Argument must be a number");return m.SlowBuffer(d)}},{buffer:3}],31:[function(o,l,c){function a(E){if(!E)return"utf8";for(var D;;)switch(E){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return E;default:if(D)return;E=(""+E).toLowerCase(),D=!0}}function g(E){var D=a(E);if(typeof D!="string"&&(S.isEncoding===R||!R(E)))throw new Error("Unknown encoding: "+E);return D||E}function m(E){this.encoding=g(E);var D;switch(this.encoding){case"utf16le":this.text=w,this.end=I,D=4;break;case"utf8":this.fillLast=p,D=4;break;case"base64":this.text=O,this.end=x,D=3;break;default:return this.write=b,void(this.end=v)}this.lastNeed=0,this.lastTotal=0,this.lastChar=S.allocUnsafe(D)}function h(E){return 127>=E?0:E>>5==6?2:E>>4==14?3:E>>3==30?4:E>>6==2?-1:-2}function d(E,D,U){var C=D.length-1;if(C<U)return 0;var A=h(D[C]);return 0<=A?(0<A&&(E.lastNeed=A-1),A):--C<U||A===-2?0:(A=h(D[C]),0<=A?(0<A&&(E.lastNeed=A-2),A):--C<U||A===-2?0:(A=h(D[C]),0<=A?(0<A&&(A===2?A=0:E.lastNeed=A-3),A):0))}function y(E,D){if((192&D[0])!=128)return E.lastNeed=0,"";if(1<E.lastNeed&&1<D.length){if((192&D[1])!=128)return E.lastNeed=1,"";if(2<E.lastNeed&&2<D.length&&(192&D[2])!=128)return E.lastNeed=2,""}}function p(E){var D=this.lastTotal-this.lastNeed,U=y(this,E);return U===void 0?this.lastNeed<=E.length?(E.copy(this.lastChar,D,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(E.copy(this.lastChar,D,0,E.length),void(this.lastNeed-=E.length)):U}function w(E,D){if((E.length-D)%2==0){var U=E.toString("utf16le",D);if(U){var C=U.charCodeAt(U.length-1);if(55296<=C&&56319>=C)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=E[E.length-2],this.lastChar[1]=E[E.length-1],U.slice(0,-1)}return U}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=E[E.length-1],E.toString("utf16le",D,E.length-1)}function I(E){var D=E&&E.length?this.write(E):"";if(this.lastNeed){var U=this.lastTotal-this.lastNeed;return D+this.lastChar.toString("utf16le",0,U)}return D}function O(E,D){var U=(E.length-D)%3;return U==0?E.toString("base64",D):(this.lastNeed=3-U,this.lastTotal=3,U==1?this.lastChar[0]=E[E.length-1]:(this.lastChar[0]=E[E.length-2],this.lastChar[1]=E[E.length-1]),E.toString("base64",D,E.length-U))}function x(E){var D=E&&E.length?this.write(E):"";return this.lastNeed?D+this.lastChar.toString("base64",0,3-this.lastNeed):D}function b(E){return E.toString(this.encoding)}function v(E){return E&&E.length?this.write(E):""}var S=o("safe-buffer").Buffer,R=S.isEncoding||function(E){switch(E=""+E,E&&E.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};c.StringDecoder=m,m.prototype.write=function(E){if(E.length===0)return"";var D,U;if(this.lastNeed){if(D=this.fillLast(E),D===void 0)return"";U=this.lastNeed,this.lastNeed=0}else U=0;return U<E.length?D?D+this.text(E,U):this.text(E,U):D||""},m.prototype.end=function(E){var D=E&&E.length?this.write(E):"";return this.lastNeed?D+"":D},m.prototype.text=function(E,D){var U=d(this,E,D);if(!this.lastNeed)return E.toString("utf8",D);this.lastTotal=U;var C=E.length-(U-this.lastNeed);return E.copy(this.lastChar,0,C),E.toString("utf8",D,C)},m.prototype.fillLast=function(E){return this.lastNeed<=E.length?(E.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(E.copy(this.lastChar,this.lastTotal-this.lastNeed,0,E.length),void(this.lastNeed-=E.length))}},{"safe-buffer":30}],32:[function(o,l){(function(c){(function(){function a(g){try{if(!c.localStorage)return!1}catch{return!1}var m=c.localStorage[g];return m!=null&&(m+"").toLowerCase()==="true"}l.exports=function(g,m){function h(){if(!d){if(a("throwDeprecation"))throw new Error(m);a("traceDeprecation")?console.trace(m):console.warn(m),d=!0}return g.apply(this,arguments)}if(a("noDeprecation"))return g;var d=!1;return h}}).call(this)}).call(this,typeof qt>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:qt)},{}],"/":[function(o,l){function c(x){return x.replace(/a=ice-options:trickle\s\n/g,"")}function a(x){console.warn(x)}/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */const g=o("debug")("simple-peer"),m=o("get-browser-rtc"),h=o("randombytes"),d=o("readable-stream"),y=o("queue-microtask"),p=o("err-code"),{Buffer:w}=o("buffer"),I=65536;class O extends d.Duplex{constructor(b){if(b=Object.assign({allowHalfOpen:!1},b),super(b),this._id=h(4).toString("hex").slice(0,7),this._debug("new peer %o",b),this.channelName=b.initiator?b.channelName||h(20).toString("hex"):null,this.initiator=b.initiator||!1,this.channelConfig=b.channelConfig||O.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},O.config,b.config),this.offerOptions=b.offerOptions||{},this.answerOptions=b.answerOptions||{},this.sdpTransform=b.sdpTransform||(v=>v),this.streams=b.streams||(b.stream?[b.stream]:[]),this.trickle=b.trickle===void 0||b.trickle,this.allowHalfTrickle=b.allowHalfTrickle!==void 0&&b.allowHalfTrickle,this.iceCompleteTimeout=b.iceCompleteTimeout||5e3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=b.wrtc&&typeof b.wrtc=="object"?b.wrtc:m(),!this._wrtc)throw p(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(v){return void this.destroy(p(v,"ERR_PC_CONSTRUCTOR"))}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=v=>{this._onIceCandidate(v)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(v=>{this.destroy(p(v,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=v=>{this._setupData(v)},this.streams&&this.streams.forEach(v=>{this.addStream(v)}),this._pc.ontrack=v=>{this._onTrack(v)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(b){if(!this.destroying){if(this.destroyed)throw p(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof b=="string")try{b=JSON.parse(b)}catch{b={}}this._debug("signal()"),b.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),b.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(b.transceiverRequest.kind,b.transceiverRequest.init)),b.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(b.candidate):this._pendingCandidates.push(b.candidate)),b.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(b)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(v=>{this._addIceCandidate(v)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(v=>{this.destroy(p(v,"ERR_SET_REMOTE_DESCRIPTION"))}),b.sdp||b.candidate||b.renegotiate||b.transceiverRequest||this.destroy(p(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(b){const v=new this._wrtc.RTCIceCandidate(b);this._pc.addIceCandidate(v).catch(S=>{!v.address||v.address.endsWith(".local")?a("Ignoring unsupported ICE candidate."):this.destroy(p(S,"ERR_ADD_ICE_CANDIDATE"))})}send(b){if(!this.destroying){if(this.destroyed)throw p(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(b)}}addTransceiver(b,v){if(!this.destroying){if(this.destroyed)throw p(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(b,v),this._needsNegotiation()}catch(S){this.destroy(p(S,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:b,init:v}})}}addStream(b){if(!this.destroying){if(this.destroyed)throw p(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),b.getTracks().forEach(v=>{this.addTrack(v,b)})}}addTrack(b,v){if(this.destroying)return;if(this.destroyed)throw p(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const S=this._senderMap.get(b)||new Map;let R=S.get(v);if(!R)R=this._pc.addTrack(b,v),S.set(v,R),this._senderMap.set(b,S),this._needsNegotiation();else throw R.removed?p(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):p(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(b,v,S){if(this.destroying)return;if(this.destroyed)throw p(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const R=this._senderMap.get(b),E=R?R.get(S):null;if(!E)throw p(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");v&&this._senderMap.set(v,R),E.replaceTrack==null?this.destroy(p(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK")):E.replaceTrack(v)}removeTrack(b,v){if(this.destroying)return;if(this.destroyed)throw p(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const S=this._senderMap.get(b),R=S?S.get(v):null;if(!R)throw p(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{R.removed=!0,this._pc.removeTrack(R)}catch(E){E.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(R):this.destroy(p(E,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(b){if(!this.destroying){if(this.destroyed)throw p(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),b.getTracks().forEach(v=>{this.removeTrack(v,b)})}}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,y(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw p(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(b){this._destroy(b,()=>{})}_destroy(b,v){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",b&&(b.message||b)),y(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",b&&(b.message||b)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,b&&this.emit("error",b),this.emit("close"),v()}))}_setupData(b){if(!b.channel)return this.destroy(p(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=b.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=I),this.channelName=this._channel.label,this._channel.onmessage=S=>{this._onChannelMessage(S)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=S=>{const R=S.error instanceof Error?S.error:new Error(`Datachannel error: ${S.message} ${S.filename}:${S.lineno}:${S.colno}`);this.destroy(p(R,"ERR_DATA_CHANNEL"))};let v=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(v&&this._onChannelClose(),v=!0):v=!1},5e3)}_read(){}_write(b,v,S){if(this.destroyed)return S(p(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(b)}catch(R){return this.destroy(p(R,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>I?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=S):S(null)}else this._debug("write before connect"),this._chunk=b,this._cb=S}_onFinish(){if(!this.destroyed){const b=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?b():this.once("connect",b)}}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(b=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(b.sdp=c(b.sdp)),b.sdp=this.sdpTransform(b.sdp);const v=()=>{if(!this.destroyed){const S=this._pc.localDescription||b;this._debug("signal"),this.emit("signal",{type:S.type,sdp:S.sdp})}};this._pc.setLocalDescription(b).then(()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?v():this.once("_iceComplete",v))}).catch(S=>{this.destroy(p(S,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(b=>{this.destroy(p(b,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(b=>{b.mid||!b.sender.track||b.requested||(b.requested=!0,this.addTransceiver(b.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(b=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(b.sdp=c(b.sdp)),b.sdp=this.sdpTransform(b.sdp);const v=()=>{if(!this.destroyed){const S=this._pc.localDescription||b;this._debug("signal"),this.emit("signal",{type:S.type,sdp:S.sdp}),this.initiator||this._requestMissingTransceivers()}};this._pc.setLocalDescription(b).then(()=>{this.destroyed||(this.trickle||this._iceComplete?v():this.once("_iceComplete",v))}).catch(S=>{this.destroy(p(S,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(b=>{this.destroy(p(b,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(p(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const b=this._pc.iceConnectionState,v=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",b,v),this.emit("iceStateChange",b,v),(b==="connected"||b==="completed")&&(this._pcReady=!0,this._maybeReady()),b==="failed"&&this.destroy(p(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),b==="closed"&&this.destroy(p(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(b){const v=S=>(Object.prototype.toString.call(S.values)==="[object Array]"&&S.values.forEach(R=>{Object.assign(S,R)}),S);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(S=>{const R=[];S.forEach(E=>{R.push(v(E))}),b(null,R)},S=>b(S)):0<this._pc.getStats.length?this._pc.getStats(S=>{if(this.destroyed)return;const R=[];S.result().forEach(E=>{const D={};E.names().forEach(U=>{D[U]=E.stat(U)}),D.id=E.id,D.type=E.type,D.timestamp=E.timestamp,R.push(v(D))}),b(null,R)},S=>b(S)):b(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const b=()=>{this.destroyed||this.getStats((v,S)=>{if(this.destroyed)return;v&&(S=[]);const R={},E={},D={};let U=!1;S.forEach(A=>{(A.type==="remotecandidate"||A.type==="remote-candidate")&&(R[A.id]=A),(A.type==="localcandidate"||A.type==="local-candidate")&&(E[A.id]=A),(A.type==="candidatepair"||A.type==="candidate-pair")&&(D[A.id]=A)});const C=A=>{U=!0;let F=E[A.localCandidateId];F&&(F.ip||F.address)?(this.localAddress=F.ip||F.address,this.localPort=+F.port):F&&F.ipAddress?(this.localAddress=F.ipAddress,this.localPort=+F.portNumber):typeof A.googLocalAddress=="string"&&(F=A.googLocalAddress.split(":"),this.localAddress=F[0],this.localPort=+F[1]),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let B=R[A.remoteCandidateId];B&&(B.ip||B.address)?(this.remoteAddress=B.ip||B.address,this.remotePort=+B.port):B&&B.ipAddress?(this.remoteAddress=B.ipAddress,this.remotePort=+B.portNumber):typeof A.googRemoteAddress=="string"&&(B=A.googRemoteAddress.split(":"),this.remoteAddress=B[0],this.remotePort=+B[1]),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(S.forEach(A=>{A.type==="transport"&&A.selectedCandidatePairId&&C(D[A.selectedCandidatePairId]),(A.type==="googCandidatePair"&&A.googActiveConnection==="true"||(A.type==="candidatepair"||A.type==="candidate-pair")&&A.selected)&&C(A)}),!U&&(!Object.keys(D).length||Object.keys(E).length))return void setTimeout(b,100);if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(F){return this.destroy(p(F,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const A=this._cb;this._cb=null,A(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};b()}_onInterval(){this._cb&&this._channel&&!(this._channel.bufferedAmount>I)&&this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(b=>{this._pc.removeTrack(b),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(b){this.destroyed||(b.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:b.candidate.candidate,sdpMLineIndex:b.candidate.sdpMLineIndex,sdpMid:b.candidate.sdpMid}}):!b.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),b.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(b){if(this.destroyed)return;let v=b.data;v instanceof ArrayBuffer&&(v=w.from(v)),this.push(v)}_onChannelBufferedAmountLow(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const b=this._cb;this._cb=null,b(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(b){this.destroyed||b.streams.forEach(v=>{this._debug("on track"),this.emit("track",b.track,v),this._remoteTracks.push({track:b.track,stream:v}),this._remoteStreams.some(S=>S.id===v.id)||(this._remoteStreams.push(v),y(()=>{this._debug("on stream"),this.emit("stream",v)}))})}_debug(){const b=[].slice.call(arguments);b[0]="["+this._id+"] "+b[0],g.apply(null,b)}}O.WEBRTC_SUPPORT=!!m(),O.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},O.channelConfig={},l.exports=O},{buffer:3,debug:4,"err-code":6,"get-browser-rtc":8,"queue-microtask":13,randombytes:14,"readable-stream":29}]},{},[])("/")})})(go);var Ya=go.exports;const Ga=Aa(Ya),fs=0,ds=1,po=2,yo=(e,t)=>{Y(e,fs);const n=Rc(t);ht(e,n)},mo=(e,t,n)=>{Y(e,ds),ht(e,rs(t,n))},Ja=(e,t,n)=>mo(t,n,yt(e)),bo=(e,t,n)=>{try{xi(t,yt(e),n)}catch(r){console.error("Caught error while handling a Yjs update",r)}},Ka=(e,t)=>{Y(e,po),ht(e,t)},$a=bo,Xa=(e,t,n,r)=>{const i=$(e);switch(i){case fs:Ja(e,t,n);break;case ds:bo(e,n,r);break;case po:$a(e,n,r);break;default:throw new Error("Unknown message type")}return i},pr=3e4;class Qa extends Vr{constructor(t){super(),this.doc=t,this.clientID=t.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{const n=ie();this.getLocalState()!==null&&pr/2<=n-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const r=[];this.meta.forEach((i,o)=>{o!==this.clientID&&pr<=n-i.lastUpdated&&this.states.has(o)&&r.push(o)}),r.length>0&&Lr(this,r,"timeout")},zt(pr/10)),t.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(t){const n=this.clientID,r=this.meta.get(n),i=r===void 0?0:r.clock+1,o=this.states.get(n);t===null?this.states.delete(n):this.states.set(n,t),this.meta.set(n,{clock:i,lastUpdated:ie()});const l=[],c=[],a=[],g=[];t===null?g.push(n):o==null?t!=null&&l.push(n):(c.push(n),on(o,t)||a.push(n)),(l.length>0||a.length>0||g.length>0)&&this.emit("change",[{added:l,updated:a,removed:g},"local"]),this.emit("update",[{added:l,updated:c,removed:g},"local"])}setLocalStateField(t,n){const r=this.getLocalState();r!==null&&this.setLocalState({...r,[t]:n})}getStates(){return this.states}}const Lr=(e,t,n)=>{const r=[];for(let i=0;i<t.length;i++){const o=t[i];if(e.states.has(o)){if(e.states.delete(o),o===e.clientID){const l=e.meta.get(o);e.meta.set(o,{clock:l.clock+1,lastUpdated:ie()})}r.push(o)}}r.length>0&&(e.emit("change",[{added:[],updated:[],removed:r},n]),e.emit("update",[{added:[],updated:[],removed:r},n]))},qn=(e,t,n=e.states)=>{const r=t.length,i=mt();Y(i,r);for(let o=0;o<r;o++){const l=t[o],c=n.get(l)||null,a=e.meta.get(l).clock;Y(i,l),Y(i,a),Ht(i,JSON.stringify(c))}return ut(i)},Za=(e,t,n)=>{const r=$t(t),i=ie(),o=[],l=[],c=[],a=[],g=$(r);for(let m=0;m<g;m++){const h=$(r);let d=$(r);const y=JSON.parse(ne(r)),p=e.meta.get(h),w=e.states.get(h),I=p===void 0?0:p.clock;(I<d||I===d&&y===null&&e.states.has(h))&&(y===null?h===e.clientID&&e.getLocalState()!=null?d++:e.states.delete(h):e.states.set(h,y),e.meta.set(h,{clock:d,lastUpdated:i}),p===void 0&&y!==null?o.push(h):p!==void 0&&y===null?a.push(h):y!==null&&(on(y,w)||c.push(h),l.push(h)))}(o.length>0||c.length>0||a.length>0)&&e.emit("change",[{added:o,updated:c,removed:a},n]),(o.length>0||l.length>0||a.length>0)&&e.emit("update",[{added:o,updated:l,removed:a},n])},tu=(e,t)=>{const n=Er(e).buffer,r=Er(t).buffer;return crypto.subtle.importKey("raw",n,"PBKDF2",!1,["deriveKey"]).then(i=>crypto.subtle.deriveKey({name:"PBKDF2",salt:r,iterations:1e5,hash:"SHA-256"},i,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]))},_o=(e,t)=>{if(!t)return Jr(e);const n=crypto.getRandomValues(new Uint8Array(12));return crypto.subtle.encrypt({name:"AES-GCM",iv:n},t,e).then(r=>{const i=mt();return Ht(i,"AES-GCM"),ht(i,n),ht(i,new Uint8Array(r)),ut(i)})},eu=(e,t)=>{const n=mt();return Ve(n,e),_o(ut(n),t)},wo=(e,t)=>{if(!t)return Jr(e);const n=$t(e);ne(n)!=="AES-GCM"&&Ll(Bt("Unknown encryption algorithm"));const i=yt(n),o=yt(n);return crypto.subtle.decrypt({name:"AES-GCM",iv:i},t,o).then(l=>new Uint8Array(l))},nu=(e,t)=>wo(e,t).then(n=>He($t(new Uint8Array(n)))),Rt=ac("y-webrtc"),Pe=0,vo=3,gn=1,gs=4,Vn=new Map,we=new Map,So=e=>{let t=!0;e.webrtcConns.forEach(n=>{n.synced||(t=!1)}),(!t&&e.synced||t&&!e.synced)&&(e.synced=t,e.provider.emit("synced",[{synced:t}]),Rt("synced ",Nt,e.name,Se," with all peers"))},Eo=(e,t,n)=>{const r=$t(t),i=mt(),o=$(r);if(e===void 0)return null;const l=e.awareness,c=e.doc;let a=!1;switch(o){case Pe:{Y(i,Pe);const g=Xa(r,i,c,e);g===ds&&!e.synced&&n(),g===fs&&(a=!0);break}case vo:Y(i,gn),ht(i,qn(l,Array.from(l.getStates().keys()))),a=!0;break;case gn:Za(l,yt(r),e);break;case gs:{const g=ve(r)===1,m=ne(r);if(m!==e.peerId&&(e.bcConns.has(m)&&!g||!e.bcConns.has(m)&&g)){const h=[],d=[];g?(e.bcConns.add(m),d.push(m)):(e.bcConns.delete(m),h.push(m)),e.provider.emit("peers",[{added:d,removed:h,webrtcPeers:Array.from(e.webrtcConns.keys()),bcPeers:Array.from(e.bcConns)}]),ko(e)}break}default:return console.error("Unable to compute message"),i}return a?i:null},ru=(e,t)=>{const n=e.room;return Rt("received message from ",Nt,e.remotePeerId,Xr," (",n.name,")",Se,Jn),Eo(n,t,()=>{e.synced=!0,Rt("synced ",Nt,n.name,Se," with ",Nt,e.remotePeerId),So(n)})},yr=(e,t)=>{Rt("send message to ",Nt,e.remotePeerId,Se,Xr," (",e.room.name,")",Jn);try{e.peer.send(ut(t))}catch{}},su=(e,t)=>{Rt("broadcast message in ",Nt,e.name,Se),e.webrtcConns.forEach(n=>{try{n.peer.send(t)}catch{}})};class Hs{constructor(t,n,r,i){Rt("establishing connection to ",Nt,r),this.room=i,this.remotePeerId=r,this.glareToken=void 0,this.closed=!1,this.connected=!1,this.synced=!1,this.peer=new Ga({initiator:n,...i.provider.peerOpts}),this.peer.on("signal",o=>{this.glareToken===void 0&&(this.glareToken=Date.now()+Math.random()),ps(t,i,{to:r,from:i.peerId,type:"signal",token:this.glareToken,signal:o})}),this.peer.on("connect",()=>{Rt("connected to ",Nt,r),this.connected=!0;const l=i.provider.doc,c=i.awareness,a=mt();Y(a,Pe),yo(a,l),yr(this,a);const g=c.getStates();if(g.size>0){const m=mt();Y(m,gn),ht(m,qn(c,Array.from(g.keys()))),yr(this,m)}}),this.peer.on("close",()=>{this.connected=!1,this.closed=!0,i.webrtcConns.has(this.remotePeerId)&&(i.webrtcConns.delete(this.remotePeerId),i.provider.emit("peers",[{removed:[this.remotePeerId],added:[],webrtcPeers:Array.from(i.webrtcConns.keys()),bcPeers:Array.from(i.bcConns)}])),So(i),this.peer.destroy(),Rt("closed connection to ",Nt,r),Or(i)}),this.peer.on("error",o=>{Rt("Error in connection to ",Nt,r,": ",o),Or(i)}),this.peer.on("data",o=>{const l=ru(this,o);l!==null&&yr(this,l)})}destroy(){this.peer.destroy()}}const ae=(e,t)=>_o(t,e.key).then(n=>e.mux(()=>Wa(e.name,n))),Ws=(e,t)=>{e.bcconnected&&ae(e,t),su(e,t)},Or=e=>{Vn.forEach(t=>{t.connected&&(t.send({type:"subscribe",topics:[e.name]}),e.webrtcConns.size<e.provider.maxConns&&ps(t,e,{type:"announce",from:e.peerId}))})},ko=e=>{if(e.provider.filterBcConns){const t=mt();Y(t,gs),un(t,1),Ht(t,e.peerId),ae(e,ut(t))}};class iu{constructor(t,n,r,i){this.peerId=di(),this.doc=t,this.awareness=n.awareness,this.provider=n,this.synced=!1,this.name=r,this.key=i,this.webrtcConns=new Map,this.bcConns=new Set,this.mux=za(),this.bcconnected=!1,this._bcSubscriber=o=>wo(new Uint8Array(o),i).then(l=>this.mux(()=>{const c=Eo(this,l,()=>{});c&&ae(this,ut(c))})),this._docUpdateHandler=(o,l)=>{const c=mt();Y(c,Pe),Ka(c,o),Ws(this,ut(c))},this._awarenessUpdateHandler=({added:o,updated:l,removed:c},a)=>{const g=o.concat(l).concat(c),m=mt();Y(m,gn),ht(m,qn(this.awareness,g)),Ws(this,ut(m))},this._beforeUnloadHandler=()=>{Lr(this.awareness,[t.clientID],"window unload"),we.forEach(o=>{o.disconnect()})},typeof window<"u"?window.addEventListener("beforeunload",this._beforeUnloadHandler):typeof process<"u"&&process.on("exit",this._beforeUnloadHandler)}connect(){this.doc.on("update",this._docUpdateHandler),this.awareness.on("update",this._awarenessUpdateHandler),Or(this);const t=this.name;Va(t,this._bcSubscriber),this.bcconnected=!0,ko(this);const n=mt();Y(n,Pe),yo(n,this.doc),ae(this,ut(n));const r=mt();Y(r,Pe),mo(r,this.doc),ae(this,ut(r));const i=mt();Y(i,vo),ae(this,ut(i));const o=mt();Y(o,gn),ht(o,qn(this.awareness,[this.doc.clientID])),ae(this,ut(o))}disconnect(){Vn.forEach(n=>{n.connected&&n.send({type:"unsubscribe",topics:[this.name]})}),Lr(this.awareness,[this.doc.clientID],"disconnect");const t=mt();Y(t,gs),un(t,0),Ht(t,this.peerId),ae(this,ut(t)),Ha(this.name,this._bcSubscriber),this.bcconnected=!1,this.doc.off("update",this._docUpdateHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.webrtcConns.forEach(n=>n.destroy())}destroy(){this.disconnect(),typeof window<"u"?window.removeEventListener("beforeunload",this._beforeUnloadHandler):typeof process<"u"&&process.off("exit",this._beforeUnloadHandler)}}const ou=(e,t,n,r)=>{if(we.has(n))throw Bt(`A Yjs Doc connected to room "${n}" already exists!`);const i=new iu(e,t,n,r);return we.set(n,i),i},ps=(e,t,n)=>{t.key?eu(n,t.key).then(r=>{e.send({type:"publish",topic:t.name,data:wi(r)})}):e.send({type:"publish",topic:t.name,data:n})};class lu extends ja{constructor(t){super(t),this.providers=new Set,this.on("connect",()=>{Rt(`connected (${t})`);const n=Array.from(we.keys());this.send({type:"subscribe",topics:n}),we.forEach(r=>ps(this,r,{type:"announce",from:r.peerId}))}),this.on("message",n=>{switch(n.type){case"publish":{const r=n.topic,i=we.get(r);if(i==null||typeof r!="string")return;const o=l=>{const c=i.webrtcConns,a=i.peerId;if(l==null||l.from===a||l.to!==void 0&&l.to!==a||i.bcConns.has(l.from))return;const g=c.has(l.from)?()=>{}:()=>i.provider.emit("peers",[{removed:[],added:[l.from],webrtcPeers:Array.from(i.webrtcConns.keys()),bcPeers:Array.from(i.bcConns)}]);switch(l.type){case"announce":c.size<i.provider.maxConns&&(Ot(c,l.from,()=>new Hs(this,!0,l.from,i)),g());break;case"signal":if(l.signal.type==="offer"){const m=c.get(l.from);if(m){const h=l.token,d=m.glareToken;if(d&&d>h){Rt("offer rejected: ",l.from);return}m.glareToken=void 0}}if(l.signal.type==="answer"){Rt("offer answered by: ",l.from);const m=c.get(l.from);m.glareToken=void 0}l.to===a&&(Ot(c,l.from,()=>new Hs(this,!1,l.from,i)).peer.signal(l.signal),g());break}};i.key?typeof n.data=="string"&&nu(vi(n.data),i.key).then(o):o(n.data)}}}),this.on("disconnect",()=>Rt(`disconnect (${t})`))}}const mr=e=>{e.emit("status",[{connected:e.connected}])};class cu extends li{constructor(t,n,{signaling:r=["wss://y-webrtc-eu.fly.dev"],password:i=null,awareness:o=new Qa(n),maxConns:l=20+zt(Tl()*15),filterBcConns:c=!0,peerOpts:a={}}={}){super(),this.roomName=t,this.doc=n,this.filterBcConns=c,this.awareness=o,this.shouldConnect=!1,this.signalingUrls=r,this.signalingConns=[],this.maxConns=l,this.peerOpts=a,this.key=i?tu(i,t):Jr(null),this.room=null,this.key.then(g=>{this.room=ou(n,this,t,g),this.shouldConnect?this.room.connect():this.room.disconnect(),mr(this)}),this.connect(),this.destroy=this.destroy.bind(this),n.on("destroy",this.destroy)}get connected(){return this.room!==null&&this.shouldConnect}connect(){this.shouldConnect=!0,this.signalingUrls.forEach(t=>{const n=Ot(Vn,t,()=>new lu(t));this.signalingConns.push(n),n.providers.add(this)}),this.room&&(this.room.connect(),mr(this))}disconnect(){this.shouldConnect=!1,this.signalingConns.forEach(t=>{t.providers.delete(this),t.providers.size===0&&(t.destroy(),Vn.delete(t.url))}),this.room&&(this.room.disconnect(),mr(this))}destroy(){this.doc.off("destroy",this.destroy),this.key.then(()=>{this.room.destroy(),we.delete(this.roomName)}),super.destroy()}}const Te=e=>We((t,n)=>{e.onerror=r=>n(new Error(r.target.error)),e.onsuccess=r=>t(r.target.result)}),au=(e,t)=>We((n,r)=>{const i=indexedDB.open(e);i.onupgradeneeded=o=>t(o.target.result),i.onerror=o=>r(Bt(o.target.error)),i.onsuccess=o=>{const l=o.target.result;l.onversionchange=()=>{l.close()},n(l)}}),uu=e=>Te(indexedDB.deleteDatabase(e)),hu=(e,t)=>t.forEach(n=>e.createObjectStore.apply(e,n)),en=(e,t,n="readwrite")=>{const r=e.transaction(t,n);return t.map(i=>_u(r,i))},Co=(e,t)=>Te(e.count(t)),fu=(e,t)=>Te(e.get(t)),Ro=(e,t)=>Te(e.delete(t)),du=(e,t,n)=>Te(e.put(t,n)),Ir=(e,t)=>Te(e.add(t)),gu=(e,t,n)=>Te(e.getAll(t,n)),pu=(e,t,n)=>{let r=null;return bu(e,t,i=>(r=i,!1),n).then(()=>r)},yu=(e,t=null)=>pu(e,t,"prev"),mu=(e,t)=>We((n,r)=>{e.onerror=r,e.onsuccess=async i=>{const o=i.target.result;if(o===null||await t(o)===!1)return n();o.continue()}}),bu=(e,t,n,r="next")=>mu(e.openKeyCursor(t,r),i=>n(i.key)),_u=(e,t)=>e.objectStore(t),wu=(e,t)=>IDBKeyRange.upperBound(e,t),vu=(e,t)=>IDBKeyRange.lowerBound(e,t),br="custom",Ao="updates",To=500,Do=(e,t=()=>{},n=()=>{})=>{const[r]=en(e.db,[Ao]);return gu(r,vu(e._dbref,!1)).then(i=>{e._destroyed||(t(r),ot(e.doc,()=>{i.forEach(o=>xi(e.doc,o))},e,!1),n(r))}).then(()=>yu(r).then(i=>{e._dbref=i+1})).then(()=>Co(r).then(i=>{e._dbsize=i})).then(()=>r)},Su=(e,t=!0)=>Do(e).then(n=>{(t||e._dbsize>=To)&&Ir(n,rs(e.doc)).then(()=>Ro(n,wu(e._dbref,!0))).then(()=>Co(n).then(r=>{e._dbsize=r}))});class Eu extends Vr{constructor(t,n){super(),this.doc=n,this.name=t,this._dbref=0,this._dbsize=0,this._destroyed=!1,this.db=null,this.synced=!1,this._db=au(t,r=>hu(r,[["updates",{autoIncrement:!0}],["custom"]])),this.whenSynced=We(r=>this.on("synced",()=>r(this))),this._db.then(r=>{this.db=r,Do(this,l=>Ir(l,rs(n)),()=>{if(this._destroyed)return this;this.synced=!0,this.emit("synced",[this])})}),this._storeTimeout=1e3,this._storeTimeoutId=null,this._storeUpdate=(r,i)=>{if(this.db&&i!==this){const[o]=en(this.db,[Ao]);Ir(o,r),++this._dbsize>=To&&(this._storeTimeoutId!==null&&clearTimeout(this._storeTimeoutId),this._storeTimeoutId=setTimeout(()=>{Su(this,!1),this._storeTimeoutId=null},this._storeTimeout))}},n.on("update",this._storeUpdate),this.destroy=this.destroy.bind(this),n.on("destroy",this.destroy)}destroy(){return this._storeTimeoutId&&clearTimeout(this._storeTimeoutId),this.doc.off("update",this._storeUpdate),this.doc.off("destroy",this.destroy),this._destroyed=!0,this._db.then(t=>{t.close()})}clearData(){return this.destroy().then(()=>{uu(this.name)})}get(t){return this._db.then(n=>{const[r]=en(n,[br],"readonly");return fu(r,t)})}set(t,n){return this._db.then(r=>{const[i]=en(r,[br]);return du(i,n,t)})}del(t){return this._db.then(n=>{const[r]=en(n,[br]);return Ro(r,t)})}}var xe=(e=>(e[e.chest=0]="chest",e[e.collectible=1]="collectible",e[e.cow=2]="cow",e[e.fairy=3]="fairy",e[e.fairy_spot=4]="fairy_spot",e[e.fish=5]="fish",e[e.grass=6]="grass",e[e.gs=7]="gs",e[e.heart=8]="heart",e[e.npc=9]="npc",e[e.pot=10]="pot",e[e.rupee=11]="rupee",e[e.scrub=12]="scrub",e[e.sf=13]="sf",e[e.shop=14]="shop",e[e.sr=15]="sr",e))(xe||{}),nn=(e=>(e[e.special_scrub=0]="special_scrub",e[e.setting_tcg=1]="setting_tcg",e[e.setting_hideout_shuffle=2]="setting_hideout_shuffle",e[e.mm_skulltula=3]="mm_skulltula",e[e.boss=4]="boss",e))(nn||{}),vt=(e=>(e[e.unchecked=0]="unchecked",e[e.marked=1]="marked",e[e.checked=2]="checked",e))(vt||{});const ku="https://cemulate.github.io/ootmmr-checklist/assets/structured-checks-lite-CWyeQH-k.json";async function Cu(){return(await fetch(ku)).json()}function zs(e){let t,n,r=e[2]?"(MQ)":"(Vanilla)",i,o,l;return{c(){t=Z("span"),n=Z("strong"),i=te(r),st(t,"class","interactable")},m(c,a){Tt(c,t,a),J(t,n),J(n,i),o||(l=Ut(t,"click",fe(e[7])),o=!0)},p(c,a){a&4&&r!==(r=c[2]?"(MQ)":"(Vanilla)")&&Wn(i,r)},d(c){c&&kt(t),o=!1,l()}}}function Ru(e){let t,n,r,i,o,l,c,a,g,m,h,d=e[1]&&zs(e);const y=e[5].default,p=Uo(y,e,e[4],null);return{c(){t=Z("div"),n=Z("h3"),r=Z("span"),i=Z("strong"),o=te(e[0]),l=St(),d&&d.c(),c=St(),a=Z("div"),p&&p.c(),st(r,"class","interactable"),tn(r,"margin-right","5px"),st(n,"class","header svelte-yva4oi"),st(a,"class","checks-container svelte-yva4oi"),st(t,"class","check-group")},m(w,I){Tt(w,t,I),J(t,n),J(n,r),J(r,i),J(i,o),J(n,l),d&&d.m(n,null),J(t,c),J(t,a),p&&p.m(a,null),g=!0,m||(h=Ut(r,"click",fe(e[6])),m=!0)},p(w,[I]){(!g||I&1)&&Wn(o,w[0]),w[1]?d?d.p(w,I):(d=zs(w),d.c(),d.m(n,null)):d&&(d.d(1),d=null),p&&p.p&&(!g||I&16)&&Fo(p,y,w,w[4],g?xo(y,w[4],I,null):Bo(w[4]),null)},i(w){g||(Dt(p,w),g=!0)},o(w){re(p,w),g=!1},d(w){w&&kt(t),d&&d.d(),p&&p.d(w),m=!1,h()}}}function Au(e,t,n){let{$$slots:r={},$$scope:i}=t;const o=si();let{groupName:l=""}=t,{canBeMq:c=!1}=t,{isMq:a=!1}=t;const g=h=>o("toggleGroup"),m=h=>o("toggleMq");return e.$$set=h=>{"groupName"in h&&n(0,l=h.groupName),"canBeMq"in h&&n(1,c=h.canBeMq),"isMq"in h&&n(2,a=h.isMq),"$$scope"in h&&n(4,i=h.$$scope)},[l,c,a,o,i,r,g,m]}class Tu extends qr{constructor(t){super(),Pr(this,t,Au,Ru,Hn,{groupName:0,canBeMq:1,isMq:2})}}function Du(e){let t,n,r,i,o;return{c(){t=Z("button"),n=Z("span"),r=te(e[0]),st(n,"class","svelte-17yclgy"),Vt(n,"crossed-out",e[2]),st(t,"class","check-item interactable svelte-17yclgy"),Vt(t,"checked",e[2]),Vt(t,"marked",e[1])},m(l,c){Tt(l,t,c),J(t,n),J(n,r),i||(o=[Ut(t,"click",fe(e[7])),Ut(t,"contextmenu",fe(e[8]))],i=!0)},p(l,[c]){c&1&&Wn(r,l[0]),c&4&&Vt(n,"crossed-out",l[2]),c&4&&Vt(t,"checked",l[2]),c&2&&Vt(t,"marked",l[1])},i:At,o:At,d(l){l&&kt(t),i=!1,Kt(o)}}}function Lu(e,t,n){let r,i;const o=si();let{type:l=xe.chest}=t,{name:c=""}=t,{tags:a=[]}=t,{state:g=vt.unchecked}=t;const m=d=>o("toggle",{range:d.shiftKey??!1}),h=d=>o("mark");return e.$$set=d=>{"type"in d&&n(4,l=d.type),"name"in d&&n(0,c=d.name),"tags"in d&&n(5,a=d.tags),"state"in d&&n(6,g=d.state)},e.$$.update=()=>{e.$$.dirty&64&&n(2,r=g==vt.checked),e.$$.dirty&64&&n(1,i=g==vt.marked)},[c,i,r,o,l,a,g,m,h]}class Ou extends qr{constructor(t){super(),Pr(this,t,Lu,Du,Hn,{type:4,name:0,tags:5,state:6})}}function Ys(e,t,n){const r=e.slice();return r[36]=t[n],r}function Gs(e,t,n){const r=e.slice();return r[39]=t[n],r[41]=n,r}function Js(e,t,n){const r=e.slice();return r[42]=t[n][0],r[43]=t[n][1],r}function Ks(e){let t,n,r,i,o;return{c(){t=Z("span"),n=te(" (Connected to room: "),r=Z("code"),i=te(e[0]),o=te(")")},m(l,c){Tt(l,t,c),J(t,n),J(t,r),J(r,i),J(t,o)},p(l,c){c[0]&1&&Wn(i,l[0])},d(l){l&&kt(t)}}}function $s(e){let t,n,r,i,o=e[43]+"",l,c,a,g;function m(...h){return e[24](e[42],...h)}return{c(){t=Z("label"),n=Z("input"),i=St(),l=te(o),c=St(),st(n,"type","checkbox"),n.checked=r=e[5].get(e[42])??!1},m(h,d){Tt(h,t,d),J(t,n),J(t,i),J(t,l),J(t,c),a||(g=Ut(n,"change",fe(m)),a=!0)},p(h,d){e=h,d[0]&32&&r!==(r=e[5].get(e[42])??!1)&&(n.checked=r)},d(h){h&&kt(t),a=!1,g()}}}function Iu(e){let t,n,r,i,o,l,c;return{c(){t=Z("form"),n=Z("fieldset"),r=Z("button"),r.textContent="Copy Room Link",i=St(),o=Z("button"),o.textContent="Disconnect",st(r,"class","bg-primary pure-button"),st(o,"class","bg-primary pure-button"),st(t,"class","pure-form")},m(a,g){Tt(a,t,g),J(t,n),J(n,r),J(n,i),J(n,o),l||(c=[Ut(r,"click",fe(e[27])),Ut(o,"click",e[10])],l=!0)},p:At,d(a){a&&kt(t),l=!1,Kt(c)}}}function Mu(e){let t,n,r,i,o,l;return{c(){t=Z("form"),t.innerHTML='<fieldset><input id="room-code-input" class="" type="text" placeholder="Room code" required="" pattern="[a-z0-9]{8,}"/> <button type="submit" class="bg-primary pure-button">Join room</button></fieldset>',n=St(),r=Z("div"),i=Z("button"),i.textContent="Create new co-op room",st(t,"class","pure-form"),st(i,"class","bg-primary fullwidth pure-button"),st(r,"class","block")},m(c,a){Tt(c,t,a),Tt(c,n,a),Tt(c,r,a),J(r,i),o||(l=[Ut(t,"submit",fe(e[25])),Ut(i,"click",e[26])],o=!0)},p:At,d(c){c&&(kt(t),kt(n),kt(r)),o=!1,Kt(l)}}}function Xs(e){let t,n,r=qe(e[8]),i=[];for(let l=0;l<r.length;l+=1)i[l]=Zs(Ys(e,r,l));const o=l=>re(i[l],1,1,()=>{i[l]=null});return{c(){for(let l=0;l<i.length;l+=1)i[l].c();t=ri()},m(l,c){for(let a=0;a<i.length;a+=1)i[a]&&i[a].m(l,c);Tt(l,t,c),n=!0},p(l,c){if(c[0]&1714584){r=qe(l[8]);let a;for(a=0;a<r.length;a+=1){const g=Ys(l,r,a);i[a]?(i[a].p(g,c),Dt(i[a],1)):(i[a]=Zs(g),i[a].c(),Dt(i[a],1),i[a].m(t.parentNode,t))}for(xr(),a=r.length;a<i.length;a+=1)o(a);Fr()}},i(l){if(!n){for(let c=0;c<r.length;c+=1)Dt(i[c]);n=!0}},o(l){i=i.filter(Boolean);for(let c=0;c<i.length;c+=1)re(i[c]);n=!1},d(l){l&&kt(t),Ur(i,l)}}}function Qs(e){let t,n;function r(...o){return e[30](e[36],e[41],e[39],...o)}function i(...o){return e[31](e[39],...o)}return t=new Ou({props:{name:e[39].shortName,type:e[39].type,state:e[3].get(e[39].name)??vt.unchecked,tags:e[39].tags}}),t.$on("toggle",r),t.$on("mark",i),{c(){oi(t.$$.fragment)},m(o,l){Br(t,o,l),n=!0},p(o,l){e=o;const c={};l[0]&256&&(c.name=e[39].shortName),l[0]&256&&(c.type=e[39].type),l[0]&264&&(c.state=e[3].get(e[39].name)??vt.unchecked),l[0]&256&&(c.tags=e[39].tags),t.$set(c)},i(o){n||(Dt(t.$$.fragment,o),n=!0)},o(o){re(t.$$.fragment,o),n=!1},d(o){jr(t,o)}}}function Nu(e){let t,n,r=qe(e[36].checks),i=[];for(let l=0;l<r.length;l+=1)i[l]=Qs(Gs(e,r,l));const o=l=>re(i[l],1,1,()=>{i[l]=null});return{c(){for(let l=0;l<i.length;l+=1)i[l].c();t=ri()},m(l,c){for(let a=0;a<i.length;a+=1)i[a]&&i[a].m(l,c);Tt(l,t,c),n=!0},p(l,c){if(c[0]&1059208){r=qe(l[36].checks);let a;for(a=0;a<r.length;a+=1){const g=Gs(l,r,a);i[a]?(i[a].p(g,c),Dt(i[a],1)):(i[a]=Qs(g),i[a].c(),Dt(i[a],1),i[a].m(t.parentNode,t))}for(xr(),a=r.length;a<i.length;a+=1)o(a);Fr()}},i(l){if(!n){for(let c=0;c<r.length;c+=1)Dt(i[c]);n=!0}},o(l){i=i.filter(Boolean);for(let c=0;c<i.length;c+=1)re(i[c]);n=!1},d(l){l&&kt(t),Ur(i,l)}}}function Zs(e){let t,n,r,i;function o(...c){return e[32](e[36],...c)}function l(...c){return e[33](e[36],...c)}return n=new Tu({props:{groupName:e[36].groupName,canBeMq:e[36].canHaveMq,isMq:e[4].get(e[36].groupName)??!1,$$slots:{default:[Nu]},$$scope:{ctx:e}}}),n.$on("toggleGroup",o),n.$on("toggleMq",l),{c(){t=Z("section"),oi(n.$$.fragment),r=St()},m(c,a){Tt(c,t,a),Br(n,t,null),J(t,r),i=!0},p(c,a){e=c;const g={};a[0]&256&&(g.groupName=e[36].groupName),a[0]&256&&(g.canBeMq=e[36].canHaveMq),a[0]&272&&(g.isMq=e[4].get(e[36].groupName)??!1),a[0]&392|a[1]&32768&&(g.$$scope={dirty:a,ctx:e}),n.$set(g)},i(c){i||(Dt(n.$$.fragment,c),i=!0)},o(c){re(n.$$.fragment,c),i=!1},d(c){c&&kt(t),jr(n)}}}function Uu(e){let t,n,r,i,o,l,c,a,g,m,h,d,y,p,w,I,O,x,b,v,S,R,E,D,U,C,A,F,B=e[6]!=null&&Ks(e),G=qe(Object.entries(e[16])),W=[];for(let X=0;X<G.length;X+=1)W[X]=$s(Js(e,G,X));function Q(X,ct){return X[6]==null?Mu:Iu}let lt=Q(e),it=lt(e),q=e[8]!=null&&Xs(e);return{c(){t=Z("main"),n=Z("section"),r=Z("details"),i=Z("summary"),o=Z("strong"),o.textContent="Config",l=St(),B&&B.c(),c=St(),a=Z("div"),g=Z("form"),m=Z("a"),m.textContent=" More info",h=St(),d=Z("fieldset");for(let X=0;X<W.length;X+=1)W[X].c();y=St(),p=Z("div"),it.c(),w=St(),I=Z("div"),O=Z("button"),O.textContent="Clear/Reset",x=St(),b=Z("section"),v=Z("form"),S=Z("fieldset"),R=Z("button"),R.textContent="Hide Checked",E=St(),D=Z("input"),U=St(),q&&q.c(),st(o,"class","interactable"),st(m,"href","https://github.com/cemulate/ootmmr-checklist"),st(m,"target","_blank"),tn(m,"margin-left","auto"),st(g,"class","pure-form pure-form-stacked svelte-1ym9wux"),st(O,"class","bg-danger fullwidth pure-button"),st(I,"class","block"),tn(I,"margin-top","auto"),st(p,"class","flex flex-col svelte-1ym9wux"),st(a,"id","settings-container"),st(a,"class","flex flex-wrap svelte-1ym9wux"),tn(a,"margin-top","0.8em"),st(r,"id","configuration-details"),r.open=!0,st(r,"class","svelte-1ym9wux"),st(n,"class","top-bar"),st(R,"class","pure-button"),Vt(R,"pure-button-active",e[2]),Vt(R,"bg-unchecked",e[2]),st(D,"type","text"),tn(D,"width","16em"),st(D,"placeholder","Filter..."),st(v,"class","pure-form"),st(t,"class","svelte-1ym9wux")},m(X,ct){Tt(X,t,ct),J(t,n),J(n,r),J(r,i),J(i,o),J(i,l),B&&B.m(i,null),J(r,c),J(r,a),J(a,g),J(g,m),J(g,h),J(g,d);for(let P=0;P<W.length;P+=1)W[P]&&W[P].m(d,null);J(a,y),J(a,p),it.m(p,null),J(p,w),J(p,I),J(I,O),J(t,x),J(t,b),J(b,v),J(v,S),J(S,R),J(S,E),J(S,D),ms(D,e[1]),J(t,U),q&&q.m(t,null),C=!0,A||(F=[Ut(O,"click",fe(e[21])),Ut(R,"click",e[28]),Ut(D,"input",e[29])],A=!0)},p(X,ct){if(X[6]!=null?B?B.p(X,ct):(B=Ks(X),B.c(),B.m(i,null)):B&&(B.d(1),B=null),ct[0]&81952){G=qe(Object.entries(X[16]));let P;for(P=0;P<G.length;P+=1){const V=Js(X,G,P);W[P]?W[P].p(V,ct):(W[P]=$s(V),W[P].c(),W[P].m(d,null))}for(;P<W.length;P+=1)W[P].d(1);W.length=G.length}lt===(lt=Q(X))&&it?it.p(X,ct):(it.d(1),it=lt(X),it&&(it.c(),it.m(p,w))),(!C||ct[0]&4)&&Vt(R,"pure-button-active",X[2]),(!C||ct[0]&4)&&Vt(R,"bg-unchecked",X[2]),ct[0]&2&&D.value!==X[1]&&ms(D,X[1]),X[8]!=null?q?(q.p(X,ct),ct[0]&256&&Dt(q,1)):(q=Xs(X),q.c(),Dt(q,1),q.m(t,null)):q&&(xr(),re(q,1,1,()=>{q=null}),Fr())},i(X){C||(Dt(q),C=!0)},o(X){re(q),C=!1},d(X){X&&kt(t),B&&B.d(),Ur(W,X),it.d(),q&&q.d(),A=!1,Kt(F)}}}function ti(e,t,n=!1){e.set(t,!(e.get(t)??n))}function xu(e,t,n){let r,i,o,l,c;const a=new Xe;new Eu("local",a);let g=null,m=null;function h(P){n(0,g=P??new Date().getTime().toString(36));const V=["https://ootmmr-checklist-signaling.fly.dev/"];n(6,m=new cu(g,a,{signaling:V}))}function d(){window.confirm("Are you sure you want to disconnect? Your progress will be preserved as it is now.")&&(m==null||m.disconnect(),n(6,m=null),n(0,g=null))}if(window.location.hash.length>0&&/#[a-z0-9]+/.test(window.location.hash)){const P=window.location.hash.slice(1);h(P)}const y=a.getMap("checks"),p=Dn.readableMap(y);rr(e,p,P=>n(3,o=P));const w=P=>P!=vt.checked?vt.checked:vt.unchecked,I=a.getMap("settings"),O=Dn.readableMap(I);rr(e,O,P=>n(5,c=P));const x={goldSkulltulas:"Gold Skulltulas",mmSkulltulas:"MM Skulltulas",ootScrubs:"Oot Scrubs",cows:"Cows",strayFairies:"Stray Fairies",ootTreasureChestGame:"OoT Treasure Chest Game",ootHideoutShuffle:"OoT Hideout Shuffle"},b=a.getMap("mqSettings"),v=Dn.readableMap(b);rr(e,v,P=>n(4,l=P));let S=null;Cu().then(P=>{n(22,S=P)});let R="",E=!1;function D(P){const K=P.checks.every(({name:ft})=>y.get(ft)==vt.checked)?vt.unchecked:vt.checked;P.checks.map(({name:ft})=>y.set(ft,K))}let U=null;function C(P,V){if(!(U==null||U.group.groupName!=P.groupName))for(let K=U.checkIndex+1;K<V+1;K++)y.set(P.checks[K].name,U.newState)}function A(){window.confirm("Are you sure you want to clear all checks?")&&Array.from(y.keys()).map(V=>y.delete(V))}const F=(P,V)=>ti(I,P),B=P=>{var V;return h((V=P.target)==null?void 0:V.querySelector("#room-code-input").value)},G=P=>h(),W=P=>window.navigator.clipboard.writeText(window.location.href),Q=P=>n(2,E=!E);function lt(){R=this.value,n(1,R)}const it=(P,V,K,ft)=>{if(ft.detail.range)C(P,V);else{const Et=w(o.get(K.name)??vt.unchecked);n(7,U={group:P,checkIndex:V,newState:Et}),y.set(K.name,Et)}},q=(P,V)=>y.set(P.name,vt.marked),X=(P,V)=>D(P),ct=(P,V)=>ti(b,P.groupName);return e.$$.update=()=>{e.$$.dirty[0]&1&&(window.location.hash=g??""),e.$$.dirty[0]&62&&n(23,r=(P,V)=>{const K=(Qt,ye)=>!Qt||(c.get(ye)??!1),ft=K(V.type==xe.gs,"goldSkulltulas")&&K(V.tags.includes(nn.mm_skulltula),"mmSkulltulas")&&K(V.type==xe.scrub&&!V.tags.includes(nn.special_scrub),"ootScrubs")&&K(V.type==xe.cow,"cows")&&K(V.type==xe.sf,"strayFairies")&&K(V.tags.includes(nn.setting_tcg),"ootTreasureChestGame")&&K(V.tags.includes(nn.setting_hideout_shuffle),"ootHideoutShuffle"),Et=R.toLowerCase(),jt=R.length==0?!0:V.name.toLowerCase().includes(Et)||P.groupName.toLowerCase().includes(Et),pe=V.canBeMq?(l.get(P.groupName)??!1)==V.isMq:!0,Xt=E?o.get(V.name)!=vt.checked:!0;return ft&&jt&&pe&&Xt}),e.$$.dirty[0]&12582912&&n(8,i=S==null?void 0:S.flatMap(P=>{const V=P.checks.filter(r.bind(null,P));return V.length==0?[]:[{...P,checks:V}]}))},[g,R,E,o,l,c,m,U,i,h,d,y,p,w,I,O,x,b,v,D,C,A,S,r,F,B,G,W,Q,lt,it,q,X,ct]}class Fu extends qr{constructor(t){super(),Pr(this,t,xu,Uu,Hn,{},null,[-1,-1])}}function Bu(e,t,n){const r=/^localhost$|^127(?:\.[0-9]+){0,2}\.[0-9]+$|^(?:0*:)*?:?0*1$/.test(location.hostname)||location.protocol==="file:";if(!t.trackLocalhost&&r)return console.warn("[Plausible] Ignoring event because website is running locally");try{if(window.localStorage.plausible_ignore==="true")return console.warn('[Plausible] Ignoring event because "plausible_ignore" is set to "true" in localStorage')}catch{}const i={n:e,u:t.url,d:t.domain,r:t.referrer,w:t.deviceWidth,h:t.hashMode?1:0,p:n&&n.props?JSON.stringify(n.props):void 0},o=new XMLHttpRequest;o.open("POST",`${t.apiHost}/api/event`,!0),o.setRequestHeader("Content-Type","text/plain"),o.send(JSON.stringify(i)),o.onreadystatechange=()=>{o.readyState===4&&n&&n.callback&&n.callback()}}function ju(e){const t=()=>({hashMode:!1,trackLocalhost:!1,url:location.href,domain:location.hostname,referrer:document.referrer||null,deviceWidth:window.innerWidth,apiHost:"https://plausible.io",...e}),n=(l,c,a)=>{Bu(l,{...t(),...a},c)},r=(l,c)=>{n("pageview",c,l)};return{trackEvent:n,trackPageview:r,enableAutoPageviews:()=>{const l=()=>r(),c=history.pushState;return c&&(history.pushState=function(a,g,m){c.apply(this,[a,g,m]),l()},addEventListener("popstate",l)),e&&e.hashMode&&addEventListener("hashchange",l),r(),function(){c&&(history.pushState=c,removeEventListener("popstate",l)),e&&e.hashMode&&removeEventListener("hashchange",l)}},enableAutoOutboundTracking:(l=document,c={subtree:!0,childList:!0,attributes:!0,attributeFilter:["href"]})=>{function a(y){n("Outbound Link: Click",{props:{url:this.href}}),typeof process<"u"&&process,setTimeout(()=>{location.href=this.href},150),y.preventDefault()}const g=new Set;function m(y){y instanceof HTMLAnchorElement?y.host!==location.host&&(y.addEventListener("click",a),g.add(y)):"querySelectorAll"in y&&y.querySelectorAll("a").forEach(m)}function h(y){y instanceof HTMLAnchorElement?(y.removeEventListener("click",a),g.delete(y)):"querySelectorAll"in y&&y.querySelectorAll("a").forEach(h)}const d=new MutationObserver(y=>{y.forEach(p=>{p.type==="attributes"?(h(p.target),m(p.target)):p.type==="childList"&&(p.addedNodes.forEach(m),p.removedNodes.forEach(h))})});return l.querySelectorAll("a").forEach(m),d.observe(l,c),function(){g.forEach(p=>{p.removeEventListener("click",a)}),g.clear(),d.disconnect()}}}}ju({domain:"cemulate.github.io/ootmmr-checklist",apiHost:"https://plausible.351321.xyz"}).enableAutoPageviews();new Fu({target:document.getElementById("app")});
